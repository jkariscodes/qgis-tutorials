<!DOCTYPE html>


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>近鄰分析 &mdash; QGIS Tutorials and Tips</title>
    
    <link rel="stylesheet" href="../_static/basic.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../_static/bootswatch-3.2.0/united/bootstrap.min.css" type="text/css" />
    <link rel="stylesheet" href="../_static/bootstrap-sphinx.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '1',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <script type="text/javascript" src="../_static/translations.js"></script>
    <script type="text/javascript" src="../_static/js/jquery-1.11.0.min.js"></script>
    <script type="text/javascript" src="../_static/js/jquery-fix.js"></script>
    <script type="text/javascript" src="../_static/bootstrap-3.2.0/js/bootstrap.min.js"></script>
    <script type="text/javascript" src="../_static/bootstrap-sphinx.js"></script>
    <link rel="top" title="QGIS Tutorials and Tips" href="../index.html" />

<meta charset='utf-8'>
<meta http-equiv='X-UA-Compatible' content='IE=edge,chrome=1'>
<meta name='viewport' content='width=device-width, initial-scale=1.0, maximum-scale=1'>
<meta name="apple-mobile-web-app-capable" content="yes">

<!-- Google Analytics -->
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-690672-13', 'qgistutorials.com');
  ga('require', 'displayfeatures');
  ga('send', 'pageview');
</script>


  </head>
  <body role="document">

  <div id="navbar" class="navbar navbar-default navbar-fixed-top">
    <div class="container">
      <div class="navbar-header">
        <!-- .btn-navbar is used as the toggle for collapsed navbar content -->
        <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".nav-collapse">
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>
        <a class="navbar-brand" href="../index.html"><img src="../_static/logo.png">
          QGIS Tutorials and Tips</a>
        <span class="navbar-text navbar-version pull-left"><b>v1.0</b></span>
      </div>

        <div class="collapse navbar-collapse nav-collapse">
          <ul class="nav navbar-nav">
            
            
              <li class="dropdown globaltoc-container">
  <a role="button"
     id="dLabelGlobalToc"
     data-toggle="dropdown"
     data-target="#"
     href="../index.html">Tutorials List <b class="caret"></b></a>
  <ul class="dropdown-menu globaltoc"
      role="menu"
      aria-labelledby="dLabelGlobalToc"><ul>
<li class="toctree-l1"><a class="reference internal" href="introduction.html">簡介</a></li>
<li class="toctree-l1"><a class="reference internal" href="3/making_a_map.html">製作地圖 (QGIS3)</a></li>
<li class="toctree-l1"><a class="reference internal" href="3/working_with_attributes.html">Working with Attributes (QGIS3)</a></li>
<li class="toctree-l1"><a class="reference internal" href="3/importing_spreadsheets_csv.html">匯入工作表或 CSV 檔 (QGIS3)</a></li>
<li class="toctree-l1"><a class="reference internal" href="3/basic_vector_styling.html">Basic Vector Styling (QGIS3)</a></li>
<li class="toctree-l1"><a class="reference internal" href="3/calculating_line_lengths.html">Calculating Line Lengths and Statistics (QGIS3)</a></li>
<li class="toctree-l1"><a class="reference internal" href="3/raster_styling_and_analysis.html">Basic Raster Styling and Analysis (QGIS3)</a></li>
<li class="toctree-l1"><a class="reference internal" href="3/raster_mosaicing_and_clipping.html">Raster Mosaicing and Clipping (QGIS3)</a></li>
<li class="toctree-l1"><a class="reference internal" href="working_with_terrain.html">地形資料的操作</a></li>
<li class="toctree-l1"><a class="reference internal" href="working_with_wms.html">WMS 資料的操作</a></li>
<li class="toctree-l1"><a class="reference internal" href="working_with_projections.html">投影的操作</a></li>
<li class="toctree-l1"><a class="reference internal" href="3/georeferencing_basics.html">為紙本地圖進行空間對位 (QGIS3)</a></li>
<li class="toctree-l1"><a class="reference internal" href="3/advanced_georeferencing.html">為空照圖進行空間對位 (QGIS3)</a></li>
<li class="toctree-l1"><a class="reference internal" href="digitizing_basics.html">把地圖數位化</a></li>
<li class="toctree-l1"><a class="reference internal" href="3/performing_table_joins.html">資料表連接 (QGIS3)</a></li>
<li class="toctree-l1"><a class="reference internal" href="3/performing_spatial_joins.html">空間連接 (QGIS3)</a></li>
<li class="toctree-l1"><a class="reference internal" href="3/creating_heatmaps.html">製作熱區圖 (QGIS3)</a></li>
<li class="toctree-l1"><a class="reference internal" href="3/performing_spatial_queries.html">Performing Spatial Queries (QGIS3)</a></li>
<li class="toctree-l1"><a class="reference internal" href="3/nearest_neighbor_analysis.html">Nearest Neighbor Analysis (QGIS3)</a></li>
<li class="toctree-l1"><a class="reference internal" href="3/sampling_raster_data.html">Sampling Raster Data using Points or Polygons (QGIS3)</a></li>
<li class="toctree-l1"><a class="reference internal" href="interpolating_point_data.html">點資料內插法</a></li>
<li class="toctree-l1"><a class="reference internal" href="3/batch_processing.html">使用處理框架進行批次處理 (QGIS3)</a></li>
<li class="toctree-l1"><a class="reference internal" href="3/processing_graphical_modeler.html">利用處理建模自動執行複雜的工作流程 (QGIS3)</a></li>
<li class="toctree-l1"><a class="reference internal" href="3/automating_map_creation.html">Automating Map Creation with Print Layout Atlas (QGIS3)</a></li>
<li class="toctree-l1"><a class="reference internal" href="using_qgis_browser.html">使用 QGIS 瀏覽器</a></li>
<li class="toctree-l1"><a class="reference internal" href="open_bil_bip_bsq_files.html">在 QGIS 中開啟 BIL、BIP 或 BSQ 格式檔案</a></li>
<li class="toctree-l1"><a class="reference internal" href="3/getting_started_with_pyqgis.html">Python 程式設計的初步上手 (QGIS3)</a></li>
<li class="toctree-l1"><a class="reference internal" href="3/processing_algorithms_pyqgis.html">Running Processing Algorithms via Python (QGIS3)</a></li>
<li class="toctree-l1"><a class="reference internal" href="3/building_a_python_plugin.html">以 Python 製作附加元件 (QGIS3)</a></li>
<li class="toctree-l1"><a class="reference internal" href="3/custom_python_functions.html">使用自訂的 Python 表達式函數 (QGIS3)</a></li>
<li class="toctree-l1"><a class="reference internal" href="3/processing_python_scripts.html">撰寫 Python 腳本並在處理框架下執行（QGIS3)</a></li>
<li class="toctree-l1"><a class="reference internal" href="running_qgis_jobs.html">執行 QGIS 工作排程</a></li>
<li class="toctree-l1"><a class="reference internal" href="performing_table_joins_pyqgis.html">資料表連接 (PyQGIS)</a></li>
<li class="toctree-l1"><a class="reference internal" href="web_mapping_with_qgis2web.html">使用 QGIS2Web 線上製圖</a></li>
<li class="toctree-l1"><a class="reference internal" href="creating_basemaps_with_qtiles.html">用 QTiles 製作底圖</a></li>
<li class="toctree-l1"><a class="reference internal" href="using_plugins.html">使用附加元件</a></li>
<li class="toctree-l1"><a class="reference internal" href="downloading_osm_data.html">搜尋和下載開放街圖資料</a></li>
<li class="toctree-l1"><a class="reference internal" href="learning_resources.html">QGIS 學習資源</a></li>
<li class="toctree-l1"><a class="reference internal" href="credits.html">資料來源</a></li>
<li class="toctree-l1"><a class="reference internal" href="batch_processing.html">使用處理框架進行批次處理 (QGIS2)</a></li>
</ul>
</ul>
</li>
              
            
            
              
                
              
            
            

            

            
              <li class="hidden-sm"></li>
            
          </ul>

          
            
<form class="navbar-form navbar-right" action="../search.html" method="get">
 <div class="form-group">
  <input type="text" name="q" class="form-control" placeholder="Search" />
 </div>
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
          
        </div>
    </div>
  </div>

<div class="container">
  <div class="row">
      <div class="col-md-3">
        <div id="sidebar" class="bs-sidenav" role="complementary"><h4>Author</h4>
<p>Ujaval Gandhi</p>
<a href="https://twitter.com/intent/follow?screen_name=spatialthoughts" class="twitter-follow-button" data-show-count="false">Follow @spatialthoughts</a>

<!-- Begin Mailchimp Signup Form -->
<link href="//cdn-images.mailchimp.com/embedcode/slim-10_7.css" rel="stylesheet" type="text/css">
<style type="text/css">
	#mc_embed_signup{background:#fff; clear:left; font:14px Helvetica,Arial,sans-serif; }
	/* Add your own Mailchimp form style overrides in your site stylesheet or in this style block.
	   We recommend moving this block and the preceding CSS link to the HEAD of your HTML file. */
</style>
<div id="mc_embed_signup">
<h4>Subscribe to my mailing list</h4>
<p>Get occasional emails when I post new material or announce training events.</p>
<form action="https://spatialthoughts.us20.list-manage.com/subscribe/post?u=59d493847a7c7c2dbf12b21e6&amp;id=8fb09ab55c" method="post" id="mc-embedded-subscribe-form" name="mc-embedded-subscribe-form" class="validate" target="_blank" novalidate>
    <div id="mc_embed_signup_scroll">
	<input type="email" value="" name="EMAIL" class="email" id="mce-EMAIL" placeholder="email address" required>
    <!-- real people should not fill this in and expect good things - do not remove this or risk form bot signups-->
    <div style="position: absolute; left: -5000px;" aria-hidden="true"><input type="text" name="b_59d493847a7c7c2dbf12b21e6_8fb09ab55c" tabindex="-1" value=""></div>
    <div class="clear"><input type="submit" value="Subscribe" name="subscribe" id="mc-embedded-subscribe" class="button"></div>
    </div>
</form>
</div>

<!--End mc_embed_signup-->

<h4>Change Language</h4>
<form role="form" class="sidebar-form sidebar-left">
<select id="languages" class="form-control select-mini">
  <option value="en">English</option>
  <option value="zh_TW">Chinese (Taiwan)</option>
  <option value="nl">Dutch</option>
  <option value="fi_FI">Finnish</option>
  <option value="fr">French</option>
  <option value="de">German</option>
  <option value="el">Greek</option>
  <option value="id">Indonesian</option>
  <option value="it">Italian</option>
  <option value="ko">Korean</option>
  <option value="pt_BR">Portuguese</option>
  <option value="ro">Romanian</option>
  <option value="ru">Russian</option>
  <option value="sl">Slovenian</option>
  <option value="es">Spanish</option>
  <option value="th">Thai</option>
  <option value="tr">Turkish</option>
  <option value="uk">Ukrainian</option>
  <option value="vi">Vietnamese</option>
</select>
</form>
        </div>
      </div>
    <div class="col-md-9">
      

  <div class="section" id="nearest-neighbor-analysis">
<h1>近鄰分析<a class="headerlink" href="#nearest-neighbor-analysis" title="Permalink to this headline">¶</a></h1>
<div class="admonition warning">
<p class="first admonition-title">警告</p>
<p class="last">This tutorial is now obsolete. A new and updated version is available at <a class="reference internal" href="3/nearest_neighbor_analysis.html"><em>Nearest Neighbor Analysis (QGIS3)</em></a></p>
</div>
<p>GIS 非常適合用於分析圖徵的空間關係。這些分析的其中之一是為特定的圖徵尋找最接近的另一個圖徵，這時 QGIS 的<strong>距離矩陣（Distance Matrix）</strong>工具就可以派上用場。在本教學中，我們會使用 2 個資料集，並且尋找這兩個圖層中，哪些點彼此最為靠近。</p>
<div class="section" id="overview-of-the-task">
<h2>內容說明<a class="headerlink" href="#overview-of-the-task" title="Permalink to this headline">¶</a></h2>
<p>我們已有許多重要地震的位置，現在要找出這些離地震最近的人口聚居地。</p>
<div class="section" id="other-skills-you-will-learn">
<h3>你還會學到這些<a class="headerlink" href="#other-skills-you-will-learn" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p class="first">如何在 QGIS 中操作資料表連結 (如需更多介紹請看 <a class="reference internal" href="performing_table_joins.html"><em>資料表連接</em></a>)</p>
</li>
<li><p class="first">使用 <span class="guilabel">查詢建構器</span> 來顯示圖層中的次群組</p>
</li>
<li><p class="first">使用 MMQGIS 附加元件畫出樞紐線以呈現近鄰分析的結果</p>
</li>
</ul>
</div>
</div>
<div class="section" id="get-the-data">
<h2>取得資料<a class="headerlink" href="#get-the-data" title="Permalink to this headline">¶</a></h2>
<p>這裡我們要使用 NOAA 的美國國立地球物理資料中心（NGDC）的 <a class="reference external" href="http://www.ngdc.noaa.gov/nndc/struts/form?t=101650&amp;s=1&amp;d=1">Significant Earthquake Database</a>，內含所有的全球重大地震。下載 <a class="reference external" href="http://www.ngdc.noaa.gov/nndc/struts/results?type_0=Exact&amp;query_0=$ID&amp;t=101650&amp;s=13&amp;d=189&amp;dfn=signif.txt">地震資料的 tab 分隔檔</a></p>
<p>Natural Earth <a class="reference external" href="http://www.naturalearthdata.com/downloads/10m-cultural-vectors/10m-populated-places/">上有不錯的 `人口居住地</a> 資料庫，<a href="#id3"><span class="problematic" id="id4">`其中也有 `簡化版 (欄位較少) 的資料庫&lt;http://www.naturalearthdata.com/http//www.naturalearthdata.com/download/10m/cultural/ne_10m_populated_places_simple.zip&gt;`_</span></a></p>
<p>為了方便起見，你也可以直接用下面的連結下載這兩份資料集：</p>
<p><a href="#id1"><span class="problematic" id="id2">`</span></a>signif.txt &lt;<a class="reference external" href="http://www.qgistutorials.com/downloads/signif.txt">http://www.qgistutorials.com/downloads/signif.txt</a>&gt;</p>
<p><a class="reference external" href="http://www.qgistutorials.com/downloads/ne_10m_populated_places_simple.zip">ne_10m_populated_places_simple.zip</a></p>
<p>資料來源 <a class="reference internal" href="credits.html#ngdc" id="id1">[NGDC]</a> <a class="reference internal" href="credits.html#naturalearth" id="id2">[NATURALEARTH]</a></p>
</div>
<div class="section" id="procedure">
<h2>操作流程<a class="headerlink" href="#procedure" title="Permalink to this headline">¶</a></h2>
<ol class="arabic simple">
<li><p class="first">打開 QGIS，選擇 <span class="menuselection">圖層 ‣ 加入分隔文字圖層</span>，然後選擇剛下載的 <code class="docutils literal"><span class="pre">signif.txt</span></code>。</p>
</li>
</ol>
<img alt="../_images/1155.png" class="align-center" src="../_images/1155.png" />
<ol class="arabic simple" start="2">
<li><p class="first">這個檔案是 <em>Tab 分隔檔</em>，所以我們可以在 <span class="guilabel">檔案格式</span> 欄位選擇 <span class="guilabel">定位鍵</span>。程式會自動選擇 <span class="guilabel">X</span> 和 <span class="guilabel">Y</span> 欄位，所以按下 <span class="guilabel">確定</span> 即可。</p>
</li>
</ol>
<div class="admonition note">
<p class="first admonition-title">註解</p>
<p class="last">可能你會看到 QGIS 顯示讀取檔案的時候出現了一些錯誤，這是由於檔案中的某些值異常所引起的，這些異常的資料不會被讀取。在本教學中，我們就先忽略這些錯誤沒關係。</p>
</div>
<img alt="../_images/2103.png" class="align-center" src="../_images/2103.png" />
<ol class="arabic simple" start="3">
<li><p class="first">由於地震資料採用經緯度座標，輸入的 CRS 應該會採用 <code class="docutils literal"><span class="pre">EPSG:</span> <span class="pre">4326</span></code>，可在視窗右下角檢查是否正確。接下來來開啟人口聚居地圖層，選擇 <span class="menuselection">圖層 ‣ 加入向量圖層</span>。</p>
</li>
</ol>
<img alt="../_images/362.png" class="align-center" src="../_images/362.png" />
<ol class="arabic simple" start="4">
<li><p class="first">選擇剛下載的 <code class="docutils literal"><span class="pre">ne_10m_populated_places_simple.zip</span></code> 並按下 <span class="guilabel">確定</span>。</p>
</li>
</ol>
<img alt="../_images/442.png" class="align-center" src="../_images/442.png" />
<ol class="arabic simple" start="5">
<li><p class="first">稍微縮放一下瀏覽這兩個資料庫。每個紫色的點都是一個重要地震，而每個藍色的點都是一個人口聚居地（譯按：你的點顏色可能會不同，請對照圖層各自的名字）。我們要做的是為每個地震點找出最接近的人口聚居地。</p>
</li>
</ol>
<img alt="../_images/542.png" class="align-center" src="../_images/542.png" />
<ol class="arabic simple" start="6">
<li><p class="first">選擇 <span class="menuselection">向量 ‣ 分析工具 ‣ 距離矩陣</span>。</p>
</li>
</ol>
<img alt="../_images/640.png" class="align-center" src="../_images/640.png" />
<ol class="arabic simple" start="7">
<li><p class="first">在開啟的視窗中，「輸入點圖層」選擇 <code class="docutils literal"><span class="pre">signif</span></code>，「目標點圖層」選擇 <code class="docutils literal"><span class="pre">ne_10m_populated_places_simple</span></code>。此外，我們還要為這兩個圖層選擇一個「唯一ID欄位」（每個點的此欄位值都不相同），輸出檔將會依照此欄位顯示。在此例中，我們只要尋找最接近的 <code class="docutils literal"><span class="pre">1</span></code> 個點，所以要勾選 <span class="guilabel">僅使用最鄰近(k)目標點</span>，然後輸入 <span class="guilabel">1</span>。把輸出檔命名為 <code class="docutils literal"><span class="pre">matrix.csv</span></code>，然後按下確定。程式執行完畢後，點選 <span class="guilabel">關閉</span>。</p>
</li>
</ol>
<div class="admonition note">
<p class="first admonition-title">註解</p>
<p class="last">有件事值得一提：你可以只針對單一圖層執行近鄰分析，只需要把輸入點圖層和目標點圖層都設為相同圖層即可。輸入就會是在 1 個圖層中的點的近鄰結果。</p>
</div>
<img alt="../_images/739.png" class="align-center" src="../_images/739.png" />
<ol class="arabic simple" start="8">
<li><p class="first">程式執行完畢後，在 <span class="guilabel">距離矩陣</span> 視窗點選 <span class="guilabel">關閉</span>。現在你可以使用 Notepad 或任何的文字編輯器瀏覽 <code class="docutils literal"><span class="pre">matrix.csv</span></code>。QGIS 也可以把此檔案匯入，這樣就可以把結果加到 QGIS 中瀏覽了。選擇 <span class="menuselection">圖層 ‣ 加入分隔文字圖層</span>。</p>
</li>
</ol>
<img alt="../_images/838.png" class="align-center" src="../_images/838.png" />
<ol class="arabic simple" start="9">
<li><p class="first">選擇剛剛產生的新檔案 <code class="docutils literal"><span class="pre">matrix.csv</span></code>，因為它只包含了文字的欄位，所以要在 <span class="guilabel">幾何欄位定義</span> 選項中勾選 <span class="guilabel">無幾何欄位 (僅產生屬性表格)</span>。按下 <span class="guilabel">確定</span>。</p>
</li>
</ol>
<img alt="../_images/937.png" class="align-center" src="../_images/937.png" />
<ol class="arabic simple" start="10">
<li><p class="first">現在此 CSV 檔案已以表格的形式匯入 QGIS 中。在這個表格上按右鍵，選擇 <span class="guilabel">開啟屬性表格</span>，</p>
</li>
</ol>
<img alt="../_images/1036.png" class="align-center" src="../_images/1036.png" />
<ol class="arabic simple" start="11">
<li><p class="first">現在就可以看到近鄰分析的結果了。<span class="guilabel">InputID</span> 欄位是從地震的圖層過來的，<span class="guilabel">TargetID</span> 則是從人口聚居地的圖層過來的，代表距離地震最近的人口聚居點。<span class="guilabel">Distance</span> 則是 2 個點的距離。</p>
</li>
</ol>
<div class="admonition note">
<p class="first admonition-title">註解</p>
<p class="last">這裡距離的計算是使用圖層的 CRS，也就是說因為我們的來源圖層是經緯度座標，輸入距離的單位也會是<em>角度</em>。如果你想要把距離用公尺呈現，在執行近鄰分析之前，要先重投影輸入的圖層。</p>
</div>
<img alt="../_images/1156.png" class="align-center" src="../_images/1156.png" />
<ol class="arabic simple" start="12">
<li><p class="first">本結果已相當接近我們想要的樣子。對某些使用者來說，得到一張表格已顯足夠；然而，我們可以把結果進一步<strong>連接</strong>到原本的地震圖層屬性表格上。以右鍵點選地震圖層，選擇 <span class="guilabel">屬性</span>。</p>
</li>
</ol>
<img alt="../_images/1237.png" class="align-center" src="../_images/1237.png" />
<ol class="arabic simple" start="13">
<li><p class="first">前往 <span class="guilabel">連結（Joins）</span>的分頁，按下 <span class="guilabel">+</span> 按鈕。</p>
</li>
</ol>
<img alt="../_images/1436.png" class="align-center" src="../_images/1436.png" />
<ol class="arabic simple" start="14">
<li><p class="first">我們要作的是連接我們的分析結果到此圖層上，所以必須要為兩個表格各選擇一個能夠連接起來（具有相同數值）的欄位。為 <span class="guilabel">連結（Join）圖層</span> 選擇 <code class="docutils literal"><span class="pre">matrix</span></code>，再為 <span class="guilabel">連結欄位</span> 選擇 <code class="docutils literal"><span class="pre">InputID</span></code>，而 <span class="guilabel">目標欄位</span> 就選擇 <code class="docutils literal"><span class="pre">I_D</span></code>。其他選項使用預設值，最後按下 <span class="guilabel">確定</span>。</p>
</li>
</ol>
<img alt="../_images/1436.png" class="align-center" src="../_images/1436.png" />
<ol class="arabic simple" start="15">
<li><p class="first">在 <span class="guilabel">連結（Joins）</span>的分頁中，就出現了一筆連接資訊。按下 <span class="guilabel">確定</span>。</p>
</li>
</ol>
<img alt="../_images/1534.png" class="align-center" src="../_images/1534.png" />
<ol class="arabic simple" start="16">
<li><p class="first">現在在 <code class="docutils literal"><span class="pre">signif</span></code> 圖層上按右鍵選 <span class="guilabel">開啟屬性表格</span>。</p>
</li>
</ol>
<img alt="../_images/1630.png" class="align-center" src="../_images/1630.png" />
<ol class="arabic simple" start="17">
<li><p class="first">現在每個地震的圖徵，都多了新屬性顯示最近的 (人口聚居地) 點圖徵，以及其距離。</p>
</li>
</ol>
<img alt="../_images/1727.png" class="align-center" src="../_images/1727.png" />
<ol class="arabic simple" start="18">
<li><p class="first">接下來我們要來看看怎麼視覺畫這些結果。首先，我們要另存新圖層，把資料表連接的結果永久保存下來。以右鍵點選 <code class="docutils literal"><span class="pre">signif</span></code> 然後選擇 <span class="guilabel">存檔為...</span>，</p>
</li>
</ol>
<img alt="../_images/1828.png" class="align-center" src="../_images/1828.png" />
<ol class="arabic simple" start="19">
<li><p class="first">點選在 <span class="guilabel">另存為</span> 欄位側邊的 <span class="guilabel">瀏覽</span> 鈕，把新檔案命名為 <code class="docutils literal"><span class="pre">earthquake_with_places.shp</span></code>，確認一下 <span class="guilabel">加入儲存檔案至地圖中</span> 有開啟，最後按下 <span class="guilabel">確定</span>。</p>
</li>
</ol>
<img alt="../_images/1923.png" class="align-center" src="../_images/1923.png" />
<ol class="arabic simple" start="20">
<li><p class="first">新圖層載入後，就可以把 <code class="docutils literal"><span class="pre">signif</span></code> 圖層取消勾選以隱藏起來。由於本資料集相當大，所以我們可以先對資料集的一部分進行視覺化試試看。QGIS 可以讓你不用另存新檔或匯入新圖層，就載入某個圖層的子集。在 <code class="docutils literal"><span class="pre">earthquake_with_places</span></code> 上以右鍵點選進入 <span class="guilabel">屬性</span>。</p>
</li>
</ol>
<img alt="../_images/2016.png" class="align-center" src="../_images/2016.png" />
<ol class="arabic simple" start="21">
<li><p class="first">在「<span class="guilabel">一般</span>」分頁中，找到 <span class="guilabel">Feature subset</span> （或 Provider feature filter）的欄位，選擇 <span class="guilabel">查詢建構器</span>。</p>
</li>
</ol>
<img alt="../_images/2120.png" class="align-center" src="../_images/2120.png" />
<ol class="arabic simple" start="22">
<li><p class="first">本教學中，我們要把焦點放在墨西哥附近的地震和人口聚居地。因此，請在 <span class="guilabel">查詢建構器</span> 中輸入以下的表達式。</p>
</li>
</ol>
<div class="highlight-none"><div class="highlight"><pre><span></span>&quot;COUNTRY&quot; = &#39;MEXICO&#39;
</pre></div>
</div>
<img alt="../_images/2219.png" class="align-center" src="../_images/2219.png" />
<ol class="arabic simple" start="23">
<li><p class="first">可以看到在 QGIS 視窗中，只剩下落在墨西哥境內的地震會顯示。接下來對人口聚居地的層進行相同操作，在 <code class="docutils literal"><span class="pre">ne_10m_populated_places_simple</span></code> 上以右鍵點選進入 <span class="guilabel">屬性</span>。</p>
</li>
</ol>
<img alt="../_images/2317.png" class="align-center" src="../_images/2317.png" />
<ol class="arabic simple" start="24">
<li><p class="first">在「<span class="guilabel">一般</span>」分頁中，開啟 <span class="guilabel">查詢建構器</span>，輸入以下的表達式。</p>
</li>
</ol>
<div class="highlight-none"><div class="highlight"><pre><span></span>&quot;adm0name&quot; = &#39;Mexico&#39;
</pre></div>
</div>
<img alt="../_images/2416.png" class="align-center" src="../_images/2416.png" />
<ol class="arabic simple" start="25">
<li><p class="first">資料呈現的準備已經完成。我們接下來要使用一個稱為 <code class="docutils literal"><span class="pre">MMQGIS</span></code> 的核心附加元件，可參考 <a class="reference internal" href="using_plugins.html"><em>使用附加元件</em></a> 進行搜尋及安裝等相關操作。安裝後，選擇 <span class="menuselection">MMQGIS ‣ Create ‣ Hub Lines</span>。</p>
</li>
</ol>
<img alt="../_images/2515.png" class="align-center" src="../_images/2515.png" />
<ol class="arabic simple" start="26">
<li><p class="first"><span class="guilabel">Hub Point Layer</span> 欄位選擇 <code class="docutils literal"><span class="pre">ne_10m_populated_places_simple</span></code>，<span class="guilabel">Hub ID Attribute</span> 欄位選 <code class="docutils literal"><span class="pre">name</span></code>，<span class="guilabel">Spoke Point Layer</span> 欄位選擇 <code class="docutils literal"><span class="pre">earthquake_with_places</span></code>，<span class="guilabel">Spoke Hub ID Attribute</span> 欄位選擇 <code class="docutils literal"><span class="pre">matrix_Tar</span></code>。此程式會藉由比對屬性欄位值，把每個地震點和最鄰近的人口點用線連接起來。點選 <span class="guilabel">Browse</span> 然後把 <span class="guilabel">Output Shapefile</span> 命名為 <code class="docutils literal"><span class="pre">earthquake_hub_lines.shp</span></code>，最後按下 <span class="guilabel">確定</span> 開始執行。</p>
</li>
</ol>
<img alt="../_images/2613.png" class="align-center" src="../_images/2613.png" />
<ol class="arabic simple" start="27">
<li><p class="first">程式可能會花幾分鐘的時間。你可以在 QGIS 螢幕左下角看到目前進度。</p>
</li>
</ol>
<img alt="../_images/2713.png" class="align-center" src="../_images/2713.png" />
<ol class="arabic simple" start="28">
<li><p class="first">處理結束後，<code class="docutils literal"><span class="pre">earthquake_hub_lines</span></code> 圖層會載到 QGIS 中，可以看到現在每個地震都附帶一條線，連接到最接近的人口聚居地。</p>
</li>
</ol>
<img alt="../_images/2812.png" class="align-center" src="../_images/2812.png" />
</div>
</div>





  <div id="disqus_thread"></div>
  <noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
  <a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>


    </div>
      
  </div>
</div>

<footer class="footer">
  <div class="container">
    <p class="pull-right">
      <a href="#">Back to top</a>
      
    </p>
    <p>
        &copy; Copyright 2019, Ujaval Gandhi.<br/>
      最後更新日期是 Jul 13, 2019.<br/>
      Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 1.3.6.<br/>
    </p>
  </div>
</footer>
<div class="container">
  <p>This work is licensed under a <a href="http://creativecommons.org/licenses/by/4.0/deed.en_US">Creative Commons Attribution 4.0 International License</a></p>
</div>
<!-- Twitter Button -->
<script>!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0],p=/^http:/.test(d.location)?'http':'https';if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src=p+'://platform.twitter.com/widgets.js';fjs.parentNode.insertBefore(js,fjs);}}(document, 'script', 'twitter-wjs');</script>

<!-- Disqus comments widget -->
<script type="text/javascript">
  /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
  var disqus_shortname = 'qgistutorials'; // required: replace example with your forum shortname
  /* * * DON'T EDIT BELOW THIS LINE * * */
  (function () {
    var s = document.createElement('script'); s.async = true;
    s.type = 'text/javascript';
    s.src = '//' + disqus_shortname + '.disqus.com/count.js';
    (document.getElementsByTagName('HEAD')[0] || document.getElementsByTagName('BODY')[0]).appendChild(s);
  }());
</script>

<script type="text/javascript">
  /* * * DON'T EDIT BELOW THIS LINE * * */
  (function() {
    var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
    dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
    (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
  })();
</script>

<!-- Script fpr language switching. Largely adapted from https://github.com/pcav/faunalia-website -->
<script>
    var currentPage = 'docs/nearest_neighbor_analysis.html'; // coming from sphinx, always without starting '/'
    var currentLang = 'en';
    $(document).ready(function(){

        var search = new RegExp('\/[a-zA-Z_]{2,8}\/'+ currentPage, 'gi');
        var langPlusPage = window.location.href.match(search);
        // it's possible this is a index.html page called without 'index.html', try without the currentPage
        if (langPlusPage==undefined){
            search = new RegExp('\/[a-zA-Z_]{2,8}\/$', 'gi');
            langPlusPage = window.location.href.match(search);
        }

        // it's possible this is an index.html page called without 'index.html', try removing index.html
        if (langPlusPage==undefined){
            currentPage = currentPage.replace('index.html','')
            search = new RegExp('\/[a-zA-Z_]{2,8}\/'+ currentPage, 'gi');
            langPlusPage = window.location.href.match(search);
        }
        // still no langPlugPage: stop, because the language swicher will misbehave 

        if (langPlusPage == undefined || langPlusPage.length != 1){
            alert('You hit an error, please report back to us.');
            return;
        }
        langPlusPage = langPlusPage[0];
        currentLang = langPlusPage.replace(currentPage, '');

        $("#languages").val(currentLang.replace(/\//g,'')); // currentLang is something like '/nl/'

        $("#languages").change(function() {
            gotoLang($(this).val());
        });

    });

    // load current page in a different language
    function gotoLang(lang){
        var currentUrl = window.location.href;
        var newUrl = currentUrl.replace(currentLang, '/'+lang+'/');
        window.location.href = newUrl;
    }
</script>

  </body>
</html>