<!DOCTYPE html>


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>資料表連接 (QGIS3) &mdash; QGIS Tutorials and Tips</title>
    
    <link rel="stylesheet" href="../../_static/basic.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/bootswatch-3.2.0/united/bootstrap.min.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/bootstrap-sphinx.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../../',
        VERSION:     '1',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../_static/doctools.js"></script>
    <script type="text/javascript" src="../../_static/translations.js"></script>
    <script type="text/javascript" src="../../_static/js/jquery-1.11.0.min.js"></script>
    <script type="text/javascript" src="../../_static/js/jquery-fix.js"></script>
    <script type="text/javascript" src="../../_static/bootstrap-3.2.0/js/bootstrap.min.js"></script>
    <script type="text/javascript" src="../../_static/bootstrap-sphinx.js"></script>
    <link rel="top" title="QGIS Tutorials and Tips" href="../../index.html" />
    <link rel="next" title="空間連接 (QGIS3)" href="performing_spatial_joins.html" />
    <link rel="prev" title="把地圖數位化" href="../digitizing_basics.html" />

<meta charset='utf-8'>
<meta http-equiv='X-UA-Compatible' content='IE=edge,chrome=1'>
<meta name='viewport' content='width=device-width, initial-scale=1.0, maximum-scale=1'>
<meta name="apple-mobile-web-app-capable" content="yes">

<!-- Google Analytics -->
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-690672-13', 'qgistutorials.com');
  ga('require', 'displayfeatures');
  ga('send', 'pageview');
</script>


  </head>
  <body role="document">

  <div id="navbar" class="navbar navbar-default navbar-fixed-top">
    <div class="container">
      <div class="navbar-header">
        <!-- .btn-navbar is used as the toggle for collapsed navbar content -->
        <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".nav-collapse">
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>
        <a class="navbar-brand" href="../../index.html"><img src="../../_static/logo.png">
          QGIS Tutorials and Tips</a>
        <span class="navbar-text navbar-version pull-left"><b>v1.0</b></span>
      </div>

        <div class="collapse navbar-collapse nav-collapse">
          <ul class="nav navbar-nav">
            
            
              <li class="dropdown globaltoc-container">
  <a role="button"
     id="dLabelGlobalToc"
     data-toggle="dropdown"
     data-target="#"
     href="../../index.html">Tutorials List <b class="caret"></b></a>
  <ul class="dropdown-menu globaltoc"
      role="menu"
      aria-labelledby="dLabelGlobalToc"><ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../introduction.html">簡介</a></li>
<li class="toctree-l1"><a class="reference internal" href="making_a_map.html">製作地圖 (QGIS3)</a></li>
<li class="toctree-l1"><a class="reference internal" href="working_with_attributes.html">Working with Attributes (QGIS3)</a></li>
<li class="toctree-l1"><a class="reference internal" href="importing_spreadsheets_csv.html">匯入工作表或 CSV 檔 (QGIS3)</a></li>
<li class="toctree-l1"><a class="reference internal" href="basic_vector_styling.html">Basic Vector Styling (QGIS3)</a></li>
<li class="toctree-l1"><a class="reference internal" href="calculating_line_lengths.html">Calculating Line Lengths and Statistics (QGIS3)</a></li>
<li class="toctree-l1"><a class="reference internal" href="raster_styling_and_analysis.html">Basic Raster Styling and Analysis (QGIS3)</a></li>
<li class="toctree-l1"><a class="reference internal" href="raster_mosaicing_and_clipping.html">Raster Mosaicing and Clipping (QGIS3)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../working_with_terrain.html">地形資料的操作</a></li>
<li class="toctree-l1"><a class="reference internal" href="../working_with_wms.html">WMS 資料的操作</a></li>
<li class="toctree-l1"><a class="reference internal" href="../working_with_projections.html">投影的操作</a></li>
<li class="toctree-l1"><a class="reference internal" href="georeferencing_basics.html">為紙本地圖進行空間對位 (QGIS3)</a></li>
<li class="toctree-l1"><a class="reference internal" href="advanced_georeferencing.html">為空照圖進行空間對位 (QGIS3)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../digitizing_basics.html">把地圖數位化</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="">資料表連接 (QGIS3)</a></li>
<li class="toctree-l1"><a class="reference internal" href="performing_spatial_joins.html">空間連接 (QGIS3)</a></li>
<li class="toctree-l1"><a class="reference internal" href="creating_heatmaps.html">製作熱區圖 (QGIS3)</a></li>
<li class="toctree-l1"><a class="reference internal" href="animating_time_series.html">Animating Time Series Data (QGIS3)</a></li>
<li class="toctree-l1"><a class="reference internal" href="handling_invalid_geometries.html">Handling Invalid Geometries (QGIS3)</a></li>
<li class="toctree-l1"><a class="reference internal" href="performing_spatial_queries.html">Performing Spatial Queries (QGIS3)</a></li>
<li class="toctree-l1"><a class="reference internal" href="nearest_neighbor_analysis.html">Nearest Neighbor Analysis (QGIS3)</a></li>
<li class="toctree-l1"><a class="reference internal" href="sampling_raster_data.html">Sampling Raster Data using Points or Polygons (QGIS3)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../interpolating_point_data.html">點資料內插法</a></li>
<li class="toctree-l1"><a class="reference internal" href="batch_processing.html">使用處理框架進行批次處理 (QGIS3)</a></li>
<li class="toctree-l1"><a class="reference internal" href="processing_graphical_modeler.html">利用處理建模自動執行複雜的工作流程 (QGIS3)</a></li>
<li class="toctree-l1"><a class="reference internal" href="automating_map_creation.html">Automating Map Creation with Print Layout Atlas (QGIS3)</a></li>
<li class="toctree-l1"><a class="reference internal" href="multi_criteria_overlay.html">Multi Criteria Overlay Analysis (QGIS3)</a></li>
<li class="toctree-l1"><a class="reference internal" href="basic_network_analysis.html">Basic Network Visualization and Routing (QGIS3)</a></li>
<li class="toctree-l1"><a class="reference internal" href="origin_destination_matrix.html">Locating Nearest Facility with Origin-Destination Matrix (QGIS3)</a></li>
<li class="toctree-l1"><a class="reference internal" href="service_area_analysis.html">Service Area Analysis using Openrouteservice (QGIS3)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../using_qgis_browser.html">使用 QGIS 瀏覽器</a></li>
<li class="toctree-l1"><a class="reference internal" href="../open_bil_bip_bsq_files.html">在 QGIS 中開啟 BIL、BIP 或 BSQ 格式檔案</a></li>
<li class="toctree-l1"><a class="reference internal" href="getting_started_with_pyqgis.html">Python 程式設計的初步上手 (QGIS3)</a></li>
<li class="toctree-l1"><a class="reference internal" href="processing_algorithms_pyqgis.html">Running Processing Algorithms via Python (QGIS3)</a></li>
<li class="toctree-l1"><a class="reference internal" href="building_a_python_plugin.html">以 Python 製作附加元件 (QGIS3)</a></li>
<li class="toctree-l1"><a class="reference internal" href="processing_python_plugin.html">Building a Processing Plugin (QGIS3)</a></li>
<li class="toctree-l1"><a class="reference internal" href="custom_python_functions.html">使用自訂的 Python 表達式函數 (QGIS3)</a></li>
<li class="toctree-l1"><a class="reference internal" href="processing_python_scripts.html">撰寫 Python 腳本並在處理框架下執行（QGIS3)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../running_qgis_jobs.html">執行 QGIS 工作排程</a></li>
<li class="toctree-l1"><a class="reference internal" href="../performing_table_joins_pyqgis.html">資料表連接 (PyQGIS)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../web_mapping_with_qgis2web.html">使用 QGIS2Web 線上製圖</a></li>
<li class="toctree-l1"><a class="reference internal" href="../creating_basemaps_with_qtiles.html">用 QTiles 製作底圖</a></li>
<li class="toctree-l1"><a class="reference internal" href="../using_plugins.html">使用附加元件</a></li>
<li class="toctree-l1"><a class="reference internal" href="../downloading_osm_data.html">搜尋和下載開放街圖資料</a></li>
<li class="toctree-l1"><a class="reference internal" href="../learning_resources.html">QGIS 學習資源</a></li>
<li class="toctree-l1"><a class="reference internal" href="../credits.html">資料來源</a></li>
<li class="toctree-l1"><a class="reference internal" href="../batch_processing.html">使用處理框架進行批次處理 (QGIS2)</a></li>
</ul>
</ul>
</li>
              
            
            
              
                
  <li>
    <a href="../digitizing_basics.html" title="Previous Chapter: 把地圖數位化"><span class="glyphicon glyphicon-chevron-left visible-sm"></span><span class="hidden-sm hidden-tablet">&laquo; 把地圖數位化</span>
    </a>
  </li>
  <li>
    <a href="performing_spatial_joins.html" title="Next Chapter: 空間連接 (QGIS3)"><span class="glyphicon glyphicon-chevron-right visible-sm"></span><span class="hidden-sm hidden-tablet">空間連接 (QGIS3) &raquo;</span>
    </a>
  </li>
              
            
            

            

            
              <li class="hidden-sm"></li>
            
          </ul>

          
            
<form class="navbar-form navbar-right" action="../../search.html" method="get">
 <div class="form-group">
  <input type="text" name="q" class="form-control" placeholder="Search" />
 </div>
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
          
        </div>
    </div>
  </div>

<div class="container">
  <div class="row">
      <div class="col-md-3">
        <div id="sidebar" class="bs-sidenav" role="complementary"><h4>Author</h4>
<p>Ujaval Gandhi</p>
<a href="https://twitter.com/intent/follow?screen_name=spatialthoughts" class="twitter-follow-button" data-show-count="false">Follow @spatialthoughts</a>
<hr>
<p>Take my QGIS courses! Visit
<a href="https://spatialthoughts.com/" target="_blank">my company website.</a></p>

<hr>
<!-- Begin Mailchimp Signup Form -->
<link href="//cdn-images.mailchimp.com/embedcode/slim-10_7.css" rel="stylesheet" type="text/css">
<style type="text/css">
	#mc_embed_signup{background:#fff; clear:left; font:14px Helvetica,Arial,sans-serif; }
	/* Add your own Mailchimp form style overrides in your site stylesheet or in this style block.
	   We recommend moving this block and the preceding CSS link to the HEAD of your HTML file. */
</style>
<div id="mc_embed_signup">
<h4>Subscribe to my mailing list</h4>
<p>Get occasional emails when I post new material or announce training events.</p>
<form action="https://spatialthoughts.us20.list-manage.com/subscribe/post?u=59d493847a7c7c2dbf12b21e6&amp;id=8fb09ab55c" method="post" id="mc-embedded-subscribe-form" name="mc-embedded-subscribe-form" class="validate" target="_blank" novalidate>
    <div id="mc_embed_signup_scroll">
	<input type="email" value="" name="EMAIL" class="email" id="mce-EMAIL" placeholder="email address" required>
    <!-- real people should not fill this in and expect good things - do not remove this or risk form bot signups-->
    <div style="position: absolute; left: -5000px;" aria-hidden="true"><input type="text" name="b_59d493847a7c7c2dbf12b21e6_8fb09ab55c" tabindex="-1" value=""></div>
    <div class="clear"><input type="submit" value="Subscribe" name="subscribe" id="mc-embedded-subscribe" class="button"></div>
    </div>
</form>
</div>

<!--End mc_embed_signup-->

<h4>Change Language</h4>
<form role="form" class="sidebar-form sidebar-left">
<select id="languages" class="form-control select-mini">
  <option value="en">English</option>
  <option value="zh_TW">Chinese (Taiwan)</option>
  <option value="nl">Dutch</option>
  <option value="fi_FI">Finnish</option>
  <option value="fr">French</option>
  <option value="de">German</option>
  <option value="el">Greek</option>
  <option value="id">Indonesian</option>
  <option value="it">Italian</option>
  <option value="ko">Korean</option>
  <option value="pt_BR">Portuguese</option>
  <option value="ro">Romanian</option>
  <option value="ru">Russian</option>
  <option value="sl">Slovenian</option>
  <option value="es">Spanish</option>
  <option value="th">Thai</option>
  <option value="tr">Turkish</option>
  <option value="uk">Ukrainian</option>
  <option value="vi">Vietnamese</option>
</select>
</form>
        </div>
      </div>
    <div class="col-md-9">
      

  <div class="section" id="performing-table-joins-qgis3">
<h1>資料表連接 (QGIS3)<a class="headerlink" href="#performing-table-joins-qgis3" title="Permalink to this headline">¶</a></h1>
<p>Not every dataset you want to use comes in spatial format. Often the data would come as a table or a spreadsheet and you would need to link it with your existing spatial data for use in your analysis. This operation is known as a <strong>Table Join</strong> and is done using the <code class="docutils literal"><span class="pre">Join</span> <span class="pre">attributes</span> <span class="pre">by</span> <span class="pre">field</span> <span class="pre">value</span></code> Processing algorithm.</p>
<div class="section" id="overview-of-the-task">
<h2>內容說明<a class="headerlink" href="#overview-of-the-task" title="Permalink to this headline">¶</a></h2>
<p>我們會使用美國加州的人口統計分區 shapefile，與美國人口調查局提供的人口數資料表，做一份加州的人口分佈圖。</p>
<div class="section" id="other-skills-you-will-learn">
<h3>你還會學到這些<a class="headerlink" href="#other-skills-you-will-learn" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p class="first">在 QGIS 中載入不含任何地理資訊的 CSV 檔案</p>
</li>
<li>Using DB Manager to perform SQL queries to calculate group statistics.</li>
</ul>
</div>
</div>
<div class="section" id="get-the-data">
<h2>取得資料<a class="headerlink" href="#get-the-data" title="Permalink to this headline">¶</a></h2>
<p><a class="reference external" href="https://www.census.gov/en.html">US Census Bureau</a> provides <a class="reference external" href="https://www.census.gov/geographies/mapping-files/time-series/geo/tiger-line-file.html">TIGER/Line Shapefiles</a>. You can visit the <a class="reference external" href="https://www2.census.gov/geo/tiger/TIGER2018/">FTP site</a> and download census tracts shapefile for California. Download <a class="reference external" href="https://www2.census.gov/geo/tiger/TIGER2018/TRACT/tl_2018_06_tract.zip">Census Tracts for California</a> file.</p>
<p><a class="reference external" href="http://factfinder2.census.gov/faces/nav/jsf/pages/searchresults.xhtml?refresh=t">Americal FactFinder</a> is a repository of all census data for the US. You can use <cite>Advanced Search</cite> and query for the <cite>Topic - Basic Count/Estimate</cite> and <cite>Geographies - All Census Tracts in California</cite> to create a custom CSV and download it. This tutorial uses <code class="docutils literal"><span class="pre">TOTAL</span> <span class="pre">POPULATION</span> <span class="pre">|</span> <span class="pre">2017</span> <span class="pre">ACS</span> <span class="pre">5-year</span> <span class="pre">estimates</span></code> data.</p>
<img alt="../../_images/data13.png" class="align-center" src="../../_images/data13.png" />
<p>為了方便起見，你也可以直接用下面的連結下載這兩份資料集：</p>
<p><a class="reference external" href="http://www.qgistutorials.com/downloads/tl_2018_06_tract.zip">tl_2018_06_tract.zip</a></p>
<p><a class="reference external" href="http://www.qgistutorials.com/downloads/ACS_17_5YR_B01003.zip">ACS_17_5YR_B01003.zip</a></p>
<p>資料來源 <a class="reference internal" href="../credits.html#tiger" id="id1">[TIGER]</a> <a class="reference internal" href="../credits.html#uscensus" id="id2">[USCENSUS]</a></p>
</div>
<div class="section" id="procedure">
<h2>操作流程<a class="headerlink" href="#procedure" title="Permalink to this headline">¶</a></h2>
<ol class="arabic simple">
<li>Locate the <code class="docutils literal"><span class="pre">tl_2018_06_tract.zip</span></code> file in the QGIS Browser and expand it. Select the <code class="docutils literal"><span class="pre">tl_2018_06_tract.shp</span></code> file and drag it to the canvas.</li>
</ol>
<blockquote>
<div><img alt="../../_images/1104.png" class="align-center" src="../../_images/1104.png" />
</div></blockquote>
<ol class="arabic simple" start="2">
<li>You will see the layer <code class="docutils literal"><span class="pre">tl_2018_06_tract</span></code> loaded in the <span class="guilabel">Layers</span> panel. This layer contains the boundaries of census tracts in California. Right-click on the <code class="docutils literal"><span class="pre">tl_2018_06_tract</span></code> layer and select <span class="guilabel">Open Attribute Table</span>.</li>
</ol>
<blockquote>
<div><img alt="../../_images/257.png" class="align-center" src="../../_images/257.png" />
</div></blockquote>
<ol class="arabic simple" start="3">
<li>Examine the attributes of the layer. To join a table with this layer, we need a unique and common attribute for each feature. In this case, the <code class="docutils literal"><span class="pre">GEOID</span></code> field is a unique identifier for each tract and can be used to link this layer with any other layer or table containing the same ID.</li>
</ol>
<blockquote>
<div><img alt="../../_images/335.png" class="align-center" src="../../_images/335.png" />
</div></blockquote>
<ol class="arabic simple" start="4">
<li>Unzip the <code class="docutils literal"><span class="pre">ACS_17_5YR_B01003.zip</span></code> file and open the <code class="docutils literal"><span class="pre">ACS_17_5YR_B01003_with_ann.csv</span></code> file in a text editor. You will notice that each row of the file contains information about a tract along with the unique identifier we saw in the previous step. Note that this field is called <code class="docutils literal"><span class="pre">GEO.id2</span></code> in the CSV. You will also note that the <code class="docutils literal"><span class="pre">HD01_VD01</span></code> column has population value for each of the census tract.</li>
</ol>
<blockquote>
<div><img alt="../../_images/420.png" class="align-center" src="../../_images/420.png" />
</div></blockquote>
<ol class="arabic simple" start="5">
<li>Before importing this CSV file, we need to make a minor edit. QGIS CSV importer expects the first row of the file to contain the column headers and all remaining rows to contain the data for these columns. This file contains an extra row 2 with column labels. Delete that row and save the file.</li>
</ol>
<blockquote>
<div><img alt="../../_images/520.png" class="align-center" src="../../_images/520.png" />
</div></blockquote>
<ol class="arabic simple" start="6">
<li>Now we are ready to import the CSV file to QGIS. Go to <span class="menuselection">Layer ‣ Add Layer ‣ Add Delimited Text Layer</span>.</li>
</ol>
<blockquote>
<div><img alt="../../_images/620.png" class="align-center" src="../../_images/620.png" />
</div></blockquote>
<ol class="arabic simple" start="7">
<li>In the <span class="guilabel">Data Source Manager</span> window, click the <span class="guilabel">...</span> button and browse to the CSV file and select it. Make sure you have selected <span class="guilabel">File format</span> as <span class="guilabel">CSV (comma separated values)</span>. Since we are importing this as a table, we must specify that our file contains no geometry using  the <span class="guilabel">No geometry (attribute table only)</span> option. Verify that <span class="guilabel">Sample Data</span> preview at the bottom looks fine and click <span class="guilabel">Add</span> followed by <span class="guilabel">Close</span>.</li>
</ol>
<blockquote>
<div><img alt="../../_images/719.png" class="align-center" src="../../_images/719.png" />
</div></blockquote>
<ol class="arabic simple" start="8">
<li>The CSV will now be imported as a table to QGIS and will appear as <code class="docutils literal"><span class="pre">ACS_17_5YR_B01003_with_ann</span></code> in the <span class="guilabel">Layers</span> panel. Now we are ready to create the table join. Go to <span class="menuselection">Processing ‣ Toolbox</span>.</li>
</ol>
<blockquote>
<div><img alt="../../_images/819.png" class="align-center" src="../../_images/819.png" />
</div></blockquote>
<ol class="arabic simple" start="9">
<li>First we need to change a default setting in the <span class="guilabel">Processing Toolbox</span>. Click the <span class="guilabel">Options</span> button.</li>
</ol>
<blockquote>
<div><img alt="../../_images/919.png" class="align-center" src="../../_images/919.png" />
</div></blockquote>
<ol class="arabic simple" start="10">
<li>In the <span class="guilabel">Processing Options</span> tab, check the <span class="guilabel">Use filename as layer name</span> option. When using algorithms from Processing Toolbox, this option makes the output layer names much more intuitive and useful. Click <span class="guilabel">OK</span>.</li>
</ol>
<blockquote>
<div><img alt="../../_images/1019.png" class="align-center" src="../../_images/1019.png" />
</div></blockquote>
<ol class="arabic simple" start="11">
<li>Back in the <span class="guilabel">Processing Toolbox</span>, search and locate the <span class="menuselection">Vector General ‣ Join attributes by field value</span> algorithm and double-click it to open it.</li>
</ol>
<blockquote>
<div><img alt="../../_images/1122.png" class="align-center" src="../../_images/1122.png" />
</div></blockquote>
<ol class="arabic simple" start="12">
<li>In the <span class="guilabel">Join Attributes by Field Values</span> dialog, select <code class="docutils literal"><span class="pre">tl_2018_06_tract</span></code> as <span class="guilabel">Input layer</span> and <code class="docutils literal"><span class="pre">GEOID</span></code> as the <span class="guilabel">Table field</span>. Select <code class="docutils literal"><span class="pre">ACS_17_5YR_B01003_with_ann</span></code> as the <span class="guilabel">Input layer 2</span> and <code class="docutils literal"><span class="pre">GEO.id2</span></code> as the <span class="guilabel">Table field 2</span>. Leave other options to their default values and click the <span class="guilabel">...</span> button to select the output file location and select <code class="docutils literal"><span class="pre">Save</span> <span class="pre">to</span> <span class="pre">GeoPackage...</span></code>.</li>
</ol>
<blockquote>
<div><img alt="../../_images/1220.png" class="align-center" src="../../_images/1220.png" />
</div></blockquote>
<ol class="arabic simple" start="13">
<li>Name the output geopackage as <code class="docutils literal"><span class="pre">joined.gpkg</span></code> and the output layer as <code class="docutils literal"><span class="pre">joined</span></code>. Click <span class="guilabel">Run</span>.</li>
</ol>
<blockquote>
<div><img alt="../../_images/1319.png" class="align-center" src="../../_images/1319.png" />
</div></blockquote>
<ol class="arabic simple" start="14">
<li>Once the processing finishes, verify that the algorithm was successful and click <span class="guilabel">Close</span>.</li>
</ol>
<blockquote>
<div><img alt="../../_images/1418.png" class="align-center" src="../../_images/1418.png" />
</div></blockquote>
<ol class="arabic simple" start="15">
<li>You will see a new layer <code class="docutils literal"><span class="pre">joined</span></code> loaded in the <span class="guilabel">Layers</span> panel. At this point, the fields from the CSV file are joined with the census tracts layer. You can close the <span class="guilabel">Processing Toolbox</span> for now. Right-click on the <code class="docutils literal"><span class="pre">joined</span></code> layer and select <span class="guilabel">Open Attribute Table</span>.</li>
</ol>
<blockquote>
<div><img alt="../../_images/1517.png" class="align-center" src="../../_images/1517.png" />
</div></blockquote>
<ol class="arabic simple" start="16">
<li>You will see a new set of fields, including the <code class="docutils literal"><span class="pre">HD01_VD01</span></code> field containing population estimates.</li>
</ol>
<blockquote>
<div><img alt="../../_images/1616.png" class="align-center" src="../../_images/1616.png" />
</div></blockquote>
<ol class="arabic simple" start="17">
<li>Now that we have the population data in the census tracts layer, we can style it to create a visualization of population distribution. Select the <code class="docutils literal"><span class="pre">joined</span></code> layer and click the <span class="guilabel">Open the Layer Styling Panel</span> button.</li>
</ol>
<blockquote>
<div><img alt="../../_images/1717.png" class="align-center" src="../../_images/1717.png" />
</div></blockquote>
<ol class="arabic simple" start="18">
<li>In the <span class="guilabel">Layer Styling</span> panel, select <code class="docutils literal"><span class="pre">Graduated</span></code> from the drop-down menu. As we are looking to create a population map, we want to assign different color to each census tract feature based on the population estimate. Select  <code class="docutils literal"><span class="pre">HD01_VD01</span></code> as the <span class="guilabel">Column</span>. Select a color ramp of your liking from the <span class="guilabel">Color ramp</span> drop-down. In the <span class="guilabel">Mode</span>, select <span class="guilabel">Quantile (Equal Count)</span> with <code class="docutils literal"><span class="pre">5</span></code> <span class="guilabel">Classes</span>. Click the <span class="guilabel">Classify</span> button and see the map layer update with a color assigned to a population range. You can close the <span class="guilabel">Layer Styling</span> panel once you are satisfied with the map.</li>
</ol>
<blockquote>
<div><img alt="../../_images/1816.png" class="align-center" src="../../_images/1816.png" />
</div></blockquote>
<ol class="arabic simple" start="19">
<li>A good practice in any GIS analysis is to validate your results. To check our work, we can run some simple queries on the output layer to make sure the results are correct. Go to <span class="menuselection">Database ‣ DB Manager...</span>.</li>
</ol>
<blockquote>
<div><img alt="../../_images/1913.png" class="align-center" src="../../_images/1913.png" />
</div></blockquote>
<ol class="arabic simple" start="20">
<li>All layers loaded in QGIS are available as <em>Virtual Layers</em> that can be queried using SQL without loading them into a separate database. This add a lot of useful functionality by enabling spatial and non-spatial SQL queries via SQLite engine and the <a class="reference external" href="https://www.gaia-gis.it/fossil/libspatialite/index">Spatialite library</a>. Locate the output layer from <span class="menuselection">Virtual Layers ‣ Project layers ‣ joined`</span> and select it. Click the <span class="guilabel">SQL Window</span> button.</li>
</ol>
<blockquote>
<div><img alt="../../_images/2010.png" class="align-center" src="../../_images/2010.png" />
</div></blockquote>
<ol class="arabic simple" start="21">
<li>Type the following query that sums the <code class="docutils literal"><span class="pre">HD01_VD01</span></code> field to count the total population of the state. Enter the query in the <span class="guilabel">Query</span> tab and click <span class="guilabel">Execute</span>. The result will appear in the bottom panel. You can verify that the result matches the <a class="reference external" href="https://en.wikipedia.org/wiki/California">population of California</a>.</li>
</ol>
<blockquote>
<div><div class="highlight-sql"><div class="highlight"><pre><span></span><span class="k">select</span> <span class="k">sum</span><span class="p">(</span><span class="n">HD01_VD01</span><span class="p">)</span> <span class="k">as</span> <span class="n">population</span> <span class="k">from</span> <span class="n">joined</span>
</pre></div>
</div>
<img alt="../../_images/2115.png" class="align-center" src="../../_images/2115.png" />
</div></blockquote>
<ol class="arabic simple" start="22">
<li>SQL queries are also well-suited to perform group statistics. Here&#8217;s a query that sums the population field but adds a <code class="docutils literal"><span class="pre">group</span> <span class="pre">by</span></code> clause to group all census tracts by county and create a table of total population by county. The query also sorts the result by population. We can also cross-verify that the county with FIPS id <code class="docutils literal"><span class="pre">037</span></code> (Los Angeles County) is the <a class="reference external" href="https://en.wikipedia.org/wiki/List_of_counties_in_California">most populated county in california</a> .</li>
</ol>
<blockquote>
<div><div class="highlight-sql"><div class="highlight"><pre><span></span><span class="k">select</span> <span class="n">COUNTYFP</span> <span class="k">as</span> <span class="n">county</span><span class="p">,</span> <span class="k">sum</span><span class="p">(</span><span class="n">HD01_VD01</span><span class="p">)</span> <span class="k">as</span> <span class="n">population</span>
<span class="k">from</span> <span class="n">joined</span> <span class="k">group</span> <span class="k">by</span> <span class="n">COUNTYFP</span> <span class="k">order</span> <span class="k">by</span> <span class="n">population</span> <span class="k">desc</span>
</pre></div>
</div>
<img alt="../../_images/2213.png" class="align-center" src="../../_images/2213.png" />
</div></blockquote>
</div>
</div>





  <div>If you liked tutorials on this site and do check out 
  <a href="http://spatialthoughts.com" target="_blank">spatialthoughts.com</a> for more free resources.
  </div>
  
  <div id="disqus_thread"></div>
  <noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
  <a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>


    </div>
      
  </div>
</div>

<footer class="footer">
  <div class="container">
    <p class="pull-right">
      <a href="#">Back to top</a>
      
    </p>
    <p>
        &copy; Copyright 2019, Ujaval Gandhi.<br/>
      最後更新日期是 Feb 24, 2020.<br/>
      Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 1.3.6.<br/>
    </p>
  </div>
</footer>
<div class="container">
  <p>This work is licensed under a <a href="http://creativecommons.org/licenses/by/4.0/deed.en_US">Creative Commons Attribution 4.0 International License</a></p>
</div>
<!-- Twitter Button -->
<script>!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0],p=/^http:/.test(d.location)?'http':'https';if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src=p+'://platform.twitter.com/widgets.js';fjs.parentNode.insertBefore(js,fjs);}}(document, 'script', 'twitter-wjs');</script>

<!-- Disqus comments widget -->
<script type="text/javascript">
  /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
  var disqus_shortname = 'qgistutorials'; // required: replace example with your forum shortname
  /* * * DON'T EDIT BELOW THIS LINE * * */
  (function () {
    var s = document.createElement('script'); s.async = true;
    s.type = 'text/javascript';
    s.src = '//' + disqus_shortname + '.disqus.com/count.js';
    (document.getElementsByTagName('HEAD')[0] || document.getElementsByTagName('BODY')[0]).appendChild(s);
  }());
</script>

<script type="text/javascript">
  /* * * DON'T EDIT BELOW THIS LINE * * */
  (function() {
    var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
    dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
    (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
  })();
</script>

<!-- Script fpr language switching. Largely adapted from https://github.com/pcav/faunalia-website -->
<script>
    var currentPage = 'docs/3/performing_table_joins.html'; // coming from sphinx, always without starting '/'
    var currentLang = 'en';
    $(document).ready(function(){

        var search = new RegExp('\/[a-zA-Z_]{2,8}\/'+ currentPage, 'gi');
        var langPlusPage = window.location.href.match(search);
        // it's possible this is a index.html page called without 'index.html', try without the currentPage
        if (langPlusPage==undefined){
            search = new RegExp('\/[a-zA-Z_]{2,8}\/$', 'gi');
            langPlusPage = window.location.href.match(search);
        }

        // it's possible this is an index.html page called without 'index.html', try removing index.html
        if (langPlusPage==undefined){
            currentPage = currentPage.replace('index.html','')
            search = new RegExp('\/[a-zA-Z_]{2,8}\/'+ currentPage, 'gi');
            langPlusPage = window.location.href.match(search);
        }
        // still no langPlugPage: stop, because the language swicher will misbehave 

        if (langPlusPage == undefined || langPlusPage.length != 1){
            alert('You hit an error, please report back to us.');
            return;
        }
        langPlusPage = langPlusPage[0];
        currentLang = langPlusPage.replace(currentPage, '');

        $("#languages").val(currentLang.replace(/\//g,'')); // currentLang is something like '/nl/'

        $("#languages").change(function() {
            gotoLang($(this).val());
        });

    });

    // load current page in a different language
    function gotoLang(lang){
        var currentUrl = window.location.href;
        var newUrl = currentUrl.replace(currentLang, '/'+lang+'/');
        window.location.href = newUrl;
    }
</script>

  </body>
</html>