<!DOCTYPE html>


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Writing Python Scripts for Processing Framework &mdash; QGIS Tutorials and Tips</title>
    
    <link rel="stylesheet" href="../_static/basic.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../_static/bootswatch-3.2.0/united/bootstrap.min.css" type="text/css" />
    <link rel="stylesheet" href="../_static/bootstrap-sphinx.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '1',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <script type="text/javascript" src="../_static/translations.js"></script>
    <script type="text/javascript" src="../_static/js/jquery-1.11.0.min.js"></script>
    <script type="text/javascript" src="../_static/js/jquery-fix.js"></script>
    <script type="text/javascript" src="../_static/bootstrap-3.2.0/js/bootstrap.min.js"></script>
    <script type="text/javascript" src="../_static/bootstrap-sphinx.js"></script>
    <link rel="top" title="QGIS Tutorials and Tips" href="../index.html" />

<meta charset='utf-8'>
<meta http-equiv='X-UA-Compatible' content='IE=edge,chrome=1'>
<meta name='viewport' content='width=device-width, initial-scale=1.0, maximum-scale=1'>
<meta name="apple-mobile-web-app-capable" content="yes">

<!-- Google Analytics -->
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-690672-13', 'qgistutorials.com');
  ga('require', 'displayfeatures');
  ga('send', 'pageview');
</script>


  </head>
  <body role="document">

  <div id="navbar" class="navbar navbar-default navbar-fixed-top">
    <div class="container">
      <div class="navbar-header">
        <!-- .btn-navbar is used as the toggle for collapsed navbar content -->
        <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".nav-collapse">
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>
        <a class="navbar-brand" href="../index.html"><img src="../_static/logo.png">
          QGIS Tutorials and Tips</a>
        <span class="navbar-text navbar-version pull-left"><b>v1.0</b></span>
      </div>

        <div class="collapse navbar-collapse nav-collapse">
          <ul class="nav navbar-nav">
            
            
              <li class="dropdown globaltoc-container">
  <a role="button"
     id="dLabelGlobalToc"
     data-toggle="dropdown"
     data-target="#"
     href="../index.html">Tutorials List <b class="caret"></b></a>
  <ul class="dropdown-menu globaltoc"
      role="menu"
      aria-labelledby="dLabelGlobalToc"><ul>
<li class="toctree-l1"><a class="reference internal" href="introduction.html">Introdução</a></li>
<li class="toctree-l1"><a class="reference internal" href="3/making_a_map.html">Elaborando um Mapa (QGIS3)</a></li>
<li class="toctree-l1"><a class="reference internal" href="3/working_with_attributes.html">Working with Attributes (QGIS3)</a></li>
<li class="toctree-l1"><a class="reference internal" href="3/importing_spreadsheets_csv.html">Importando planilhas ou arquivos .CSV (QGIS 3)</a></li>
<li class="toctree-l1"><a class="reference internal" href="3/basic_vector_styling.html">Basic Vector Styling (QGIS3)</a></li>
<li class="toctree-l1"><a class="reference internal" href="3/calculating_line_lengths.html">Calculating Line Lengths and Statistics (QGIS3)</a></li>
<li class="toctree-l1"><a class="reference internal" href="3/raster_styling_and_analysis.html">Basic Raster Styling and Analysis (QGIS3)</a></li>
<li class="toctree-l1"><a class="reference internal" href="3/raster_mosaicing_and_clipping.html">Raster Mosaicing and Clipping (QGIS3)</a></li>
<li class="toctree-l1"><a class="reference internal" href="working_with_terrain.html">Trabalhando com Dados de Terreno</a></li>
<li class="toctree-l1"><a class="reference internal" href="working_with_wms.html">Working with WMS Data</a></li>
<li class="toctree-l1"><a class="reference internal" href="working_with_projections.html">Trabalhando com Projeções</a></li>
<li class="toctree-l1"><a class="reference internal" href="3/georeferencing_basics.html">Georeferencing Topo Sheets and Scanned Maps (QGIS3)</a></li>
<li class="toctree-l1"><a class="reference internal" href="3/advanced_georeferencing.html">Georreferenciamento de imagens aéreas (QGIS3)</a></li>
<li class="toctree-l1"><a class="reference internal" href="digitizing_basics.html">Digitizing Map Data</a></li>
<li class="toctree-l1"><a class="reference internal" href="3/downloading_osm_data.html">Searching and Downloading OpenStreetMap Data (QGIS3)</a></li>
<li class="toctree-l1"><a class="reference internal" href="3/performing_table_joins.html">Performing Table Joins (QGIS3)</a></li>
<li class="toctree-l1"><a class="reference internal" href="3/performing_spatial_joins.html">Performing Spatial Joins (QGIS3)</a></li>
<li class="toctree-l1"><a class="reference internal" href="3/creating_heatmaps.html">Creating Heatmaps (QGIS3)</a></li>
<li class="toctree-l1"><a class="reference internal" href="3/performing_spatial_queries.html">Performing Spatial Queries (QGIS3)</a></li>
<li class="toctree-l1"><a class="reference internal" href="3/nearest_neighbor_analysis.html">Nearest Neighbor Analysis (QGIS3)</a></li>
<li class="toctree-l1"><a class="reference internal" href="3/sampling_raster_data.html">Sampling Raster Data using Points or Polygons (QGIS3)</a></li>
<li class="toctree-l1"><a class="reference internal" href="interpolating_point_data.html">Interpolating Point Data</a></li>
<li class="toctree-l1"><a class="reference internal" href="3/batch_processing.html">Batch Processing using Processing Framework (QGIS3)</a></li>
<li class="toctree-l1"><a class="reference internal" href="3/processing_graphical_modeler.html">Automating Complex Workflows using Processing Modeler (QGIS3)</a></li>
<li class="toctree-l1"><a class="reference internal" href="3/automating_map_creation.html">Automating Map Creation with Print Layout Atlas (QGIS3)</a></li>
<li class="toctree-l1"><a class="reference internal" href="using_qgis_browser.html">Usando o Navegador QGIS</a></li>
<li class="toctree-l1"><a class="reference internal" href="open_bil_bip_bsq_files.html">Open BIL, BIP or BSQ files in QGIS</a></li>
<li class="toctree-l1"><a class="reference internal" href="3/getting_started_with_pyqgis.html">Getting Started With Python Programming (QGIS3)</a></li>
<li class="toctree-l1"><a class="reference internal" href="3/processing_algorithms_pyqgis.html">Running Processing Algorithms via Python (QGIS3)</a></li>
<li class="toctree-l1"><a class="reference internal" href="3/building_a_python_plugin.html">Construindo um complemento com Python</a></li>
<li class="toctree-l1"><a class="reference internal" href="3/custom_python_functions.html">Using Custom Python Expression Functions (QGIS3)</a></li>
<li class="toctree-l1"><a class="reference internal" href="3/processing_python_scripts.html">Escrever Scripts de Python para o Framework do Processing (QGIS3)</a></li>
<li class="toctree-l1"><a class="reference internal" href="running_qgis_jobs.html">Running and Scheduling QGIS Processing Jobs</a></li>
<li class="toctree-l1"><a class="reference internal" href="performing_table_joins_pyqgis.html">Performing Table Joins (PyQGIS)</a></li>
<li class="toctree-l1"><a class="reference internal" href="web_mapping_with_qgis2web.html">Web Mapping with QGIS2Web</a></li>
<li class="toctree-l1"><a class="reference internal" href="creating_basemaps_with_qtiles.html">Criando Mapas Base utilizando QTiles</a></li>
<li class="toctree-l1"><a class="reference internal" href="using_plugins.html">Using Plugins</a></li>
<li class="toctree-l1"><a class="reference internal" href="learning_resources.html">QGIS Learning Resources</a></li>
<li class="toctree-l1"><a class="reference internal" href="credits.html">Créditos</a></li>
<li class="toctree-l1"><a class="reference internal" href="batch_processing.html">Batch Processing using Processing Framework (QGIS2)</a></li>
</ul>
</ul>
</li>
              
            
            
              
                
              
            
            

            

            
              <li class="hidden-sm"></li>
            
          </ul>

          
            
<form class="navbar-form navbar-right" action="../search.html" method="get">
 <div class="form-group">
  <input type="text" name="q" class="form-control" placeholder="Search" />
 </div>
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
          
        </div>
    </div>
  </div>

<div class="container">
  <div class="row">
      <div class="col-md-3">
        <div id="sidebar" class="bs-sidenav" role="complementary"><h4>Author</h4>
<p>Ujaval Gandhi</p>
<a href="https://twitter.com/intent/follow?screen_name=spatialthoughts" class="twitter-follow-button" data-show-count="false">Follow @spatialthoughts</a>

<!-- Begin Mailchimp Signup Form -->
<link href="//cdn-images.mailchimp.com/embedcode/slim-10_7.css" rel="stylesheet" type="text/css">
<style type="text/css">
	#mc_embed_signup{background:#fff; clear:left; font:14px Helvetica,Arial,sans-serif; }
	/* Add your own Mailchimp form style overrides in your site stylesheet or in this style block.
	   We recommend moving this block and the preceding CSS link to the HEAD of your HTML file. */
</style>
<div id="mc_embed_signup">
<h4>Subscribe to my mailing list</h4>
<p>Get occasional emails when I post new material or announce training events.</p>
<form action="https://spatialthoughts.us20.list-manage.com/subscribe/post?u=59d493847a7c7c2dbf12b21e6&amp;id=8fb09ab55c" method="post" id="mc-embedded-subscribe-form" name="mc-embedded-subscribe-form" class="validate" target="_blank" novalidate>
    <div id="mc_embed_signup_scroll">
	<input type="email" value="" name="EMAIL" class="email" id="mce-EMAIL" placeholder="email address" required>
    <!-- real people should not fill this in and expect good things - do not remove this or risk form bot signups-->
    <div style="position: absolute; left: -5000px;" aria-hidden="true"><input type="text" name="b_59d493847a7c7c2dbf12b21e6_8fb09ab55c" tabindex="-1" value=""></div>
    <div class="clear"><input type="submit" value="Subscribe" name="subscribe" id="mc-embedded-subscribe" class="button"></div>
    </div>
</form>
</div>

<!--End mc_embed_signup-->

<h4>Change Language</h4>
<form role="form" class="sidebar-form sidebar-left">
<select id="languages" class="form-control select-mini">
  <option value="en">English</option>
  <option value="zh_TW">Chinese (Taiwan)</option>
  <option value="nl">Dutch</option>
  <option value="fi_FI">Finnish</option>
  <option value="fr">French</option>
  <option value="de">German</option>
  <option value="el">Greek</option>
  <option value="id">Indonesian</option>
  <option value="it">Italian</option>
  <option value="ko">Korean</option>
  <option value="pt_BR">Portuguese</option>
  <option value="ro">Romanian</option>
  <option value="ru">Russian</option>
  <option value="sl">Slovenian</option>
  <option value="es">Spanish</option>
  <option value="th">Thai</option>
  <option value="tr">Turkish</option>
  <option value="uk">Ukrainian</option>
  <option value="vi">Vietnamese</option>
</select>
</form>
        </div>
      </div>
    <div class="col-md-9">
      

  <div class="section" id="writing-python-scripts-for-processing-framework">
<h1>Writing Python Scripts for Processing Framework<a class="headerlink" href="#writing-python-scripts-for-processing-framework" title="Link permanente para este título">¶</a></h1>
<div class="admonition warning">
<p class="first admonition-title">Aviso</p>
<p class="last">A new version of this tutorial is available at <a class="reference internal" href="3/processing_python_scripts.html"><em>Escrever Scripts de Python para o Framework do Processing (QGIS3)</em></a></p>
</div>
<p>One can write standalone pyqgis scripts that can be run via the Python Console
in QGIS. With a few tweaks, you can make your standalone scripts run via the
Processing Framework. This has several advantages. First, taking user input and
writing output files is far easier because Processing Framework offers standardized
user interface for these. Second, having your script in the Processing Toolbox also
allows it to be part of any Processing Model or be run as a Batch job with
multiple inputs. This tutorial will show how to write a custom python script
that can be part of the Processing Framework in QGIS.</p>
<div class="section" id="overview-of-the-task">
<h2>Visão geral da tarefa<a class="headerlink" href="#overview-of-the-task" title="Link permanente para este título">¶</a></h2>
<p>Our script will perform a dissolve operation based on a field chosen by the
user. It will also sum up values of another field for the dissolved features.
In the example, we will dissolve a world shapefile based on a <code class="docutils literal"><span class="pre">SUBREGION</span></code>
attribute and sum up <code class="docutils literal"><span class="pre">POP_EST</span></code> field to calculate total population in the
dissolved region.</p>
<div class="admonition note">
<p class="first admonition-title">Nota</p>
<p class="last">If you are looking to do a Dissolve operation along with Statistics, you can
use the excellent <code class="docutils literal"><span class="pre">DissolveWithStats</span></code> plugin. This script is a
demonstration how to implement similar functionality via a Processing
script.</p>
</div>
</div>
<div class="section" id="get-the-data">
<h2>Obter os dados<a class="headerlink" href="#get-the-data" title="Link permanente para este título">¶</a></h2>
<p>We will use the <a class="reference external" href="http://www.naturalearthdata.com/downloads/10m-cultural-vectors/10m-admin-0-countries/">Admin 0 - Countries</a>
dataset from Natural Earth.</p>
<p>Download the <a class="reference external" href="http://www.naturalearthdata.com/http//www.naturalearthdata.com/download/10m/cultural/ne_10m_admin_0_countries.zip">Admin 0 - countries shapefile.</a>.</p>
<p>Data Source <a class="reference internal" href="credits.html#naturalearth" id="id1">[NATURALEARTH]</a></p>
<p>Por conveniência, você pode baixar uma cópia dos dados diretamente do caminho abaixo:</p>
<p><a class="reference external" href="http://www.qgistutorials.com/downloads/ne_10m_admin_0_countries.zip">ne_10_admin_0_countries.zip</a></p>
</div>
<div class="section" id="procedure">
<h2>Procedimento<a class="headerlink" href="#procedure" title="Link permanente para este título">¶</a></h2>
<ol class="arabic simple">
<li>Open QGIS and go to <span class="menuselection">Layers ‣ Add Vector ‣ Add Vector
Layer</span>. Browse to the downloaded <code class="docutils literal"><span class="pre">ne_10_admin_0_countries.zip</span></code> file and
load the <code class="docutils literal"><span class="pre">ne_10_admin_0_countries</span></code> layer. Go to <span class="menuselection">Processing
‣ Toolbox</span>.</li>
</ol>
<img alt="../_images/1169.png" class="align-center" src="../_images/1169.png" />
<ol class="arabic simple" start="2">
<li>Expand the <span class="guilabel">Scripts</span> group in the <span class="guilabel">Processing Toolbox</span>
and select <span class="guilabel">Create a new script</span>.</li>
</ol>
<img alt="../_images/2124.png" class="align-center" src="../_images/2124.png" />
<ol class="arabic simple" start="3">
<li>For a python script to be recognized as a Processing script, the beginning
of the script must be the specifications of the input and outputs. This will
be used to construct the user interface to run the script. You can learn
more about the format of these lines from <a class="reference external" href="https://docs.qgis.org/2.8/en/docs/user_manual/processing/scripts.html">QGIS Processing Documentation</a>.
Enter the following lines in the <span class="guilabel">Script editor</span>. Here we are
specifying 3 user inputs: <code class="docutils literal"><span class="pre">dissolve_layer</span></code>, <code class="docutils literal"><span class="pre">dissolve_field</span></code> and
<code class="docutils literal"><span class="pre">sum_field</span></code>. Note that we are adding <code class="docutils literal"><span class="pre">dissolve_layer</span></code> after both the
field input definitions. This means that input will be pre-populated with
choice of fields from the <code class="docutils literal"><span class="pre">dissolve_layer</span></code>. We also specify the
<code class="docutils literal"><span class="pre">output_layer</span></code> as the output vector layer. Click <span class="guilabel">Save</span> button.</li>
</ol>
<div class="highlight-none"><div class="highlight"><pre><span></span>##dissolve_layer=vector
##dissolve_field=field dissolve_layer
##sum_field=field dissolve_layer
##output_layer=output vector
</pre></div>
</div>
<img alt="../_images/370.png" class="align-center" src="../_images/370.png" />
<ol class="arabic simple" start="4">
<li>Name the script <code class="docutils literal"><span class="pre">dissolve_with_sum</span></code> and save it at the default location
under <span class="menuselection">.qgis2 ‣ processing ‣ scripts</span> folder.</li>
</ol>
<img alt="../_images/449.png" class="align-center" src="../_images/449.png" />
<ol class="arabic simple" start="5">
<li>Back in the <span class="guilabel">Script editor</span>, click <span class="guilabel">Run algorithm</span>
button to preview the user interface.</li>
</ol>
<img alt="../_images/550.png" class="align-center" src="../_images/550.png" />
<ol class="arabic simple" start="6">
<li>You can see that just by adding a few lines, we have a nice user interface
for the user to specify the inputs. It is also consistent with all other
Processing algorithms, so there is no learning curve involved in using your
custom algorithm.</li>
</ol>
<img alt="../_images/647.png" class="align-center" src="../_images/647.png" />
<ol class="arabic simple" start="7">
<li>In the <span class="guilabel">Script editor</span>, enter the following code. You will notice
that we are using some special methods such as <code class="docutils literal"><span class="pre">processing.getObject()</span></code>
and <code class="docutils literal"><span class="pre">processing.features()</span></code>. These are convenience wrappers that make it
easy to work with data. You can learn more about these from <a class="reference external" href="https://docs.qgis.org/2.8/en/docs/user_manual/processing/console.html#additional-functions-for-handling-data">Additional
functions for handling data</a>
section of QGIS Processing Documentation. Click <span class="guilabel">Save</span> to save the
newly entered code and then the <span class="guilabel">X</span> button to close the editor.</li>
</ol>
<div class="admonition note">
<p class="first admonition-title">Nota</p>
<p class="last">This script uses python list comprehensions extensively. Take a look at this
<a class="reference external" href="https://docs.python.org/2/tutorial/datastructures.html#list-comprehensions">list comprehension tutorial</a>
to get familiar with the syntax.</p>
</div>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">qgis.core</span> <span class="kn">import</span> <span class="o">*</span>
<span class="kn">from</span> <span class="nn">PyQt4.QtCore</span> <span class="kn">import</span> <span class="o">*</span>

<span class="n">inlayer</span> <span class="o">=</span> <span class="n">processing</span><span class="o">.</span><span class="n">getObject</span><span class="p">(</span><span class="n">dissolve_layer</span><span class="p">)</span>
<span class="n">dissolve_field_index</span> <span class="o">=</span> <span class="n">inlayer</span><span class="o">.</span><span class="n">fieldNameIndex</span><span class="p">(</span><span class="n">dissolve_field</span><span class="p">)</span>
<span class="n">sum_field_index</span> <span class="o">=</span> <span class="n">inlayer</span><span class="o">.</span><span class="n">fieldNameIndex</span><span class="p">(</span><span class="n">sum_field</span><span class="p">)</span>

<span class="c1"># Find unique values present in the dissolve field</span>
<span class="n">unique_values</span> <span class="o">=</span> <span class="nb">set</span><span class="p">([</span><span class="n">f</span><span class="p">[</span><span class="n">dissolve_field</span><span class="p">]</span> <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span>
<span class="n">processing</span><span class="o">.</span><span class="n">features</span><span class="p">(</span><span class="n">inlayer</span><span class="p">)])</span>

<span class="k">print</span> <span class="n">unique_values</span>
</pre></div>
</div>
<img alt="../_images/746.png" class="align-center" src="../_images/746.png" />
<ol class="arabic simple" start="8">
<li>While writing code, it is important to be able to see errors and debug your
code. Your processing scripts can be debugged easily via the built-in Python
Console. In the main QGIS window, go to <span class="menuselection">Plugins ‣ Python
Console</span>. Once the console is open, find your script in the
<span class="guilabel">Processing Toolbox</span> and double-click it to launch it.</li>
</ol>
<img alt="../_images/844.png" class="align-center" src="../_images/844.png" />
<ol class="arabic simple" start="9">
<li>Select <code class="docutils literal"><span class="pre">SUBREGION</span></code> as the <span class="guilabel">dissolve field</span>. You may choose any
field as the <span class="guilabel">sum field</span> as the script doesn&#8217;t have any code yet
to deal with it. Click <span class="guilabel">Run</span>.</li>
</ol>
<img alt="../_images/943.png" class="align-center" src="../_images/943.png" />
<ol class="arabic simple" start="10">
<li>You will see an error dialog. This is expected since the script is
incomplete and doesn&#8217;t generate any output yet.</li>
</ol>
<img alt="../_images/1042.png" class="align-center" src="../_images/1042.png" />
<ol class="arabic simple" start="11">
<li>In the main QGIS windows, you will see the debug output from the script
printed in the console. This is useful way to add print statements and see
intermediate variable values.</li>
</ol>
<img alt="../_images/1170.png" class="align-center" src="../_images/1170.png" />
<ol class="arabic simple" start="12">
<li>Let&#8217;s go back to editing the script by right-clicking the script and select
<span class="guilabel">Edit script</span>.</li>
</ol>
<img alt="../_images/1242.png" class="align-center" src="../_images/1242.png" />
<ol class="arabic simple" start="13">
<li>Enter the following code to complete the script. Note that we are using the
existing dissolve algorithm in QGIS via processing using
<code class="docutils literal"><span class="pre">processing.runalg()</span></code> method.</li>
</ol>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="c1"># Create a dictionary to hold values from the sum field</span>
<span class="n">sum_unique_values</span> <span class="o">=</span> <span class="p">{}</span>
<span class="n">attrs</span> <span class="o">=</span> <span class="p">[</span><span class="n">f</span><span class="o">.</span><span class="n">attributes</span><span class="p">()</span> <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="n">processing</span><span class="o">.</span><span class="n">features</span><span class="p">(</span><span class="n">inlayer</span><span class="p">)]</span>

<span class="k">for</span> <span class="n">unique_value</span> <span class="ow">in</span> <span class="n">unique_values</span><span class="p">:</span>
    <span class="n">val_list</span> <span class="o">=</span> <span class="p">[</span> <span class="n">f_attr</span><span class="p">[</span><span class="n">sum_field_index</span><span class="p">]</span> <span class="k">for</span> <span class="n">f_attr</span> <span class="ow">in</span> <span class="n">attrs</span> <span class="k">if</span> <span class="n">f_attr</span><span class="p">[</span><span class="n">dissolve_field_index</span><span class="p">]</span> <span class="o">==</span> <span class="n">unique_value</span><span class="p">]</span>
    <span class="n">sum_unique_values</span><span class="p">[</span><span class="n">unique_value</span><span class="p">]</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="n">val_list</span><span class="p">)</span>

<span class="c1"># Run the regular Dissolve algorithm</span>
<span class="n">processing</span><span class="o">.</span><span class="n">runalg</span><span class="p">(</span><span class="s2">&quot;qgis:dissolve&quot;</span><span class="p">,</span> <span class="n">dissolve_layer</span><span class="p">,</span> <span class="s2">&quot;false&quot;</span><span class="p">,</span>
    <span class="n">dissolve_field</span><span class="p">,</span> <span class="n">output_layer</span><span class="p">)</span>

<span class="c1"># Add a new attribute called &#39;SUM&#39; in the output layer</span>
<span class="n">outlayer</span> <span class="o">=</span> <span class="n">processing</span><span class="o">.</span><span class="n">getObject</span><span class="p">(</span><span class="n">output_layer</span><span class="p">)</span>
<span class="n">provider</span> <span class="o">=</span> <span class="n">outlayer</span><span class="o">.</span><span class="n">dataProvider</span><span class="p">()</span>
<span class="n">provider</span><span class="o">.</span><span class="n">addAttributes</span><span class="p">([</span><span class="n">QgsField</span><span class="p">(</span><span class="s1">&#39;SUM&#39;</span><span class="p">,</span> <span class="n">QVariant</span><span class="o">.</span><span class="n">Double</span><span class="p">)])</span>
<span class="n">outlayer</span><span class="o">.</span><span class="n">updateFields</span><span class="p">()</span>

<span class="c1"># Set the value of the &#39;SUM&#39; field for each feature</span>
<span class="n">outlayer</span><span class="o">.</span><span class="n">startEditing</span><span class="p">()</span>
<span class="n">new_field_index</span> <span class="o">=</span> <span class="n">outlayer</span><span class="o">.</span><span class="n">fieldNameIndex</span><span class="p">(</span><span class="s1">&#39;SUM&#39;</span><span class="p">)</span>
<span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="n">processing</span><span class="o">.</span><span class="n">features</span><span class="p">(</span><span class="n">outlayer</span><span class="p">):</span>
  <span class="n">outlayer</span><span class="o">.</span><span class="n">changeAttributeValue</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">id</span><span class="p">(),</span> <span class="n">new_field_index</span><span class="p">,</span> <span class="n">sum_unique_values</span><span class="p">[</span><span class="n">f</span><span class="p">[</span><span class="n">dissolve_field</span><span class="p">]])</span>
<span class="n">outlayer</span><span class="o">.</span><span class="n">commitChanges</span><span class="p">()</span>
</pre></div>
</div>
<img alt="../_images/1341.png" class="align-center" src="../_images/1341.png" />
<ol class="arabic simple" start="14">
<li>Run the algorithm by selecting <code class="docutils literal"><span class="pre">SUBREGION</span></code> as the <span class="guilabel">dissolve
field</span> and <code class="docutils literal"><span class="pre">POP_EST</span></code> as the <span class="guilabel">sum field</span>. Click <span class="guilabel">Run</span>.</li>
</ol>
<div class="admon