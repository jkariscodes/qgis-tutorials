Basic Network Visualization and Routing (QGIS3)
===============================================

Creating, visualizing, and managing networks is an important part of GIS. Many types of physical infrastructure such as roads, railways, utilities can be modeled as networks with lines and nodes - with properties attached to them. In this tutorial, we will learn how road networks are commonly modeled and apply some styling techniques to visualize the routing properties. We will also use QGIS3's built-in tools for network analysis that to find shortest path between 2 points along the network.

Overview of the task
--------------------

We will take a layer of road centerlines for Washington DC, visualize the connectivity and build a network to find shortest path between any 2 points in the city.

Other skills you will learn
^^^^^^^^^^^^^^^^^^^^^^^^^^^
- How to use data defined overrides to align an arrow symbol based on line direction.

Get the data
------------
District of Columbia government freely shares hundreds of datasets on the `Open Data Catalog <https://opendata.dc.gov/>`_. 

Download the `Street Centerlines <https://opendata.dc.gov/datasets/street-centerlines>`_ shared by DCGISopendata data as a shapefile.

.. image:: /static/3/basic_network_analysis/images/data1.png
  :align: center
    
For convenience, you may directly download a copy of the datasets from the
links below:

`Street_Centerlines.zip <http://www.qgistutorials.com/downloads/Street_Centerlines.zip>`_

Data Source: [DCOPENDATA]_


Procedure
---------

1. Locate the downloaded ``Street_Centerlines.zip`` file in the :guilabel:`Browser` panel. Expand it and drag the ``Street_Centerlines.shp`` file to the canvas.

  .. image:: /static/3/basic_network_analysis/images/1.png
    :align: center
  
2. You will see a new line layer called ``Street_Centerlines`` added to the :guilabel:`Layers` panel. This layer represents each road in Washington DC. Select the :guilabel:`Identify` tool in the :guilabel:`Attributes Toolbar`. Click on any road segment to see what attributes are attached to it. There are standard attributes like road name, type etc. there is an attribute called ``DIRECTIONA``. This is an import attribute for routing as it specifies whether the segment is two-way or one-way. It contains 4 different values. ``Two Way`` for two-way streets. ``One Way (Digitizing direction)`` for one-way streets where the traffic is allowed in the direction of the line (start-point to end-point) and ``One way (Against digitizing direction)`` for one-way streets where the traffic flows in the opposite direction of the line. There is also ``Unknown`` value where we will assume two-way traffic. We will now use the information in that attribute to display an arrow on streets that are one-way.

  .. image:: /static/3/basic_network_analysis/images/2.png
    :align: center
  
3. Click the :guilabel:`Open the layer Styling Panel` button in the :guilabel:`Layers` panel. Select the ``Rule-based`` renderer from the drop-down menu.

  .. image:: /static/3/basic_network_analysis/images/3.png
    :align: center
  
4. We will create a new style with a filter for only the one-way roads. Click the :guilabel:`Add rule +` button.

  .. image:: /static/3/basic_network_analysis/images/4.png
    :align: center
  
5. In the :guilabel:`Edit rule` dialog, click the :guilabel:`Expression` button.

  .. image:: /static/3/basic_network_analysis/images/5.png
    :align: center
  
6. In the :guilabel:`Expression string builder` dialog, expand the :guilabel:`Fields and Values` section in the middle-panel. Select ``DIRECTIONA`` attribute and click :guilabel:`All Unique` in the right-hand panel. The 4 values that we discussed earlier will appear. Having these values here as a reference helps when building the expression. Also, you can double-click on any value to add them to the expression.

  .. image:: /static/3/basic_network_analysis/images/6.png
    :align: center
  
7. The goal is to create an expression that selects all one-way streets. Enter the following expression and click :guilabel:`OK`.

  ..