<!DOCTYPE html>


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Δημιουργία ενός πρόσθετου στην Python. &mdash; QGIS Tutorials and Tips</title>
    
    <link rel="stylesheet" href="../_static/basic.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../_static/bootswatch-3.2.0/united/bootstrap.min.css" type="text/css" />
    <link rel="stylesheet" href="../_static/bootstrap-sphinx.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '1',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <script type="text/javascript" src="../_static/js/jquery-1.11.0.min.js"></script>
    <script type="text/javascript" src="../_static/js/jquery-fix.js"></script>
    <script type="text/javascript" src="../_static/bootstrap-3.2.0/js/bootstrap.min.js"></script>
    <script type="text/javascript" src="../_static/bootstrap-sphinx.js"></script>
    <link rel="top" title="QGIS Tutorials and Tips" href="../index.html" />
    <link rel="next" title="Χρήση προσαρμοσμένων εκφράσεων συναρτήσεων στην Python" href="custom_python_functions.html" />
    <link rel="prev" title="Ξεκινώντας προγραμματισμό με την Python" href="getting_started_with_pyqgis.html" />

<meta charset='utf-8'>
<meta http-equiv='X-UA-Compatible' content='IE=edge,chrome=1'>
<meta name='viewport' content='width=device-width, initial-scale=1.0, maximum-scale=1'>
<meta name="apple-mobile-web-app-capable" content="yes">

<!-- Google Analytics -->
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-690672-13', 'qgistutorials.com');
  ga('require', 'displayfeatures');
  ga('send', 'pageview');
</script>


  </head>
  <body role="document">

  <div id="navbar" class="navbar navbar-default navbar-fixed-top">
    <div class="container">
      <div class="navbar-header">
        <!-- .btn-navbar is used as the toggle for collapsed navbar content -->
        <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".nav-collapse">
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>
        <a class="navbar-brand" href="../index.html"><img src="../_static/logo.png">
          QGIS Tutorials and Tips</a>
        <span class="navbar-text navbar-version pull-left"><b>v1.0</b></span>
      </div>

        <div class="collapse navbar-collapse nav-collapse">
          <ul class="nav navbar-nav">
            
            
              <li class="dropdown globaltoc-container">
  <a role="button"
     id="dLabelGlobalToc"
     data-toggle="dropdown"
     data-target="#"
     href="../index.html">Tutorials List <b class="caret"></b></a>
  <ul class="dropdown-menu globaltoc"
      role="menu"
      aria-labelledby="dLabelGlobalToc"><ul class="current">
<li class="toctree-l1"><a class="reference internal" href="introduction.html">Εισαγωγή</a></li>
<li class="toctree-l1"><a class="reference internal" href="making_a_map.html">Δημιουργία ενός χάρτη</a></li>
<li class="toctree-l1"><a class="reference internal" href="working_with_attributes.html">Εργασία με Χαρακτηριστικά</a></li>
<li class="toctree-l1"><a class="reference internal" href="importing_spreadsheets_csv.html">Εισαγωγή Φύλλα ή αρχεία CSV</a></li>
<li class="toctree-l1"><a class="reference internal" href="using_plugins.html">Χρησιμοποιώντας Πρόσθετες Λειτουργίες</a></li>
<li class="toctree-l1"><a class="reference internal" href="downloading_osm_data.html">Αναζήτηση και Λήψη OpenStreetMap Δεδομένων</a></li>
<li class="toctree-l1"><a class="reference internal" href="basic_vector_styling.html">Βασική διανυσματική διαμόρφωση</a></li>
<li class="toctree-l1"><a class="reference internal" href="calculating_line_lengths.html">Υπολογισμός Mήκους Γραμμών και Στατιστικά</a></li>
<li class="toctree-l1"><a class="reference internal" href="raster_styling_and_analysis.html">Βασική Διαμόρφωση και Ανάλυση Πλέγματος</a></li>
<li class="toctree-l1"><a class="reference internal" href="raster_mosaicing_and_clipping.html">Δημιουργία Μωσαϊκού και Περικοπής σε Πλέγμα</a></li>
<li class="toctree-l1"><a class="reference internal" href="working_with_terrain.html">Δουλεύοντας με Δεδομένα Εδάφους</a></li>
<li class="toctree-l1"><a class="reference internal" href="working_with_wms.html">Χρήση WMS Δεδομένων</a></li>
<li class="toctree-l1"><a class="reference internal" href="working_with_projections.html">Working with Projections</a></li>
<li class="toctree-l1"><a class="reference internal" href="georeferencing_basics.html">Γεω-αναφορά Τοπογραφικών Φύλλων και Σαρωμένων Χαρτών</a></li>
<li class="toctree-l1"><a class="reference internal" href="advanced_georeferencing.html">Γεω-αναφορά Αεροφωτογραφιών</a></li>
<li class="toctree-l1"><a class="reference internal" href="digitizing_basics.html">Ψηφιοποίηση Δεδομένων Χάρτη</a></li>
<li class="toctree-l1"><a class="reference internal" href="performing_table_joins.html">Εκτελώντας συγχωνεύσεις πινάκων</a></li>
<li class="toctree-l1"><a class="reference internal" href="performing_spatial_joins.html">Εκτέλεση xωρικών ενώσεων</a></li>
<li class="toctree-l1"><a class="reference internal" href="points_in_polygon.html">Ανάλυση Σημείων σε Πολύγωνα</a></li>
<li class="toctree-l1"><a class="reference internal" href="creating_heatmaps.html">Δημιουργώντας Heatmaps</a></li>
<li class="toctree-l1"><a class="reference internal" href="performing_spatial_queries.html">Εκτελώντας Χωρικά Αιτήματα</a></li>
<li class="toctree-l1"><a class="reference internal" href="nearest_neighbor_analysis.html">Nearest Neighbor Analysis</a></li>
<li class="toctree-l1"><a class="reference internal" href="sampling_raster_data.html">Δειγματοληψία Raster Δεδομένων με χρήση Σημείων ή Πολυγώνων.</a></li>
<li class="toctree-l1"><a class="reference internal" href="interpolating_point_data.html">Παρεμβάλλοντας τα σημεία δεδομένων</a></li>
<li class="toctree-l1"><a class="reference internal" href="batch_processing.html">Μαζική επεξεργασία χρησιμοποιώντας το πλαίσιο επεξεργασίας</a></li>
<li class="toctree-l1"><a class="reference internal" href="processing_graphical_modeler.html">Αυτοματοποίηση Σύνθετων Ροών με την χρήση επεξεργασίας προσπέλασης.</a></li>
<li class="toctree-l1"><a class="reference internal" href="automating_map_creation.html">Αυτόματη δημιουργία χάρτη χρησιμοποιώντας την Σύνθεση Εκτύπωσης Ατλαντα</a></li>
<li class="toctree-l1"><a class="reference internal" href="using_qgis_browser.html">Χρησιμοποιώντας το QGIS Browser</a></li>
<li class="toctree-l1"><a class="reference internal" href="counting_vertices.html">Μέτρηση του Aριθμού των Kορυφών σε ένα Επίπεδο</a></li>
<li class="toctree-l1"><a class="reference internal" href="open_bil_bip_bsq_files.html">Ανοίγοντας BIL,BIP ή BSQ αρχεία στο QGIS</a></li>
<li class="toctree-l1"><a class="reference internal" href="getting_started_with_pyqgis.html">Ξεκινώντας προγραμματισμό με την Python</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="">Δημιουργία ενός πρόσθετου στην Python.</a></li>
<li class="toctree-l1"><a class="reference internal" href="custom_python_functions.html">Χρήση προσαρμοσμένων εκφράσεων συναρτήσεων στην Python</a></li>
<li class="toctree-l1"><a class="reference internal" href="processing_python_scripts.html">Δημιουργία κώδικα στην Python για το πλαίσιο επεξεργασίας.</a></li>
<li class="toctree-l1"><a class="reference internal" href="running_qgis_jobs.html">Running and Scheduling QGIS Processing Jobs</a></li>
<li class="toctree-l1"><a class="reference internal" href="find_neighbor_polygons.html">Βρείτε Γειτονικά Πολύγωνα σε ένα Επίπεδο</a></li>
<li class="toctree-l1"><a class="reference internal" href="performing_table_joins_pyqgis.html">Performing Table Joins (PyQGIS)</a></li>
<li class="toctree-l1"><a class="reference internal" href="web_mapping_with_qgis2web.html">Web Mapping with QGIS2Web</a></li>
<li class="toctree-l1"><a class="reference internal" href="creating_basemaps_with_qtiles.html">Creating Basemaps with QTiles</a></li>
<li class="toctree-l1"><a class="reference internal" href="learning_resources.html">QGIS Μαθησιακοί πόροι</a></li>
<li class="toctree-l1"><a class="reference internal" href="credits.html">Συντελεστές δεδομένων</a></li>
</ul>
</ul>
</li>
              
            
            
              
                
  <li>
    <a href="getting_started_with_pyqgis.html" title="Previous Chapter: Ξεκινώντας προγραμματισμό με την Python"><span class="glyphicon glyphicon-chevron-left visible-sm"></span><span class="hidden-sm hidden-tablet">&laquo; Ξεκινώντας προγρ...</span>
    </a>
  </li>
  <li>
    <a href="custom_python_functions.html" title="Next Chapter: Χρήση προσαρμοσμένων εκφράσεων συναρτήσεων στην Python"><span class="glyphicon glyphicon-chevron-right visible-sm"></span><span class="hidden-sm hidden-tablet">Χρήση προσαρμοσμ... &raquo;</span>
    </a>
  </li>
              
            
            

            

            
              <li class="hidden-sm"></li>
            
          </ul>

          
            
<form class="navbar-form navbar-right" action="../search.html" method="get">
 <div class="form-group">
  <input type="text" name="q" class="form-control" placeholder="Search" />
 </div>
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
          
        </div>
    </div>
  </div>

<div class="container">
  <div class="row">
      <div class="col-md-3">
        <div id="sidebar" class="bs-sidenav" role="complementary"><h4>Author</h4>
<p>Ujaval Gandhi</p>
<a href="https://twitter.com/intent/follow?screen_name=spatialthoughts" class="twitter-follow-button" data-show-count="false">Follow @spatialthoughts</a>

<h4>Change Language</h4>
<form role="form" class="sidebar-form sidebar-left">
<select id="languages" class="form-control select-mini">
  <option value="en">English</option>
  <option value="zh_TW">Chinese (Taiwan)</option>
  <option value="nl">Dutch</option>
  <option value="fi_FI">Finnish</option>
  <option value="fr">French</option>
  <option value="de">German</option>
  <option value="el">Greek</option>
  <option value="id">Indonesian</option>
  <option value="it">Italian</option>
  <option value="ko">Korean</option>
  <option value="pt_BR">Portuguese</option>
  <option value="ro">Romanian</option>
  <option value="ru">Russian</option>
  <option value="sl">Slovenian</option>
  <option value="es">Spanish</option>
  <option value="th">Thai</option>
  <option value="tr">Turkish</option>
  <option value="uk">Ukrainian</option>
  <option value="vi">Vietnamese</option>
</select>
</form>



  


<h4>Share</h4>
<div class="addthis_sharing_toolbox"></div>
        </div>
      </div>
    <div class="col-md-9">
      

  <div class="section" id="building-a-python-plugin">
<h1>Δημιουργία ενός πρόσθετου στην Python.<a class="headerlink" href="#building-a-python-plugin" title="Permalink to this headline">¶</a></h1>
<p>Τα πρόσθτε είναι ένας υπέροχος τρόπος να επεκτίνουμε την λειτουργικότητα του QGIS. Μπορείτε να γράψετε πρόσθετα χρησιμοποιώντας Python τα οποία μπορούν να είναι από την εισαγωγή ενός απλού κουμπιού μέχρι την δημιουργία μιας εκλεπτισμένης εργαλειοθήκης. Αυτή η εργασία θα παραθέσει την διαδικασία η οποία απαιτείται στην ρύθμιση του περιβάλλοντος ανάπτυξης σας, σχεδιάζοντας την διεπαφή με χρήστη για ένα πρόσθετο και γράφοντας κώδικα με σκοπό να αλληλεπιδράσετε με το QGIS. Παρακαλώ διαβάστε την άσκηση  <a class="reference internal" href="getting_started_with_pyqgis.html"><em>Ξεκινώντας προγραμματισμό με την Python</em></a> για να εξοικειωθείτε με τα βασικα βήματα.</p>
<div class="section" id="overview-of-the-task">
<h2>Περίληψη του αντικειμένου.<a class="headerlink" href="#overview-of-the-task" title="Permalink to this headline">¶</a></h2>
<p>Θα δημιουργήσουμε ένα απλό πρόσθετο που λέγεται &#8220;Αποθήκευση χαρακτηριστικών&#8221; το οποίο θα επιτρέπει στους χρήστες να πάρουν ένα διανυσματικό στρώμα και να γράψουν τα χαρακτηριστικά του σε ένα αρχείο CSV.</p>
</div>
<div class="section" id="get-the-tools">
<h2>Πάρτε τα εργαλεία<a class="headerlink" href="#get-the-tools" title="Permalink to this headline">¶</a></h2>
<div class="section" id="qt-creator">
<h3>Δημιουργός Qt<a class="headerlink" href="#qt-creator" title="Permalink to this headline">¶</a></h3>
<p>To <a class="reference external" href="http://doc.qt.io/qtcreator/index.html">Qt &lt;http://www.qt.io/&gt;`_είναι μια πλατφόρμα ανάπτυξης λογισμικού η οποία χρησιμοποιείται για να δημιουργεί εφαρμογέ για Windows, Mac, Linux καθώς και για διάφορα λειτουργικά συστήματα για κινητά. Το ίδιο το QGIS είναι γραμμένο χρησιμοποιώντας την πλατφόρμα Qt. Για την ανάπτυξη πρόσθετων, θα χρησιμοποιήσουμε μια εφαρμογή που λέγεται  `Qt Creator</a>  για να σχεδιάσουμε την διεπαφή για το πρόσθετό μας.</p>
<p>Μεταφορτώστε και εγκαταστείστε το λογισμικό Qt Creator από το <a class="reference external" href="http://sourceforge.net/projects/qtcreator.mirror/files/latest/download">SourgeForge</a></p>
</div>
<div class="section" id="python-bindings-for-qt">
<h3>Δεσμοι Python για το Qt<a class="headerlink" href="#python-bindings-for-qt" title="Permalink to this headline">¶</a></h3>
<p>Δεδομένου οτι αναπτύσουμε ένα πρόσθετο στην Python, χρειάζεται να εγκαταστήσουμε τους δεσμού python για το Qt. Η μέθοδος για την εγκατάσταση αυτή θα εξαρτηθεί από την πλατφόρμα που χρησιμοποιείτε. Για την δημιουργία των πρόσθετων θα χρειαστούμε το εργαλείο γραμμής εντολών <code class="docutils literal"><span class="pre">pyrcc4</span></code>.</p>
<p><strong>Windows</strong></p>
<p>Κατεβάστε το <a class="reference external" href="http://trac.osgeo.org/osgeo4w/">OSGeo4W network installer</a> και επιλέξτε το <span class="guilabel">Express Desktop Install</span>. Εγκαταστείστε το πακέτο <code class="docutils literal"><span class="pre">QGIS</span></code>. Μετά την εγκατάσταση, θα έχετε πρόσβαση στο εργαλείο <code class="docutils literal"><span class="pre">pyrcc4</span></code> μέσω του <span class="guilabel">OSGeo4W Shell</span>.</p>
<p><strong>Mac</strong></p>
<p>Εγκαταστείστε τον διαχειριστή πακέτων <cite>Homebrew &lt;http://brew.sh&gt;&#8221;. Εγκαταστείστε το πακέτο ``PyQt`</cite> τρέχοντας την παρακάτω εντολή.</p>
<div class="highlight-none"><div class="highlight"><pre>brew install pyqt
</pre></div>
</div>
<p><strong>Linux</strong></p>
<p>Λαμβάνοντας υπόψην την διανομή σας, βρείτε και εγκαταστείστε το πακέτο <code class="docutils literal"><span class="pre">python-qt4</span></code>. Στα Ubuntu και τις διανομές Debian, μπορείτε να χρησιμοποιείσετε την παρακάτω εντολή.</p>
<div class="highlight-none"><div class="highlight"><pre>sudo apt-get install python-qt4
</pre></div>
</div>
</div>
<div class="section" id="a-text-editor-or-a-python-ide">
<h3>Ενας επεξεργαστής κειμένου ή ένα Python IDE<a class="headerlink" href="#a-text-editor-or-a-python-ide" title="Permalink to this headline">¶</a></h3>
<p>Κάθε είδους ανάπτυξη λογισμικού χρειάζεται έναν καλό επεξεργαστή κειμένου. Αν έχετε ήδη κάποιον επεξεργαστή κειμένου ή ένα IDE (Ενσωματωμένο περιβάλλον ανάπτυξης), μπορείτε να το χρησιμοποιήσετε για αυτή την άσκηση. Σε διαφορετική περίπτωση, κάθε πλατφόρμα σας δίνει την δυνατότητα να χρησιμοποιήσετε μια μεγάλη ποικιλία από δωρεάν ή επι πληρωμή επεξεργαστές κειμένων. Επιλέξτε έναν που να ταιριάζει με τις ανάγκες σας.</p>
<p>Αυτή η άσκηση χρησιμοποιεί τον επεξεργαστή Notepad++ για Windows</p>
<p><strong>Windows</strong></p>
<p>To <a class="reference external" href="http://notepad-plus-plus.org/">Notepad++</a> είναι ένας καλός, δωρεάν επεξεργαστής για Windows. Κατεβάστε και εγκαταστείστε τον επεξεργαστή <a class="reference external" href="http://notepad-plus-plus.org/repository/6.x/6.7.5/npp.6.7.5.Installer.exe">Notepad++ editor</a>.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Αν χρησιμοποιείτε το Notepad++, φροντίστε να έχετε επιλέξει το <span class="guilabel">Replace by space</span> στο <span class="menuselection">Settings ‣ Preferences ‣ Tab Settings</span>. Η Python είναι αρκετά ευαίσθητη όταν υπάρχουν κενά και αυτή η ρύθμιση θα φροντίσει ώστε οι καρτέλες και τα κενά να διαχειρίζονται με τον σωστό τρόπο.</p>
</div>
</div>
<div class="section" id="plugin-builder-plugin">
<h3>Δημιουργία πρόσθετου<a class="headerlink" href="#plugin-builder-plugin" title="Permalink to this headline">¶</a></h3>
<p>Υπάρχει ένα πολύ χρήσιμο πρόσθετο στο QGIS που ονομάζεται <code class="docutils literal"><span class="pre">Plugin</span> <span class="pre">Builder</span></code>  το οποίο δημιουργεί όλα τα κατάλληλα αρχεία και το πρότυπο του κώδικα για το πρόσθετο. Βρείτε και εγκαταστείστε το πρόσθετο <code class="docutils literal"><span class="pre">Plugin</span> <span class="pre">Builder</span></code>. Βλέπε  <a class="reference internal" href="using_plugins.html"><em>Χρησιμοποιώντας Πρόσθετες Λειτουργίες</em></a>  για περισσότερες λεπτομέρειες για το πως να εγκαταστείσετε ένα πρόσθετο.</p>
</div>
<div class="section" id="plugins-reloader-plugin">
<h3>Μεταφόρτωση πρόσθετου<a class="headerlink" href="#plugins-reloader-plugin" title="Permalink to this headline">¶</a></h3>
<p>Αυτός είναι ένας ακόμα βοηθός για τα πρόσθετα ο οποίος επιτρέπει την επαναλαμβανόμενη ανάπτυξη πρόσθετων. Χρησιμοποιώντας αυτό το πρόσθετο, μπορείτε να αλλάξετε τον κώδικα του πρόσθετού σας και να κάνετε τις αλλαγές να αντικατοπτρίζονται στο QGIS χωρίς να πρέπει να κάνετε επανεκκίνηση στο QGIS κάθε φορά. Βρείτε και εγκαταστείστε το πρόσθετο  <code class="docutils literal"><span class="pre">Plugin</span> <span class="pre">Reloader</span></code>. Δείτε το <a class="reference internal" href="using_plugins.html"><em>Χρησιμοποιώντας Πρόσθετες Λειτουργίες</em></a> για περισσότερες λεπτομέρειες για την εγκατάσταση πρόσθετων.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Ο επαναφορτωτής πρόσθετων είναι ένα πειραματικό πρόσθετο. Φροντίστε να έχετε επιλέξει το <span class="guilabel">Show also experimental plugins</span> στις ρυθμίσεις <span class="guilabel">Plugin Manager</span> αν δεν μπορείτε να το βρείτε.</p>
</div>
</div>
</div>
<div class="section" id="procedure">
<h2>Διαδικασία<a class="headerlink" href="#procedure" title="Permalink to this headline">¶</a></h2>
<ol class="arabic simple">
<li><p class="first">Ανοίξτε το QGIS. Πηγαίνετε στο <span class="menuselection">Plugins ‣ Plugin Builder ‣ Plugin Builder</span>.</p>
</li>
</ol>
<img alt="../_images/116.png" class="align-center" src="../_images/116.png" />
<ol class="arabic simple" start="2">
<li><p class="first">Θα δείτε το παράθυρο διαλόγου <span class="guilabel">QGIS Plugin Builder</span> με μία φόρμα. Μπορείτε να ολοκληρώσετε την φόρμα αυτή με λεπτομέρεις που να σχετίζονται με το πρόσθετό σας. Η <span class="guilabel">Class name</span> θα είναι το όνομα από την κατηγορία της Python που περιέχει την λογική για το πρόσθετο. Αυτό θα είναι επίσης και το όνομα του φακέλου που θα περιέχει όλα τα αρχεία του πρόσθετου. Εισάγετε ως όνομα για την κατηγορία το <code class="docutils literal"><span class="pre">SaveAttributes</span></code>. Προσθέστε μια περιγραφή στο πεδίο <span class="guilabel">Description</span>. Το  <span class="guilabel">Module name</span> θα είναι το όνομα του κεντρικού αρχείου της python για το πρόσθετο. Εισάγετε το ως <code class="docutils literal"><span class="pre">save_attributes</span></code>. Αφήστε τους αριθμούς της έκδοσης ίδιους. Η τιμή του <span class="guilabel">Text for menu item</span> θα είναι ο τρόπος με τον οποίο οι χρήστες θα βρίσκουν το πρόσθετό σας στο μενού του QGIS. Εισάγετέ το ως <code class="docutils literal"><span class="pre">Save</span> <span class="pre">Attributes</span> <span class="pre">as</span> <span class="pre">CSV</span></code>.  Εισάγετε το όνομά σας και την διεύθυσνη του ηλεκτρονικού σας ταχυδρομείου στα κατάλληλα πεδία. Το πεδίο  <span class="guilabel">Menu</span> θα καθορίσει την τοποθεσία του πρόσθετού σας όταν αυτό θα προστεθεί στο QGIS.  Λαμβάνοντας υπόψιν οτι το πρόσθετό σας είναι για διανυσματικά δεδομένα, επιλέξτε &#8220;Vector. Κάντε κλικ στο κουτί <span class="guilabel">Flag the plugin as experimental</span> στο κάτω μέρος της οθόνης. Κάντε κλικ στο <span class="guilabel">OK</span>.</p>
</li>
</ol>
<img alt="../_images/213.png" class="align-center" src="../_images/213.png" />
<ol class="arabic simple" start="3">
<li><p class="first">Έπειτα θα σας ζητηθεί να επιλέξετε ένα φάκελο για το πρόσθετό σας. Θα χρειαστεί να μεταφερθείτε στον φάκελο με τα QGIS python πρόσθετα στον υπολογιστή σας και να επιλέξετε <span class="guilabel">Select Folder</span>. Ενας τυπικός φάκελος <code class="docutils literal"><span class="pre">.qgis2/</span></code> βρίσκεται στον βασικό σας φάκελο. Η θέση του φακέλου <code class="docutils literal"><span class="pre">plugin</span></code> εξαρτάται από την πλατφόρμα που χρησιμοποιείτε και είναι συνήθως : (Replace <code class="docutils literal"><span class="pre">username</span></code> with your login name)</p>
</li>
</ol>
<p><strong>Windows</strong></p>
<div class="highlight-none"><div class="highlight"><pre>c:\Users\username\.qgis2\python\plugins
</pre></div>
</div>
<p><strong>Mac</strong></p>
<div class="highlight-none"><div class="highlight"><pre>/Users/username/.qgis2/python/plugins
</pre></div>
</div>
<p><strong>Linux</strong></p>
<div class="highlight-none"><div class="highlight"><pre>/home/username/.qgis2/python/plugins
</pre></div>
</div>
<img alt="../_images/37.png" class="align-center" src="../_images/37.png" />
<ol class="arabic simple" start="4">
<li><p class="first">Θα δείτε ένα παράθυρο το οποίο θα σας επιβεβαιώνει οτι το πρότυπο του πρόσθετου σας έχει δημιουργηθεί. Συγκρατήστε την διαδρομή για τον φάκελο του πρόσθετου,</p>
</li>
</ol>
<img alt="../_images/44.png" class="align-center" src="../_images/44.png" />
<ol class="arabic simple" start="5">
<li><p class="first">Πριν μπορέσουμε να χρησιμοποιήσουμε το πρόσφατα δημιουργημένο πρόσθετο, χρειάζεται να συντάξουμε το αρχείο <code class="docutils literal"><span class="pre">resources.qrc</span></code>  το οποίο δημιουργήθηκε από το Plugin Builder. Τρέξτε το  <span class="guilabel">OSGeo4W Shell</span> σε Windows ή σε ένα τερματικό σε Mac ή Linux.</p>
</li>
</ol>
<img alt="../_images/54.png" class="align-center" src="../_images/54.png" />
<ol class="arabic simple" start="6">
<li><p class="first">Μεταφερθείτε στον φάκελο του πρόσθετου όπου το εξαγόμενο του <code class="docutils literal"><span class="pre">Plugin</span> <span class="pre">Builder</span></code> δημιουργήθηκε. Μπορείτε να χρησιμοποιήσετε την εντολή <code class="docutils literal"><span class="pre">cd</span></code> ακολουθούμενη από την διαδρομή για τον φάκελο.</p>
</li>
</ol>
<div class="highlight-none"><div class="highlight"><pre>cd c:\Users\username\.qgis2\python\plugins\SaveAttributes
</pre></div>
</div>
<img alt="../_images/64.png" class="align-center" src="../_images/64.png" />
<ol class="arabic simple" start="7">
<li><p class="first">Αφού μεταφερθείτε στον φάκελο, πληκτρολογίστε  <code class="docutils literal"><span class="pre">make</span></code>. Αυτό θα τρέξει την εντολή  <code class="docutils literal"><span class="pre">pyrcc4</span></code> την οποία εγκαταστήσαμε ως μέρος του Qt bindings για την python.</p>
</li>
</ol>
<div class="highlight-none"><div class="highlight"><pre>make
</pre></div>
</div>
<img alt="../_images/74.png" class="align-center" src="../_images/74.png" />
<ol class="arabic simple" start="8">
<li><p class="first">Τώρα είμαστε έτοιμοι να δούμε το νέο πρόσθετο που δημιουργήσαμε. Κλείστε το QGIS και ξανατρέξτε το πάλι. Πηγαίνετε στο <span class="menuselection">Plugins ‣ Manage and Install plugins</span> και ενεργοποιήστε το plugin <code class="docutils literal"><span class="pre">Save</span> <span class="pre">Attributes&quot;</span> <span class="pre">από</span> <span class="pre">την</span> <span class="pre">καρτέλα</span>&nbsp; <span class="pre">:guilabel:`Installed`.</span> <span class="pre">Θα</span> <span class="pre">παρατηρήσετε</span> <span class="pre">οτι</span> <span class="pre">υπάρχει</span> <span class="pre">ένα</span> <span class="pre">νέο</span> <span class="pre">εικονίδιο</span> <span class="pre">στην</span> <span class="pre">γραμμή</span> <span class="pre">εργαλείων</span> <span class="pre">και</span> <span class="pre">μια</span> <span class="pre">νέα</span> <span class="pre">εγγραφή</span> <span class="pre">κάτω</span> <span class="pre">από</span> <span class="pre">το</span> <span class="pre">μενού</span>&nbsp; <span class="pre">:menuselection:`Vector</span> <span class="pre">--&gt;</span> <span class="pre">Save</span> <span class="pre">Attributes</span> <span class="pre">--&gt;</span> <span class="pre">Save</span> <span class="pre">Attributes</span> <span class="pre">as</span> <span class="pre">CSV</span></code>. Επιλέξτε να τρέξετε το παράθυρο διαλόγου για τα πρόσθετα.</p>
</li>
</ol>
<img alt="../_images/84.png" class="align-center" src="../_images/84.png" />
<ol class="arabic simple" start="9">
<li><p class="first">Θα παρατηρήσετε ένα νέο κενό παράθυρο διαλόγου με όνομα <span class="guilabel">Save Attributes</span>. Κλείστε αυτό το παράθυρο διαλόγου.</p>
</li>
</ol>
<img alt="../_images/94.png" class="align-center" src="../_images/94.png" />
<ol class="arabic simple" start="10">
<li><p class="first">Τώρα θα σχεδιάσουμε το δικό μας παράθυρο διαλόγου και θα προσθέσουμε μερικά στοιχεία στην διεπαφή χρήστη. Ανοίξτε το πρόγραμμα <code class="docutils literal"><span class="pre">Qt</span> <span class="pre">Creator</span></code> και πηγαίνετε στο <span class="guilabel">File &#8211;&gt; Open File or Project...</span>.</p>
</li>
</ol>
<img alt="../_images/104.png" class="align-center" src="../_images/104.png" />
<ol class="arabic simple" start="11">
<li><p class="first">Μεταφερθείτε στον φάκελο του πρόσθετου και επιλέξτε το αρχείο  <code class="docutils literal"><span class="pre">save_attributes_dialog_base.ui</span></code>. Πατήστε <span class="guilabel">Open</span>.</p>
</li>
</ol>
<img alt="../_images/117.png" class="align-center" src="../_images/117.png" />
<ol class="arabic simple" start="12">
<li><p class="first">Τώρα θα δείτε ένα κενό παράθυρο διαλόγου από το πρόσθετο. Μπορείτε να επιλέξετε και να σύρετε στοιχεία από το παράθυρο στα αριστερά, στο παράθυρο διαλόγου. Θα προσθέσουμε ενός είδους Widget:guilabel:<cite>Combo Box</cite> type of <span class="guilabel">Input Widget</span>. Σύρετέ το στο παράθυρο διαλόγου του πρόσθετου.</p>
</li>
</ol>
<img alt="../_images/124.png" class="align-center" src="../_images/124.png" />
<ol class="arabic simple" start="13">
<li><p class="first">Αλλάξτε το μέγεθος στο παράθυρο. Τώρα σύρετε στο παράθυρο διαλόγου ένα :<cite>Label</cite> type <span class="guilabel">Display Widget</span>.</p>
</li>
</ol>
<img alt="../_images/134.png" class="align-center" src="../_images/134.png" />
<ol class="arabic simple" start="14">
<li><p class="first">Πατήστε σην ετικέτα κείμενο και εισάγετε το <code class="docutils literal"><span class="pre">Select</span> <span class="pre">a</span> <span class="pre">layer</span></code>.</p>
</li>
</ol>
<img alt="../_images/144.png" class="align-center" src="../_images/144.png" />
<ol class="arabic simple" start="15">
<li><p class="first">Σώστε αυτό το αρχείο πηγαίνοντας στο  <span class="menuselection">File ‣ Save save_attributes_dialog_base.ui</span>. Συγκρατήστε οτι το όνομα από το αντικείμενο- κουτί είναι <code class="docutils literal"><span class="pre">comboBox</span></code>. Για να αλληλεπιδράσετε με το αντικείμενο χρησιμοποιώντας εντολές στην python,  θα πρέπει να το καλείτε με το όνομα αυτό.</p>
</li>
</ol>
<img alt="../_images/154.png" class="align-center" src="../_images/154.png" />
<ol class="arabic simple" start="16">
<li><p class="first">Ας τρέξουμε το πρόσθετο ώστε να μπορούμε να δούμε τις αλλαγές στο παράθυρο διαλόγου. Πηγαίνετε στο <span class="menuselection">Plugin ‣ Plugin Reloader ‣ Choose a plugin to be reloaded</span>.</p>
</li>
</ol>
<img alt="../_images/164.png" class="align-center" src="../_images/164.png" />
<ol class="arabic simple" start="17">
<li><p class="first">Επιλέξτε <code class="docutils literal"><span class="pre">SaveAttributes</span></code> από το παράθυρο διαλόγου  <span class="guilabel">Configure Plugin reloader</span>.</p>
</li>
</ol>
<img alt="../_images/173.png" class="align-center" src="../_images/173.png" />
<ol class="arabic simple" start="18">
<li><p class="first">Τώρα πατήστε στο κουμπί  <span class="guilabel">Save Attributes as CSV</span>. Θα δείτε ένα καινούριο σχεδιασμένο παράθυρο διαλόγου.</p>
</li>
</ol>
<img alt="../_images/184.png" class="align-center" src="../_images/184.png" />
<ol class="arabic simple" start="19">
<li><p class="first">Ας προσθέσουμε τώρα λογική στο πρόσθετο το οποίο θα γεμίσει το κουτί με στρώματα τα οποία φορτώνονται στο QGIS. Πηγαίνετε στον φάκελο του πρόσθετου και φορτώστε το αρχείο <code class="docutils literal"><span class="pre">save_attributes.py</span></code> σε έναν επεξεργαστή κειμένου. Μεταφερθείτε προς τα κάτω και βρείτε την μέθοδο <code class="docutils literal"><span class="pre">run(self)</span></code>. Αυτή η μέθοδος θα καλείται όταν πατάτε το κουμπί στην γραμμή εργαλείων ή επιλέγετε το πρόσθετο από το μενού. Προσθέστε τον παρακάτω κώδικα στην αρχή της μεθόδου. Αυτός ο κώδικας παίρνει όλα τα στρώματα τα οποία είναι φορτωμένα στο QGIS και τα προσθέτει  στο αντικείμενο κουτί από το παράθυρο διαλόγου του πρόσθετου.</p>
</li>
</ol>
<div class="highlight-python"><div class="highlight"><pre><span class="n">layers</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">iface</span><span class="o">.</span><span class="n">legendInterface</span><span class="p">()</span><span class="o">.</span><span class="n">layers</span><span class="p">()</span>
<span class="n">layer_list</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">layer</span> <span class="ow">in</span> <span class="n">layers</span><span class="p">:</span>
     <span class="n">layer_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">layer</span><span class="o">.</span><span class="n">name</span><span class="p">())</span>
     <span class="bp">self</span><span class="o">.</span><span class="n">dlg</span><span class="o">.</span><span class="n">comboBox</span><span class="o">.</span><span class="n">addItems</span><span class="p">(</span><span class="n">layer_list</span><span class="p">)</span>
</pre></div>
</div>
<img alt="../_images/192.png" class="align-center" src="../_images/192.png" />
<ol class="arabic simple" start="20">
<li><p class="first">Πίσω στο κύριο παράθυρο του QGIS, φορτώστε το πρόσθετο πηγαίνοντας στο <span class="menuselection">Plugins ‣ Plugin Reloader ‣ Reload plugin: SaveAttributes</span>. Εναλλακτικά, μπορείτε απλά να πατήσετε <code class="kbd docutils literal"><span class="pre">F5</span></code>. Για να δοκιμάσετε την λειτουργία, θα πρέπει να προσθέσετε μερικά στρώματα στο QGIS. Αφού προσθέσετε τα δεδομένα, τρέξτε το πρόσθετο πηγαίνοντας στο  <span class="menuselection">Vector ‣ Save Attributes ‣ Save Attributes as CSV</span>.</p>
</li>
</ol>
<img alt="../_images/201.png" class="align-center" src="../_images/201.png" />
<ol class="arabic simple" start="21">
<li><p class="first">Θα δείτε οτι το κουτί είναι τώρα γεμάτο με τα ονόματα των στρωμάτων τα οποία έχετε φορτώσει στο QGIS.</p>
</li>
</ol>
<img alt="../_images/214.png" class="align-center" src="../_images/214.png" />
<ol class="arabic simple" start="22">
<li><p class="first">Ας προσθέσουμε μερικά στοιχεία διεπαφής χρήστη ακόμα. Πηγαίνετε πάλι στο <code class="docutils literal"><span class="pre">Qt</span> <span class="pre">Creator&quot;</span> <span class="pre">και</span> <span class="pre">φορτώστε</span> <span class="pre">το</span> <span class="pre">αρχείο</span> <span class="pre">``save_attributes_dialog_base.ui</span></code>. Προσθέστε μια &#8220;Ετικέτα&#8221; <span class="guilabel">Display Widget</span> και αλλάξτε το κείμενο στο <code class="docutils literal"><span class="pre">Select</span> <span class="pre">output</span> <span class="pre">file</span></code>. Προσθέστε ένα <cite>LineEdit`</cite> <span class="guilabel">Input Widget</span> το οποίο θα δείχνει την διεύθυσνη του εξαγόμενου αρχείου που έχει επιλεχθεί από τον χρήστη. Μετά, προσθέστε ένα κουμπί  <code class="docutils literal"><span class="pre">Push</span> <span class="pre">Button</span></code>  <span class="guilabel">Button</span> και αλλάξτε την ετικέτα του σε <code class="docutils literal"><span class="pre">...</span></code>. Σημειώστε οτι τα ονόματα των αντικειμένων από τα widget καθώς θα πρέπει να τα χρησιμοποιήσετε για να αλληλεπιδράσετε μαζί τους. Σώστε το αρχείο.</p>
</li>
</ol>
<img alt="../_images/221.png" class="align-center" src="../_images/221.png" />
<ol class="arabic simple" start="23">
<li><p class="first">Τώρα θα προσθέσουμε κώδικα στην python μέσω του οποίου θα ανοίγει ένας περιηγητής αρχείων όταν ο χρήστης θα πατάει το κουμπί <code class="docutils literal"><span class="pre">...</span></code> και να εμφανίζει την επιλεγμένη διαδρομή σε μια γραμμή κειμένου στο widget. Ανοίξτε το αρχείο <code class="docutils literal"><span class="pre">save_attributes.py</span></code> σε έναν επεξεργαστή κειμένου. Προσθέστε το  <code class="docutils literal"><span class="pre">QFileDialog</span></code> στην λίστα με τα εισαγόμενα στην κορυφή του αρχείου</p>
</li>
</ol>
<img alt="../_images/231.png" class="align-center" src="../_images/231.png" />
<ol class="arabic simple" start="24">
<li><p class="first">Προσθέστε μια νέα μέθοδο που λέγεται <code class="docutils literal"><span class="pre">select_output_file</span></code> χρησιμοποιώντας τον παρακάτω κώδικα. Αυτός ο κώδικας θα ανοίγει έναν περιηγητή και θα εμφανίζει στην γραμμή του widget την διαδρομή του αρχείου που έχει επιλέξει ο χρήστης.</p>
</li>
</ol>
<div class="highlight-python"><div class="highlight"><pre><span class="k">def</span> <span class="nf">select_output_file</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="n">filename</span> <span class="o">=</span> <span class="n">QFileDialog</span><span class="o">.</span><span class="n">getSaveFileName</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dlg</span><span class="p">,</span> <span class="s">&quot;Select output file &quot;</span><span class="p">,</span><span class="s">&quot;&quot;</span><span class="p">,</span> <span class="s">&#39;*.txt&#39;</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">dlg</span><span class="o">.</span><span class="n">lineEdit</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span>
</pre></div>
</div>
<img alt="../_images/241.png" class="align-center" src="../_images/241.png" />
<ol class="arabic simple" start="25">
<li><p class="first">Τώρα πρέπει να προσθέσετε κώδικα ώστε όταν το κουμπί  <cite>...</cite> ενεργοποιείται, να καλείται η μέθοδος <code class="docutils literal"><span class="pre">select_output_file</span></code>. Μεταφερθείτε προς τα πάνω στην μέθοδο  <code class="docutils literal"><span class="pre">__init__</span></code> και προσθέστε τις παρακάτω γραμμές στο τέλος της.  Αυτός ο κώδικάς θα σβήνει το κείμενο που είχε φορτωθεί προηγουμένως (αν υπάρχει) στην γραμμή του widget και επίσης θα συνδέει την μέθοδο <code class="docutils literal"><span class="pre">select_output_file</span></code> με το σήμα που δίνει το &#8220;κλικ&#8221; όταν ο χρήστης πατάει το κουμπί στο widget.</p>
</li>
</ol>
<div class="highlight-python"><div class="highlight"><pre><span class="bp">self</span><span class="o">.</span><span class="n">dlg</span><span class="o">.</span><span class="n">lineEdit</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
<span class="bp">self</span><span class="o">.</span><span class="n">dlg</span><span class="o">.</span><span class="n">pushButton</span><span class="o">.</span><span class="n">clicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">select_output_file</span><span class="p">)</span>
</pre></div>
</div>
<img alt="../_images/251.png" class="align-center" src="../_images/251.png" />
<ol class="arabic simple" start="26">
<li><p class="first">Πίσω στο QGIS, φορτώστε το πρόσθετο και ανοίξτε το παράθυρο διαλόγου <span class="guilabel">Save Attributes`</span>. Αν όλα έχουν πάει καλά, θα είστε σε θέση να κάνετε κλικ στο κουμπί <code class="docutils literal"><span class="pre">...</span></code> και επιλέξτε το εξαγόμενο αρχείο κειμένου από τον δίσκο σας.</p>
</li>
</ol>
<img alt="../_images/261.png" class="align-center" src="../_images/261.png" />
<ol class="arabic simple" start="27">
<li><p class="first">Όταν πατάτε το  <span class="guilabel">OK</span> στο παράθυρο διαλόγου του πρόσθετου, δεν συμβαίνει τίποτα. Αυτό συμβαίνει επειδή δεν έχετε προσθέσει λογική ώστε να τραβάτε τα χαρακτηριστικά της πληροφορίας από το στρώμα και να τα γράφετε στο αρχείο κειμένου. Τώρα έχουμε όλα τα κομμάτια στην θέση τους για να ξεκινήσουμε. Βρείτε το σημείο στην μέθοδο <code class="docutils literal"><span class="pre">run</span></code> που λέει <code class="docutils literal"><span class="pre">pass</span></code>. Αντικαταστήστε το με τον κώδικα παρακάτω. Η εξήγηση για αυτόν τον κώδικα βρίσκεται στο <a class="reference internal" href="getting_started_with_pyqgis.html"><em>Ξεκινώντας προγραμματισμό με την Python</em></a>.</p>
</li>
</ol>
<div class="highlight-python"><div class="highlight"><pre><span class="n">filename</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dlg</span><span class="o">.</span><span class="n">lineEdit</span><span class="o">.</span><span class="n">text</span><span class="p">()</span>
<span class="n">output_file</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="s">&#39;w&#39;</span><span class="p">)</span>

<span class="n">selectedLayerIndex</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dlg</span><span class="o">.</span><span class="n">comboBox</span><span class="o">.</span><span class="n">currentIndex</span><span class="p">()</span>
<span class="n">selectedLayer</span> <span class="o">=</span> <span class="n">layers</span><span class="p">[</span><span class="n">selectedLayerIndex</span><span class="p">]</span>
<span class="n">fields</span> <span class="o">=</span> <span class="n">selectedLayer</span><span class="o">.</span><span class="n">pendingFields</span><span class="p">()</span>
<span class="n">fieldnames</span> <span class="o">=</span> <span class="p">[</span><span class="n">field</span><span class="o">.</span><span class="n">name</span><span class="p">()</span> <span class="k">for</span> <span class="n">field</span> <span class="ow">in</span> <span class="n">fields</span><span class="p">]</span>

<span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="n">selectedLayer</span><span class="o">.</span><span class="n">getFeatures</span><span class="p">():</span>
    <span class="n">line</span> <span class="o">=</span> <span class="s">&#39;,&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">unicode</span><span class="p">(</span><span class="n">f</span><span class="p">[</span><span class="n">x</span><span class="p">])</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">fieldnames</span><span class="p">)</span> <span class="o">+</span> <span class="s">&#39;</span><span class="se">\n</span><span class="s">&#39;</span>
    <span class="n">unicode_line</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="s">&#39;utf-8&#39;</span><span class="p">)</span>
    <span class="n">output_file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">unicode_line</span><span class="p">)</span>
<span class="n">output_file</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</pre></div>
</div>
<img alt="../_images/271.png" class="align-center" src="../_images/271.png" />
<ol class="arabic simple" start="28">
<li><p class="first">Τώρα το πρόσθετό μας είναι έτοιμο. Μεταφορτώστε το πρόσθετο και δοκιμάστε το. Θα δείτε οτι το εξαγόμενο αρχείο που έχετε επιλέξει έχει όλα τα χαρακτηριστικά από το διανυσματικό στρώμα. Μπορείτε να συμπιέσετε τον φάκελο του πρόσθετου και να το μοιραστείτε με άλλους χρήστες. Αυτού μπορούν να αποσυμπιέσουν τα περιεχόμενα του φακέλου του πρόσθετου και να δοκιμάσουν το πρόσθετό σας. Αν αυτό είναι ένα πραγματικό πρόσθετο, μπορείτε να το ανεβάσετε στο αποθετήριο πρόσθετων του QGIS  &lt;<a class="reference external" href="https://plugins.qgis.org/">https://plugins.qgis.org/</a>&gt;`_ ώστε όλοι οι χρήστες τους QGIS να είναι σε θέση να βρούν και να κατεβάσουν το πρόσθετό σας.</p>
</li>
</ol>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Αυτό το πρόσθετο είναι για εκπαιδευτικούς λόγους μόνο. Μην το δημοσιεύσετε ή ανεβάσετε το πρόσθετο αυτό στο αποθετήριο του QGIS.</p>
</div>
<p>Παρακάτω παραθέτεται το πλήρες αρχείο <code class="docutils literal"><span class="pre">save_attributes.py</span></code> ως αναφορά.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="c"># -*- coding: utf-8 -*-</span>
<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">/***************************************************************************</span>
<span class="sd"> SaveAttributes</span>
<span class="sd">                                 A QGIS plugin</span>
<span class="sd"> This plugin saves the attribute of the selected vector layer as a CSV file.</span>
<span class="sd">                              -------------------</span>
<span class="sd">        begin                : 2015-04-20</span>
<span class="sd">        git sha              : $Format:%H$</span>
<span class="sd">        copyright            : (C) 2015 by Ujaval Gandhi</span>
<span class="sd">        email                : ujaval@spatialthoughts.com</span>
<span class="sd"> ***************************************************************************/</span>

<span class="sd">/***************************************************************************</span>
<span class="sd"> *                                                                         *</span>
<span class="sd"> *   This program is free software; you can redistribute it and/or modify  *</span>
<span class="sd"> *   it under the terms of the GNU General Public License as published by  *</span>
<span class="sd"> *   the Free Software Foundation; either version 2 of the License, or     *</span>
<span class="sd"> *   (at your option) any later version.                                   *</span>
<span class="sd"> *                                                                         *</span>
<span class="sd"> ***************************************************************************/</span>
<span class="sd">&quot;&quot;&quot;</span>
<span class="kn">from</span> <span class="nn">PyQt4.QtCore</span> <span class="kn">import</span> <span class="n">QSettings</span><span class="p">,</span> <span class="n">QTranslator</span><span class="p">,</span> <span class="n">qVersion</span><span class="p">,</span> <span class="n">QCoreApplication</span>
<span class="kn">from</span> <span class="nn">PyQt4.QtGui</span> <span class="kn">import</span> <span class="n">QAction</span><span class="p">,</span> <span class="n">QIcon</span><span class="p">,</span> <span class="n">QFileDialog</span>
<span class="c"># Initialize Qt resources from file resources.py</span>
<span class="kn">import</span> <span class="nn">resources_rc</span>
<span class="c"># Import the code for the dialog</span>
<span class="kn">from</span> <span class="nn">save_attributes_dialog</span> <span class="kn">import</span> <span class="n">SaveAttributesDialog</span>
<span class="kn">import</span> <span class="nn">os.path</span>


<span class="k">class</span> <span class="nc">SaveAttributes</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;QGIS Plugin Implementation.&quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">iface</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Constructor.</span>

<span class="sd">        :param iface: An interface instance that will be passed to this class</span>
<span class="sd">            which provides the hook by which you can manipulate the QGIS</span>
<span class="sd">            application at run time.</span>
<span class="sd">        :type iface: QgsInterface</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c"># Save reference to the QGIS interface</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">iface</span> <span class="o">=</span> <span class="n">iface</span>
        <span class="c"># initialize plugin directory</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">plugin_dir</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="n">__file__</span><span class="p">)</span>
        <span class="c"># initialize locale</span>
        <span class="n">locale</span> <span class="o">=</span> <span class="n">QSettings</span><span class="p">()</span><span class="o">.</span><span class="n">value</span><span class="p">(</span><span class="s">&#39;locale/userLocale&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">:</span><span class="mi">2</span><span class="p">]</span>
        <span class="n">locale_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">plugin_dir</span><span class="p">,</span>
            <span class="s">&#39;i18n&#39;</span><span class="p">,</span>
            <span class="s">&#39;SaveAttributes_{}.qm&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">locale</span><span class="p">))</span>

        <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">locale_path</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">translator</span> <span class="o">=</span> <span class="n">QTranslator</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">translator</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">locale_path</span><span class="p">)</span>

            <span class="k">if</span> <span class="n">qVersion</span><span class="p">()</span> <span class="o">&gt;</span> <span class="s">&#39;4.3.3&#39;</span><span class="p">:</span>
                <span class="n">QCoreApplication</span><span class="o">.</span><span class="n">installTranslator</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">translator</span><span class="p">)</span>

        <span class="c"># Create the dialog (after translation) and keep reference</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dlg</span> <span class="o">=</span> <span class="n">SaveAttributesDialog</span><span class="p">()</span>

        <span class="c"># Declare instance attributes</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">actions</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">menu</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">tr</span><span class="p">(</span><span class="s">u&#39;&amp;Save Attributes&#39;</span><span class="p">)</span>
        <span class="c"># TODO: We are going to let the user set this up in a future iteration</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">toolbar</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">iface</span><span class="o">.</span><span class="n">addToolBar</span><span class="p">(</span><span class="s">u&#39;SaveAttributes&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">toolbar</span><span class="o">.</span><span class="n">setObjectName</span><span class="p">(</span><span class="s">u&#39;SaveAttributes&#39;</span><span class="p">)</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">dlg</span><span class="o">.</span><span class="n">lineEdit</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dlg</span><span class="o">.</span><span class="n">pushButton</span><span class="o">.</span><span class="n">clicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">select_output_file</span><span class="p">)</span>
        

    <span class="c"># noinspection PyMethodMayBeStatic</span>
    <span class="k">def</span> <span class="nf">tr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">message</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Get the translation for a string using Qt translation API.</span>

<span class="sd">        We implement this ourselves since we do not inherit QObject.</span>

<span class="sd">        :param message: String for translation.</span>
<span class="sd">        :type message: str, QString</span>

<span class="sd">        :returns: Translated version of message.</span>
<span class="sd">        :rtype: QString</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c"># noinspection PyTypeChecker,PyArgumentList,PyCallByClass</span>
        <span class="k">return</span> <span class="n">QCoreApplication</span><span class="o">.</span><span class="n">translate</span><span class="p">(</span><span class="s">&#39;SaveAttributes&#39;</span><span class="p">,</span> <span class="n">message</span><span class="p">)</span>


    <span class="k">def</span> <span class="nf">add_action</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">icon_path</span><span class="p">,</span>
        <span class="n">text</span><span class="p">,</span>
        <span class="n">callback</span><span class="p">,</span>
        <span class="n">enabled_flag</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span>
        <span class="n">add_to_menu</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span>
        <span class="n">add_to_toolbar</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span>
        <span class="n">status_tip</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
        <span class="n">whats_this</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
        <span class="n">parent</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Add a toolbar icon to the toolbar.</span>

<span class="sd">        :param icon_path: Path to the icon for this action. Can be a resource</span>
<span class="sd">            path (e.g. &#39;:/plugins/foo/bar.png&#39;) or a normal file system path.</span>
<span class="sd">        :type icon_path: str</span>

<span class="sd">        :param text: Text that should be shown in menu items for this action.</span>
<span class="sd">        :type text: str</span>

<span class="sd">        :param callback: Function to be called when the action is triggered.</span>
<span class="sd">        :type callback: function</span>

<span class="sd">        :param enabled_flag: A flag indicating if the action should be enabled</span>
<span class="sd">            by default. Defaults to True.</span>
<span class="sd">        :type enabled_flag: bool</span>

<span class="sd">        :param add_to_menu: Flag indicating whether the action should also</span>
<span class="sd">            be added to the menu. Defaults to True.</span>
<span class="sd">        :type add_to_menu: bool</span>

<span class="sd">        :param add_to_toolbar: Flag indicating whether the action should also</span>
<span class="sd">            be added to the toolbar. Defaults to True.</span>
<span class="sd">        :type add_to_toolbar: bool</span>

<span class="sd">        :param status_tip: Optional text to show in a popup when mouse pointer</span>
<span class="sd">            hovers over the action.</span>
<span class="sd">        :type status_tip: str</span>

<span class="sd">        :param parent: Parent widget for the new action. Defaults None.</span>
<span class="sd">        :type parent: QWidget</span>

<span class="sd">        :param whats_this: Optional text to show in the status bar when the</span>
<span class="sd">            mouse pointer hovers over the action.</span>

<span class="sd">        :returns: The action that was created. Note that the action is also</span>
<span class="sd">            added to self.actions list.</span>
<span class="sd">        :rtype: QAction</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">icon</span> <span class="o">=</span> <span class="n">QIcon</span><span class="p">(</span><span class="n">icon_path</span><span class="p">)</span>
        <span class="n">action</span> <span class="o">=</span> <span class="n">QAction</span><span class="p">(</span><span class="n">icon</span><span class="p">,</span> <span class="n">text</span><span class="p">,</span> <span class="n">parent</span><span class="p">)</span>
        <span class="n">action</span><span class="o">.</span><span class="n">triggered</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="n">callback</span><span class="p">)</span>
        <span class="n">action</span><span class="o">.</span><span class="n">setEnabled</span><span class="p">(</span><span class="n">enabled_flag</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">status_tip</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">action</span><span class="o">.</span><span class="n">setStatusTip</span><span class="p">(</span><span class="n">status_tip</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">whats_this</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">action</span><span class="o">.</span><span class="n">setWhatsThis</span><span class="p">(</span><span class="n">whats_this</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">add_to_toolbar</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">toolbar</span><span class="o">.</span><span class="n">addAction</span><span class="p">(</span><span class="n">action</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">add_to_menu</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">iface</span><span class="o">.</span><span class="n">addPluginToVectorMenu</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">menu</span><span class="p">,</span>
                <span class="n">action</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">actions</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">action</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">action</span>

    <span class="k">def</span> <span class="nf">initGui</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Create the menu entries and toolbar icons inside the QGIS GUI.&quot;&quot;&quot;</span>

        <span class="n">icon_path</span> <span class="o">=</span> <span class="s">&#39;:/plugins/SaveAttributes/icon.png&#39;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">add_action</span><span class="p">(</span>
            <span class="n">icon_path</span><span class="p">,</span>
            <span class="n">text</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">tr</span><span class="p">(</span><span class="s">u&#39;Save Attributes as CSV&#39;</span><span class="p">),</span>
            <span class="n">callback</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">run</span><span class="p">,</span>
            <span class="n">parent</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">iface</span><span class="o">.</span><span class="n">mainWindow</span><span class="p">())</span>


    <span class="k">def</span> <span class="nf">unload</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Removes the plugin menu item and icon from QGIS GUI.&quot;&quot;&quot;</span>
        <span class="k">for</span> <span class="n">action</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">actions</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">iface</span><span class="o">.</span><span class="n">removePluginVectorMenu</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">tr</span><span class="p">(</span><span class="s">u&#39;&amp;Save Attributes&#39;</span><span class="p">),</span>
                <span class="n">action</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">iface</span><span class="o">.</span><span class="n">removeToolBarIcon</span><span class="p">(</span><span class="n">action</span><span class="p">)</span>
        <span class="c"># remove the toolbar</span>
        <span class="k">del</span> <span class="bp">self</span><span class="o">.</span><span class="n">toolbar</span>

    <span class="k">def</span> <span class="nf">select_output_file</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">filename</span> <span class="o">=</span> <span class="n">QFileDialog</span><span class="o">.</span><span class="n">getSaveFileName</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dlg</span><span class="p">,</span> <span class="s">&quot;Select output file &quot;</span><span class="p">,</span><span class="s">&quot;&quot;</span><span class="p">,</span> <span class="s">&#39;*.txt&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dlg</span><span class="o">.</span><span class="n">lineEdit</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span>
        
    <span class="k">def</span> <span class="nf">run</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Run method that performs all the real work&quot;&quot;&quot;</span>
        <span class="n">layers</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">iface</span><span class="o">.</span><span class="n">legendInterface</span><span class="p">()</span><span class="o">.</span><span class="n">layers</span><span class="p">()</span>
        <span class="n">layer_list</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">layer</span> <span class="ow">in</span> <span class="n">layers</span><span class="p">:</span>
                <span class="n">layer_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">layer</span><span class="o">.</span><span class="n">name</span><span class="p">())</span>
            
        <span class="bp">self</span><span class="o">.</span><span class="n">dlg</span><span class="o">.</span><span class="n">comboBox</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dlg</span><span class="o">.</span><span class="n">comboBox</span><span class="o">.</span><span class="n">addItems</span><span class="p">(</span><span class="n">layer_list</span><span class="p">)</span>
        <span class="c"># show the dialog</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dlg</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
        <span class="c"># Run the dialog event loop</span>
        <span class="n">result</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dlg</span><span class="o">.</span><span class="n">exec_</span><span class="p">()</span>
        <span class="c"># See if OK was pressed</span>
        <span class="k">if</span> <span class="n">result</span><span class="p">:</span>
            <span class="c"># Do something useful here - delete the line containing pass and</span>
            <span class="c"># substitute with your code.</span>
            <span class="n">filename</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dlg</span><span class="o">.</span><span class="n">lineEdit</span><span class="o">.</span><span class="n">text</span><span class="p">()</span>
            <span class="n">output_file</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="s">&#39;w&#39;</span><span class="p">)</span>
           
            <span class="n">selectedLayerIndex</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dlg</span><span class="o">.</span><span class="n">comboBox</span><span class="o">.</span><span class="n">currentIndex</span><span class="p">()</span>
            <span class="n">selectedLayer</span> <span class="o">=</span> <span class="n">layers</span><span class="p">[</span><span class="n">selectedLayerIndex</span><span class="p">]</span>
            <span class="n">fields</span> <span class="o">=</span> <span class="n">selectedLayer</span><span class="o">.</span><span class="n">pendingFields</span><span class="p">()</span>
            <span class="n">fieldnames</span> <span class="o">=</span> <span class="p">[</span><span class="n">field</span><span class="o">.</span><span class="n">name</span><span class="p">()</span> <span class="k">for</span> <span class="n">field</span> <span class="ow">in</span> <span class="n">fields</span><span class="p">]</span>
            
            <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="n">selectedLayer</span><span class="o">.</span><span class="n">getFeatures</span><span class="p">():</span>
                <span class="n">line</span> <span class="o">=</span> <span class="s">&#39;,&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">unicode</span><span class="p">(</span><span class="n">f</span><span class="p">[</span><span class="n">x</span><span class="p">])</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">fieldnames</span><span class="p">)</span> <span class="o">+</span> <span class="s">&#39;</span><span class="se">\n</span><span class="s">&#39;</span>
                <span class="n">unicode_line</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="s">&#39;utf-8&#39;</span><span class="p">)</span>
                <span class="n">output_file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">unicode_line</span><span class="p">)</span>
            <span class="n">output_file</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>





  <div id="disqus_thread"></div>
  <noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
  <a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>


    </div>
      
  </div>
</div>

<footer class="footer">
  <div class="container">
    <p class="pull-right">
      <a href="#">Back to top</a>
      
    </p>
    <p>
        &copy; Copyright 2016, Ujaval Gandhi.<br/>
      Last updated on Apr 30, 2018.<br/>
      Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 1.3.6.<br/>
    </p>
  </div>
</footer>
<div class="container">
  <p>This work is licensed under a <a href="http://creativecommons.org/licenses/by/4.0/deed.en_US">Creative Commons Attribution 4.0 International License</a></p>
</div>
<!-- Twitter Button -->
<script>!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0],p=/^http:/.test(d.location)?'http':'https';if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src=p+'://platform.twitter.com/widgets.js';fjs.parentNode.insertBefore(js,fjs);}}(document, 'script', 'twitter-wjs');</script>

<!-- Disqus comments widget -->
<script type="text/javascript">
  /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
  var disqus_shortname = 'qgistutorials'; // required: replace example with your forum shortname
  /* * * DON'T EDIT BELOW THIS LINE * * */
  (function () {
    var s = document.createElement('script'); s.async = true;
    s.type = 'text/javascript';
    s.src = '//' + disqus_shortname + '.disqus.com/count.js';
    (document.getElementsByTagName('HEAD')[0] || document.getElementsByTagName('BODY')[0]).appendChild(s);
  }());
</script>

<script type="text/javascript">
  /* * * DON'T EDIT BELOW THIS LINE * * */
  (function() {
    var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
    dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
    (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
  })();
</script>

<!-- Go to www.addthis.com/dashboard to customize your tools -->
<script type="text/javascript" src="//s7.addthis.com/js/300/addthis_widget.js#pubid=spatialthoughts" async="async"></script>

<!-- Script fpr language switching. Largely adapted from https://github.com/pcav/faunalia-website -->
<script>
    var currentPage = 'docs/building_a_python_plugin.html'; // coming from sphinx, always without starting '/'
    var currentLang = 'en';
    $(document).ready(function(){

        var search = new RegExp('\/[a-zA-Z_]{2,8}\/'+ currentPage, 'gi');
        var langPlusPage = window.location.href.match(search);
        // it's possible this is a index.html page called without 'index.html', try without the currentPage
        if (langPlusPage==undefined){
            search = new RegExp('\/[a-zA-Z_]{2,8}\/$', 'gi');
            langPlusPage = window.location.href.match(search);
        }

        // it's possible this is an index.html page called without 'index.html', try removing index.html
        if (langPlusPage==undefined){
            currentPage = currentPage.replace('index.html','')
            search = new RegExp('\/[a-zA-Z_]{2,8}\/'+ currentPage, 'gi');
            langPlusPage = window.location.href.match(search);
        }
        // still no langPlugPage: stop, because the language swicher will misbehave 

        if (langPlusPage == undefined || langPlusPage.length != 1){
            alert('You hit an error, please report back to us.');
            return;
        }
        langPlusPage = langPlusPage[0];
        currentLang = langPlusPage.replace(currentPage, '');

        $("#languages").val(currentLang.replace(/\//g,'')); // currentLang is something like '/nl/'

        $("#languages").change(function() {
            gotoLang($(this).val());
        });

    });

    // load current page in a different language
    function gotoLang(lang){
        var currentUrl = window.location.href;
        var newUrl = currentUrl.replace(currentLang, '/'+lang+'/');
        window.location.href = newUrl;
    }
</script>

  </body>
</html>