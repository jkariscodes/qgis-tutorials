<!DOCTYPE html>


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Taken voor QGIS uitvoeren en in schema zetten &mdash; QGIS Tutorials and Tips</title>
    
    <link rel="stylesheet" href="../_static/basic.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../_static/bootswatch-3.2.0/united/bootstrap.min.css" type="text/css" />
    <link rel="stylesheet" href="../_static/bootstrap-sphinx.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '1',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <script type="text/javascript" src="../_static/translations.js"></script>
    <script type="text/javascript" src="../_static/js/jquery-1.11.0.min.js"></script>
    <script type="text/javascript" src="../_static/js/jquery-fix.js"></script>
    <script type="text/javascript" src="../_static/bootstrap-3.2.0/js/bootstrap.min.js"></script>
    <script type="text/javascript" src="../_static/bootstrap-sphinx.js"></script>
    <link rel="top" title="QGIS Tutorials and Tips" href="../index.html" />
    <link rel="next" title="Naburige polygonen in een laag zoeken" href="find_neighbor_polygons.html" />
    <link rel="prev" title="Python-scripts schrijven voor framework Processing" href="processing_python_scripts.html" />

<meta charset='utf-8'>
<meta http-equiv='X-UA-Compatible' content='IE=edge,chrome=1'>
<meta name='viewport' content='width=device-width, initial-scale=1.0, maximum-scale=1'>
<meta name="apple-mobile-web-app-capable" content="yes">

<!-- Google Analytics -->
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-690672-13', 'qgistutorials.com');
  ga('require', 'displayfeatures');
  ga('send', 'pageview');
</script>


  </head>
  <body role="document">

  <div id="navbar" class="navbar navbar-default navbar-fixed-top">
    <div class="container">
      <div class="navbar-header">
        <!-- .btn-navbar is used as the toggle for collapsed navbar content -->
        <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".nav-collapse">
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>
        <a class="navbar-brand" href="../index.html"><img src="../_static/logo.png">
          QGIS Tutorials and Tips</a>
        <span class="navbar-text navbar-version pull-left"><b>v1.0</b></span>
      </div>

        <div class="collapse navbar-collapse nav-collapse">
          <ul class="nav navbar-nav">
            
            
              <li class="dropdown globaltoc-container">
  <a role="button"
     id="dLabelGlobalToc"
     data-toggle="dropdown"
     data-target="#"
     href="../index.html">Tutorials List <b class="caret"></b></a>
  <ul class="dropdown-menu globaltoc"
      role="menu"
      aria-labelledby="dLabelGlobalToc"><ul class="current">
<li class="toctree-l1"><a class="reference internal" href="introduction.html">Introductie</a></li>
<li class="toctree-l1"><a class="reference internal" href="making_a_map.html">Een kaart maken</a></li>
<li class="toctree-l1"><a class="reference internal" href="working_with_attributes.html">Werken met attributen</a></li>
<li class="toctree-l1"><a class="reference internal" href="importing_spreadsheets_csv.html">Werkbladen of CSV-bestanden importeren</a></li>
<li class="toctree-l1"><a class="reference internal" href="using_plugins.html">Plug-ins gebruiken</a></li>
<li class="toctree-l1"><a class="reference internal" href="downloading_osm_data.html">Zoeken en downloaden van gegevens van OpenStreetMap</a></li>
<li class="toctree-l1"><a class="reference internal" href="basic_vector_styling.html">Basis opmaken van vectoren</a></li>
<li class="toctree-l1"><a class="reference internal" href="calculating_line_lengths.html">Lengten van lijnen en statistieken berekenen</a></li>
<li class="toctree-l1"><a class="reference internal" href="raster_styling_and_analysis.html">Basis opmaken en analyses van rasters</a></li>
<li class="toctree-l1"><a class="reference internal" href="raster_mosaicing_and_clipping.html">Rasters mozaieken en clippen</a></li>
<li class="toctree-l1"><a class="reference internal" href="working_with_terrain.html">Werken met gegevens over het terrein</a></li>
<li class="toctree-l1"><a class="reference internal" href="working_with_wms.html">Werken met gegevens van WMS</a></li>
<li class="toctree-l1"><a class="reference internal" href="working_with_projections.html">Werken met projecties</a></li>
<li class="toctree-l1"><a class="reference internal" href="georeferencing_basics.html">Topobladen en gescande kaarten voorzien van geoverwijzingen</a></li>
<li class="toctree-l1"><a class="reference internal" href="advanced_georeferencing.html">Geo-verwijzingen voor satellietbeelden</a></li>
<li class="toctree-l1"><a class="reference internal" href="digitizing_basics.html">Kaartgegevens digitaliseren</a></li>
<li class="toctree-l1"><a class="reference internal" href="performing_table_joins.html">Samenvoegen van tabellen uitvoeren</a></li>
<li class="toctree-l1"><a class="reference internal" href="performing_spatial_joins.html">Ruimtelijke samenvoegingen uitvoeren</a></li>
<li class="toctree-l1"><a class="reference internal" href="points_in_polygon.html">Punten in polygoon-analyses</a></li>
<li class="toctree-l1"><a class="reference internal" href="creating_heatmaps.html">Heatmaps maken</a></li>
<li class="toctree-l1"><a class="reference internal" href="performing_spatial_queries.html">Ruimtelijke query&#8217;s uitvoeren</a></li>
<li class="toctree-l1"><a class="reference internal" href="nearest_neighbor_analysis.html">Analyse Nearest Neighbor</a></li>
<li class="toctree-l1"><a class="reference internal" href="sampling_raster_data.html">Monsters nemen van rastergegevens met behulp van punten of polygonen</a></li>
<li class="toctree-l1"><a class="reference internal" href="interpolating_point_data.html">Interpoleren van puntgegevens</a></li>
<li class="toctree-l1"><a class="reference internal" href="batch_processing.html">Massa verwerken met behulp van Framework Processing</a></li>
<li class="toctree-l1"><a class="reference internal" href="processing_graphical_modeler.html">Complexe werkstromen automatiseren met behulp van Grafische modellen bouwen</a></li>
<li class="toctree-l1"><a class="reference internal" href="automating_map_creation.html">Maken van kaarten automatiseren met Atlas van Printvormgeving</a></li>
<li class="toctree-l1"><a class="reference internal" href="using_qgis_browser.html">De QGIS Browser gebruiken</a></li>
<li class="toctree-l1"><a class="reference internal" href="counting_vertices.html">Aantal punten in een laag tellen</a></li>
<li class="toctree-l1"><a class="reference internal" href="open_bil_bip_bsq_files.html">BIL-, BIP- of BSQ-bestanden openen in QGIS</a></li>
<li class="toctree-l1"><a class="reference internal" href="getting_started_with_pyqgis.html">Beginnen met programmeren in Python</a></li>
<li class="toctree-l1"><a class="reference internal" href="building_a_python_plugin.html">Een plug-in in Python bouwen</a></li>
<li class="toctree-l1"><a class="reference internal" href="custom_python_functions.html">Aangepaste Python expressie-functies gebruiken</a></li>
<li class="toctree-l1"><a class="reference internal" href="processing_python_scripts.html">Python-scripts schrijven voor framework Processing</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="">Taken voor QGIS uitvoeren en in schema zetten</a></li>
<li class="toctree-l1"><a class="reference internal" href="find_neighbor_polygons.html">Naburige polygonen in een laag zoeken</a></li>
<li class="toctree-l1"><a class="reference internal" href="performing_table_joins_pyqgis.html">Samenvoegen van tabellen uitvoeren (PyQGIS)</a></li>
<li class="toctree-l1"><a class="reference internal" href="web_mapping_with_qgis2web.html">In kaart brengen op het web met QGIS2Web</a></li>
<li class="toctree-l1"><a class="reference internal" href="creating_basemaps_with_qtiles.html">Basiskaarten maken met QTiles</a></li>
<li class="toctree-l1"><a class="reference internal" href="learning_resources.html">QGIS bronnen om te leren</a></li>
<li class="toctree-l1"><a class="reference internal" href="credits.html">Gebruik van gegevens</a></li>
</ul>
</ul>
</li>
              
            
            
              
                
  <li>
    <a href="processing_python_scripts.html" title="Previous Chapter: Python-scripts schrijven voor framework Processing"><span class="glyphicon glyphicon-chevron-left visible-sm"></span><span class="hidden-sm hidden-tablet">&laquo; Python-scripts s...</span>
    </a>
  </li>
  <li>
    <a href="find_neighbor_polygons.html" title="Next Chapter: Naburige polygonen in een laag zoeken"><span class="glyphicon glyphicon-chevron-right visible-sm"></span><span class="hidden-sm hidden-tablet">Naburige polygon... &raquo;</span>
    </a>
  </li>
              
            
            

            

            
              <li class="hidden-sm"></li>
            
          </ul>

          
            
<form class="navbar-form navbar-right" action="../search.html" method="get">
 <div class="form-group">
  <input type="text" name="q" class="form-control" placeholder="Search" />
 </div>
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
          
        </div>
    </div>
  </div>

<div class="container">
  <div class="row">
      <div class="col-md-3">
        <div id="sidebar" class="bs-sidenav" role="complementary"><h4>Author</h4>
<p>Ujaval Gandhi</p>
<a href="https://twitter.com/intent/follow?screen_name=spatialthoughts" class="twitter-follow-button" data-show-count="false">Follow @spatialthoughts</a>

<h4>Change Language</h4>
<form role="form" class="sidebar-form sidebar-left">
<select id="languages" class="form-control select-mini">
  <option value="en">English</option>
  <option value="zh_TW">Chinese (Taiwan)</option>
  <option value="nl">Dutch</option>
  <option value="fi_FI">Finnish</option>
  <option value="fr">French</option>
  <option value="de">German</option>
  <option value="el">Greek</option>
  <option value="id">Indonesian</option>
  <option value="it">Italian</option>
  <option value="ko">Korean</option>
  <option value="pt_BR">Portuguese</option>
  <option value="ro">Romanian</option>
  <option value="ru">Russian</option>
  <option value="sl">Slovenian</option>
  <option value="es">Spanish</option>
  <option value="th">Thai</option>
  <option value="tr">Turkish</option>
  <option value="uk">Ukrainian</option>
  <option value="vi">Vietnamese</option>
</select>
</form>



  


<h4>Share</h4>
<div class="addthis_sharing_toolbox"></div>
        </div>
      </div>
    <div class="col-md-9">
      

  <div class="section" id="running-and-scheduling-qgis-processing-jobs">
<h1>Taken voor QGIS uitvoeren en in schema zetten<a class="headerlink" href="#running-and-scheduling-qgis-processing-jobs" title="Permalink naar deze titel">¶</a></h1>
<p>U kunt veel van de taken in QGIS automatiseren met behulp van Python scripten (PyQGIS) en het framework Processing. Meestentijds zult u deze scripts handmatig uitvoeren terwijl QGIS is geopend. Hoewel dat nuttig is, heeft u ook vaak een manier nodig om deze taken via de opdrachtregel uit te kunnen voeren en zonder QGIS te moeten openen. Gelukkig kunt u zelfstandige scripts voor Python schrijven die bibliotheken van QGIS gebruiken en via de opdrachtregel kunnen worden uitgevoerd. In deze handleiding zullen we leren hoe een taak te schrijven en in en schema te zetten en die het framework van QGIS Processing gebruikt.</p>
<div class="section" id="overview-of-the-task">
<h2>Overzicht van de taak<a class="headerlink" href="#overview-of-the-task" title="Permalink naar deze titel">¶</a></h2>
<p>Laten we zeggen dat we werken aan enkele analyses met behulp van shapefiles van een regio. De shapefiles worden bijgewerkt op dagelijkse basis en we hebben altijd het laatste bestand nodig. Maar voordat we deze bestanden kunnen gebruiken, moeten we de gegevens opschonen. We kunnen ene taak voor QGIS instellen die dit proces automatiseert en dagelijks wordt uitgevoerd zodat u de laatste opgeschoonde shapefiles voor uw werk heeft. We zullen een zelfstandig Python=script schrijven dat een shapefile downloadt en topologische bewerkingen voor opschonen uitvoert op een dagelijkse basis.</p>
<div class="section" id="other-skills-you-will-learn">
<h3>Andere vaardigheden die u zult leren<a class="headerlink" href="#other-skills-you-will-learn" title="Permalink naar deze titel">¶</a></h3>
<ul class="simple">
<li><p class="first">Bestanden downloaden en unzippen met behulp van Python.</p>
</li>
<li><p class="first">Een algoritme van Processing uitvoeren via PyQGIS.</p>
</li>
<li><p class="first">Topologische fouten in een vectorlaag repareren.</p>
</li>
</ul>
</div>
</div>
<div class="section" id="get-the-data">
<h2>De gegevens ophalen<a class="headerlink" href="#get-the-data" title="Permalink naar deze titel">¶</a></h2>
<p><a class="reference external" href="http://www.geofabrik.de/">Geofabrik</a> verschaft dagelijks bijgewerkte shapefiles van gegevenssets van <a class="reference external" href="http://www.openstreetmap.org/">OpenStreetMap</a> .</p>
<p>We zulleen de <a class="reference external" href="http://download.geofabrik.de/australia-oceania.html">shapefiles voor Fiji</a> gebruiken voor deze oefening. Download de <a class="reference external" href="http://download.geofabrik.de/australia-oceania/fiji-latest.shp.zip">fiji-latest.shp.zip</a> en pak dat uit in een map op uw schijf.</p>
<p>Gegevensbron <a class="reference internal" href="credits.html#geofabrik" id="id1">[GEOFABRIK]</a></p>
</div>
<div class="section" id="procedure">
<h2>Procedure<a class="headerlink" href="#procedure" title="Permalink naar deze titel">¶</a></h2>
<ol class="arabic simple">
<li><p class="first">We zullen eerst door het proces van het handmatig opschonen gaan om de opdrachten te noteren die we zullen gebruiken in het script voor Python. Start QGIS en ga naar <span class="menuselection">Kaartlagen ‣ Laag toevoegen ‣ Vector laag toevoegen</span>.</p>
</li>
</ol>
<img alt="../_images/1129.png" class="align-center" src="../_images/1129.png" />
<ol class="arabic simple" start="2">
<li><p class="first">Blader naar de map die de uitgepakte shapefiles bevat en selecteer het bestand <code class="docutils literal"><span class="pre">roads.shp</span></code> en klik op <span class="guilabel">Open</span>.</p>
</li>
</ol>
<img alt="../_images/270.png" class="align-center" src="../_images/270.png" />
<ol class="arabic simple" start="3">
<li><p class="first">Eerst moeten we de laag roads opnieuw projecteren naar een Geprojecteerd CRS. Dat stelt ons in staat om <em>meters</em> als eenheden te gebruiken bij het uitvoeren van anlyses, in plaats van graden. Open <span class="menuselection">Processing ‣ Toolbox</span>.</p>
</li>
</ol>
<img alt="../_images/339.png" class="align-center" src="../_images/339.png" />
<ol class="arabic simple" start="4">
<li><p class="first">Zoek naar het gereedschap <span class="guilabel">Reproject layer</span>. Dubbelklik er op om het dialoogvenster te starten.</p>
</li>
</ol>
<img alt="../_images/429.png" class="align-center" src="../_images/429.png" />
<ol class="arabic simple" start="5">
<li><p class="first">Selecteer, in het dialoogvenster <span class="guilabel">Reproject layer</span>, de laag <code class="docutils literal"><span class="pre">roads</span></code> als <span class="guilabel">Input layer</span>. We zullen CRS <code class="docutils literal"><span class="pre">EPSG:3460</span> <span class="pre">Fiji</span> <span class="pre">1986</span> <span class="pre">/</span> <span class="pre">Fiji</span> <span class="pre">Map</span> <span class="pre">Grid</span></code> gebruiken als het <span class="guilabel">Target CRS</span>. Klik op <span class="guilabel">Run</span>.</p>
</li>
</ol>
<img alt="../_images/530.png" class="align-center" src="../_images/530.png" />
<ol class="arabic simple" start="6">
<li><p class="first">Als het proces eenmaal is voltooid, zult u de  opnieuw geprojecteerde laag zien geladen in QGIS. Ga naar <span class="menuselection">Processing ‣ Historie..</span>.</p>
</li>
</ol>
<img alt="../_images/628.png" class="align-center" src="../_images/628.png" />
<ol class="arabic simple" start="7">
<li><p class="first">Vergroot, in het dialoogvenster <span class="guilabel">Historie</span>, de map <span class="guilabel">ALGORITHM</span> en selecteer het laatste item. U zult de volledige opdracht voor Processing in het onderste paneel zien staan. Noteer deze opdracht om in ons script te gebruiken.</p>
</li>
</ol>
<img alt="../_images/727.png" class="align-center" src="../_images/727.png" />
<ol class="arabic simple" start="8">
<li><p class="first">Klik, terug in het hoofdvenster van QGIS, op de knop <span class="guilabel">CRS</span> in de rechter benedenhoek.</p>
</li>
</ol>
<img alt="../_images/826.png" class="align-center" src="../_images/826.png" />
<ol class="arabic simple" start="9">
<li><p class="first">In het dialoogvenster <span class="guilabel">Projecteigenschappen | CRS</span>, selecteer <span class="guilabel">Gelijjktijdige CRS-transformatie gebruiken</span> en selecteer <code class="docutils literal"><span class="pre">EPSG:3460</span> <span class="pre">Fiji</span> <span class="pre">1986</span> <span class="pre">/</span> <span class="pre">Fiji</span> <span class="pre">Map</span> <span class="pre">Grid</span></code> als het CRS. Dit zal er voor zorgen dat onze originele en opnieuw geprojecteerde lagen juist uit zullen lijn.</p>
</li>
</ol>
<img alt="../_images/924.png" class="align-center" src="../_images/924.png" />
<ol class="arabic simple" start="10">
<li><p class="first">Nu zullen we de bewerking voor het opschonen uitvoeren. GRASS heeft een zeer krachtige verzameling topologische gereedschappen voor opschonen. Deze zijn in QGIS beschikbaar via het algoritme <code class="docutils literal"><span class="pre">v.clean</span></code>. Zoek naar dit algoritme in de <span class="guilabel">Processing Toolbox</span> en dubbelklik er op om het dialoogvenster te starten.</p>
</li>
</ol>
<img alt="../_images/1025.png" class="align-center" src="../_images/1025.png" />
<ol class="arabic simple" start="11">
<li><p class="first">U kunt meer te weten komen over de verschillende gereedschappen en opties op de tab <span class="guilabel">Help</span>. Voor deze handleiding zullen we het gereedschap <code class="docutils literal"><span class="pre">snap</span></code> gebruiken om duplicaat-punten te verwijderen die binnen 1 meter van elkaar liggen. Selecteer de`` laag Opnieuw geprojecteerd`` als de <span class="guilabel">Layer to clean</span>. Kies <code class="docutils literal"><span class="pre">snap</span></code> als de <span class="guilabel">Cleaning tool</span>.  Voer <code class="docutils literal"><span class="pre">1.00</span></code> als de <span class="guilabel">Threshold</span>. Laat de andere velden leeg en klik op <span class="guilabel">Run</span>.</p>
</li>
</ol>
<img alt="../_images/1130.png" class="align-center" src="../_images/1130.png" />
<ol class="arabic simple" start="12">
<li><p class="first">Als de verwerking eenmaal is voltooid zult u 2 nieuwe lagen zien toegevoegd aan QGIS. De laag <code class="docutils literal"><span class="pre">Cleaned</span> <span class="pre">vector</span></code> is de laag met gecorrigeerde topologische fouten. U zult ook een laag <code class="docutils literal"><span class="pre">Errors</span></code> hebben waarin de objecten zijn geaccentueerd die zijn gerepareerd. U kunt de laag met fouten als richtlijn nemen en inzoomen op de punten die werden verwijderd.</p>
</li>
</ol>
<img alt="../_images/1226.png" class="align-center" src="../_images/1226.png" />
<ol class="arabic simple" start="13">
<li><p class="first">Ga naar het dialoogvenster <span class="menuselection">Processing ‣ Geschiedenis</span> en noteeer de volledige opdracht voor Processing voor later gebruik.</p>
</li>
</ol>
<img alt="../_images/1323.png" class="align-center" src="../_images/1323.png" />
<ol class="arabic simple" start="14">
<li><p class="first">We zijn nu klaar om te beginnen met coderen. Bekijk het gedeelte <strong>Een tekstbewerker of een Python IDE</strong> in de handleiding <a class="reference internal" href="building_a_python_plugin.html"><em>Een plug-in in Python bouwen</em></a> voor instructies om uw tekstbewerker of IDE in te stellen. Voor het uitvoeren van zelfstandige scripts in Python die QGIS gebruiken, moeten we verschillende opties voor configuratie instellen. Een goede manier om zelfstandige scripts uit te voeren is om ze te starten via een <code class="docutils literal"><span class="pre">.bat</span></code>-bestand. Dat bestand zal eerst de juiste opties voor configuratie instellen en dan het script van Python aanroepen. Maak een nieuw bestand genaamd <code class="docutils literal"><span class="pre">launch.bat</span></code> en voer de volgende tekst in. Wijzig de waarden overeenkomstig uw configuratie voor QGIS. Vergeet niet de gebruikersnaam te vervangen door uw eigen gebruikersnaam in het pad naar het script van Python. De paden in dit bestand zullen hetzelfde zijn op uw systeem indien u QGIS installeerde via de <code class="docutils literal"><span class="pre">OSGeo4W</span> <span class="pre">Installer</span></code>. Sla het bestand op op uw bureaublad.</p>
</li>
</ol>
<div class="admonition note">
<p class="first admonition-title">Notitie</p>
<p class="last">Linux- en Mac-gebruikers dienen een shell-script te maken om de variabelen voor paden en omgeving in te stellen.</p>
</div>
<div class="highlight-none"><div class="highlight"><pre>REM Change OSGEO4W_ROOT to point to the base install folder
SET OSGEO4W_ROOT=C:\OSGeo4W64
SET QGISNAME=qgis
SET QGIS=%OSGEO4W_ROOT%\apps\%QGISNAME%
set QGIS_PREFIX_PATH=%QGIS%
REM Gdal Setup
set GDAL_DATA=%OSGEO4W_ROOT%\share\gdal\
REM Python Setup
set PATH=%OSGEO4W_ROOT%\bin;%QGIS%\bin;%PATH%
SET PYTHONHOME=%OSGEO4W_ROOT%\apps\Python27
set PYTHONPATH=%QGIS%\python;%PYTHONPATH%

REM Launch python job
python c:\Users\Ujaval\Desktop\download_and_clean.py
pause
</pre></div>
</div>
<img alt="../_images/1422.png" class="align-center" src="../_images/1422.png" />
<ol class="arabic simple" start="15">
<li><p class="first">maak een nieuw Python-bestand en voer de volgende code in. Noem het bestand <code class="docutils literal"><span class="pre">download_and_clean.py</span></code> en sla het op op uw bureaublad.</p>
</li>
</ol>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">qgis.core</span> <span class="kn">import</span> <span class="o">*</span>
<span class="k">print</span> <span class="s">&#39;Hello QGIS!&#39;</span>
</pre></div>
</div>
<img alt="../_images/1521.png" class="align-center" src="../_images/1521.png" />
<ol class="arabic simple" start="16">
<li><p class="first">Schakel over naar uw bureaublad en zoek naar het pictogram van het bestand <code class="docutils literal"><span class="pre">launch.bat</span></code>. Dubbelklik er op om een nieuw scherm voor de opdrachtregel te starten en voer het script uit. Als u in het scherm van de opdrachtregel ziet afgedrukt <code class="docutils literal"><span class="pre">Hello</span> <span class="pre">QGIS!</span></code>, zijn uw configuratie en instellingen juist ingesteld. Als u fouten ziet of de tekst niet ziet, controleer dan uw bestand <code class="docutils literal"><span class="pre">launch.bat</span></code> en zorg er voor dat alle paden overeenkomen met de locaties op uw systeem.</p>
</li>
</ol>
<img alt="../_images/1620.png" class="align-center" src="../_images/1620.png" />
<ol class="arabic simple" start="17">
<li><p class="first">Terug in uw tekstbewerker, pas het script <code class="docutils literal"><span class="pre">download_and_clean.py</span></code> aan door de volgende code toe te voegen. Dit is de bootstrap-code om QGIS te initialiseren. Deze zijn overbodig als u het script binnen QGIS uitvoert. Maar omdat we het buiten QGIS uitvoeren, moeten we deze aan het begin toevoegen. Zorg er voor dat u de gebruikersnaam vervangt door uw eigen gebruikersnaam. Sla, na het maken van deze wijzigingen, het ebstand op en voer <code class="docutils literal"><span class="pre">launch.bat</span></code> opnieuw uit. Als u <code class="docutils literal"><span class="pre">Hello</span> <span class="pre">QGIS!</span></code> ziet afgedrukt, is alles ingesteld om de logica voor Processing toe te voegen aan het script.</p>
</li>
</ol>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">import</span> <span class="nn">sys</span>
<span class="kn">from</span> <span class="nn">qgis.core</span> <span class="kn">import</span> <span class="o">*</span>

<span class="c"># Initialize QGIS Application</span>
<span class="n">QgsApplication</span><span class="o">.</span><span class="n">setPrefixPath</span><span class="p">(</span><span class="s">&quot;C:</span><span class="se">\\</span><span class="s">OSGeo4W64</span><span class="se">\\</span><span class="s">apps</span><span class="se">\\</span><span class="s">qgis&quot;</span><span class="p">,</span> <span class="bp">True</span><span class="p">)</span>
<span class="n">app</span> <span class="o">=</span> <span class="n">QgsApplication</span><span class="p">([],</span> <span class="bp">True</span><span class="p">)</span>
<span class="n">QgsApplication</span><span class="o">.</span><span class="n">initQgis</span><span class="p">()</span>

<span class="c"># Add the path to Processing framework</span>
<span class="n">sys</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s">&#39;c:</span><span class="se">\\</span><span class="s">Users</span><span class="se">\\</span><span class="s">Ujaval</span><span class="se">\\</span><span class="s">.qgis2</span><span class="se">\\</span><span class="s">python</span><span class="se">\\</span><span class="s">plugins&#39;</span><span class="p">)</span>

<span class="c"># Import and initialize Processing framework</span>
<span class="kn">from</span> <span class="nn">processing.core.Processing</span> <span class="kn">import</span> <span class="n">Processing</span>
<span class="n">Processing</span><span class="o">.</span><span class="n">initialize</span><span class="p">()</span>
<span class="kn">import</span> <span class="nn">processing</span>

<span class="k">print</span> <span class="s">&#39;Hello QGIS!&#39;</span>
</pre></div>
</div>
<img alt="../_images/1719.png" class="align-center" src="../_images/1719.png" />
<ol class="arabic simple" start="18">
<li><p class="first">herinnert u zich nog de eerste opdracht voor Processing die we hebben opgeslagen vanuit het log? Dat was de opdracht om de laag opnieuw te projecteren. Plak de opdracht in uw script en voeg de omringende code als volgt toe. Onthoud dat de opdrachten voor Processing het pad naar de uitvoerlaag teruggeven als een woordenboek. We zullen dat opslaan als de waarde <code class="docutils literal"><span class="pre">ret</span></code> en het pad naar de opnieuw geprojecteerde laag afdrukken.</p>
</li>
</ol>
<div class="highlight-python"><div class="highlight"><pre><span class="n">roads_shp_path</span> <span class="o">=</span> <span class="s">&quot;C:</span><span class="se">\\</span><span class="s">Users</span><span class="se">\\</span><span class="s">Ujaval</span><span class="se">\\</span><span class="s">Downloads</span><span class="se">\\</span><span class="s">fiji-latest.shp</span><span class="se">\\</span><span class="s">roads.shp&quot;</span>
<span class="n">ret</span> <span class="o">=</span> <span class="n">processing</span><span class="o">.</span><span class="n">runalg</span><span class="p">(</span><span class="s">&#39;qgis:reprojectlayer&#39;</span><span class="p">,</span> <span class="n">roads_shp_path</span><span class="p">,</span> <span class="s">&#39;EPSG:3460&#39;</span><span class="p">,</span>
<span class="bp">None</span><span class="p">)</span>
<span class="n">output</span> <span class="o">=</span> <span class="n">ret</span><span class="p">[</span><span class="s">&#39;OUTPUT&#39;</span><span class="p">]</span>
<span class="k">print</span> <span class="n">output</span>
</pre></div>
</div>
<img alt="../_images/1819.png" class="align-center" src="../_images/1819.png" />
<ol class="arabic simple" start="19">
<li><p class="first">Voer het script uit via <code class="docutils literal"><span class="pre">launch.bat</span></code> en u zult het pad zien naar de nieuw gemaakte laag Opnieuw geprojecteerd.</p>
</li>
</ol>
<img alt="../_images/1917.png" class="align-center" src="../_images/1917.png" />
<ol class="arabic simple" start="20">
<li><p class="first">Voeg nu de code toe voor het opschonen van de topologie. Omdat dit onze uiteindelijke uitvoer is, zullen we de paden voor de uitvoerbestanden als de laatste 2 argumenten vermelden voor het algoritme <code class="docutils literal"><span class="pre">grass.v.clean</span></code>. Als u deze leeg laat zal de uitvoer worden gemaakt in een tijdelijke map.</p>
</li>
</ol>
<div class="highlight-python"><div class="highlight"><pre><span class="n">processing</span><span class="o">.</span><span class="n">runalg</span><span class="p">(</span><span class="s">&quot;grass:v.clean&quot;</span><span class="p">,</span>
                  <span class="n">output</span><span class="p">,</span>
                  <span class="mi">1</span><span class="p">,</span>
                  <span class="mi">1</span><span class="p">,</span>
                  <span class="bp">None</span><span class="p">,</span>
                  <span class="o">-</span><span class="mi">1</span><span class="p">,</span>
                  <span class="mf">0.0001</span><span class="p">,</span>
                  <span class="s">&#39;C:</span><span class="se">\\</span><span class="s">Users</span><span class="se">\\</span><span class="s">Ujaval</span><span class="se">\\</span><span class="s">Desktop</span><span class="se">\\</span><span class="s">clean.shp&#39;</span><span class="p">,</span>
                  <span class="s">&#39;C:\Users</span><span class="se">\\</span><span class="s">Ujaval</span><span class="se">\\</span><span class="s">Desktop</span><span class="se">\\</span><span class="s">errors.shp&#39;</span><span class="p">)</span>
</pre></div>
</div>
<img alt="../_images/2014.png" class="align-center" src="../_images/2014.png" />
<ol class="arabic simple" start="21">
<li><p class="first">Voer het script uit en u zult 2 nieuwe shapefiles zien gemaakt op uw Bureaublad. Dit voltooid het gedeelte ven Processing van het script. Laten we de code toevoegen voor het downloaden van de gegevens van de originele website en die automatisch laten unzippen. We zullen ook het pad naar het uitgepakte bestand opslaan als een variabele die we later kunnen doorgeven aan het algoritme van Processing. We zullen enkele aanvullende modules moeten importeren om dit te kunnen doen. (Bekijk het einde van de handleiding voor het volledige script met alle wijzigingen)</p>
</li>
</ol>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">urllib</span>
<span class="kn">import</span> <span class="nn">zipfile</span>
<span class="kn">import</span> <span class="nn">tempfile</span>

<span class="n">temp_dir</span> <span class="o">=</span> <span class="n">tempfile</span><span class="o">.</span><span class="n">mkdtemp</span><span class="p">()</span>
<span class="n">download_url</span> <span class="o">=</span> <span class="s">&#39;http://download.geofabrik.de/australia-oceania/fiji-latest.shp.zip&#39;</span>
<span class="k">print</span> <span class="s">&#39;Downloading file&#39;</span>
<span class="nb">zip</span><span class="p">,</span> <span class="n">headers</span> <span class="o">=</span> <span class="n">urllib</span><span class="o">.</span><span class="n">urlretrieve</span><span class="p">(</span><span class="n">download_url</span><span class="p">)</span>
<span class="k">with</span> <span class="n">zipfile</span><span class="o">.</span><span class="n">ZipFile</span><span class="p">(</span><span class="nb">zip</span><span class="p">)</span> <span class="k">as</span> <span class="n">zf</span><span class="p">:</span>
    <span class="n">files</span> <span class="o">=</span> <span class="n">zf</span><span class="o">.</span><span class="n">namelist</span><span class="p">()</span>
    <span class="k">for</span> <span class="n">filename</span> <span class="ow">in</span> <span class="n">files</span><span class="p">:</span>
        <span class="k">if</span> <span class="s">&#39;roads&#39;</span> <span class="ow">in</span> <span class="n">filename</span><span class="p">:</span>
            <span class="n">file_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">temp_dir</span><span class="p">,</span> <span class="n">filename</span><span class="p">)</span>
            <span class="n">f</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">file_path</span><span class="p">,</span> <span class="s">&#39;wb&#39;</span><span class="p">)</span>
            <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">zf</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="n">filename</span><span class="p">))</span>
            <span class="n">f</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
            <span class="k">if</span> <span class="n">filename</span> <span class="o">==</span> <span class="s">&#39;roads.shp&#39;</span><span class="p">:</span>
                <span class="n">roads_shp_path</span> <span class="o">=</span> <span class="n">file_path</span>
</pre></div>
</div>
<img alt="../_images/2118.png" class="align-center" src="../_images/2118.png" />
<ol class="arabic simple" start="22">
<li><p class="first">Voer het complete script uit. Elke keer als u het script uitvoert wordt een verse kopie van de gegevens gedownload en verwerkt.</p>
</li>
</ol>
<img alt="../_images/2217.png" class="align-center" src="../_images/2217.png" />
<ol class="arabic simple" start="23">
<li><p class="first">We kunnen de <code class="docutils literal"><span class="pre">Taakplanner</span></code> in Windows gebruiken om het uitvoeren van dit script op een dagelijkse basis te automatiseren. Start de Taakplanner en klik op <span class="guilabel">Basistaak maken</span>.</p>
</li>
</ol>
<div class="admonition note">
<p class="first admonition-title">Notitie</p>
<p class="last">Linux- en Mac-gebruikers kunnen cron jobs gebruiken om taken te plannen.</p>
</div>
<img alt="../_images/2314.png" class="align-center" src="../_images/2314.png" />
<ol class="arabic simple" start="24">
<li><p class="first">Noem de taak <code class="docutils literal"><span class="pre">Dagelijkse</span> <span class="pre">download</span> <span class="pre">en</span> <span class="pre">opschonen</span></code> en klik op <span class="guilabel">Volgende</span>.</p>
</li>
</ol>
<img alt="../_images/2412.png" class="align-center" src="../_images/2412.png" />
<ol class="arabic simple" start="25">
<li><p class="first">Selecteer <code class="docutils literal"><span class="pre">Dagelijks</span></code> als de <span class="guilabel">Taaktrigger</span> en klik op <span class="guilabel">Volgende</span></p>
</li>
</ol>
<img alt="../_images/2511.png" class="align-center" src="../_images/2511.png" />
<ol class="arabic simple" start="26">
<li><p class="first">Selecteer een tijdstip naar keuze en klik op <span class="guilabel">Volgende</span>.</p>
</li>
</ol>
<img alt="../_images/2610.png" class="align-center" src="../_images/2610.png" />
<ol class="arabic simple" start="27">
<li><p class="first">Kies <code class="docutils literal"><span class="pre">Een</span> <span class="pre">programma</span> <span class="pre">starten</span></code> als de <span class="guilabel">Actie</span> en klik op <span class="guilabel">Volgende</span>.</p>
</li>
</ol>
<img alt="../_images/278.png" class="align-center" src="../_images/278.png" />
<ol class="arabic simple" start="28">
<li><p class="first">Klik op <span class="guilabel">Bladeren</span> en zoek naar het script <code class="docutils literal"><span class="pre">launch.bat</span></code>. Klik op <span class="guilabel">Volgende</span>.</p>
</li>
</ol>
<img alt="../_images/286.png" class="align-center" src="../_images/286.png" />
<ol class="arabic simple" start="29">
<li><p class="first">Klik op <span class="guilabel">Voltooien</span> in het laatste scherm om de taak te plannen. Nu zal het script automatisch starten op de gespecificeerde tijd om u elke dag een verse kopie van opgeschoonde gegevens te geven.</p>
</li>
</ol>
<img alt="../_images/295.png" class="align-center" src="../_images/295.png" />
<p>Hieronder staat het volledige script <code class="docutils literal"><span class="pre">download_and_clean.py</span></code> ter verwijzing.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">import</span> <span class="nn">sys</span>
<span class="kn">from</span> <span class="nn">qgis.core</span> <span class="kn">import</span> <span class="o">*</span>

<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">urllib</span>
<span class="kn">import</span> <span class="nn">zipfile</span>
<span class="kn">import</span> <span class="nn">tempfile</span>

<span class="c"># Initialize QGIS Application</span>
<span class="n">QgsApplication</span><span class="o">.</span><span class="n">setPrefixPath</span><span class="p">(</span><span class="s">&quot;C:</span><span class="se">\\</span><span class="s">OSGeo4W64</span><span class="se">\\</span><span class="s">apps</span><span class="se">\\</span><span class="s">qgis&quot;</span><span class="p">,</span> <span class="bp">True</span><span class="p">)</span>
<span class="n">app</span> <span class="o">=</span> <span class="n">QgsApplication</span><span class="p">([],</span> <span class="bp">True</span><span class="p">)</span>
<span class="n">QgsApplication</span><span class="o">.</span><span class="n">initQgis</span><span class="p">()</span>

<span class="c"># Add the path to Processing framework  </span>
<span class="n">sys</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s">&#39;c:</span><span class="se">\\</span><span class="s">Users</span><span class="se">\\</span><span class="s">Ujaval</span><span class="se">\\</span><span class="s">.qgis2</span><span class="se">\\</span><span class="s">python</span><span class="se">\\</span><span class="s">plugins&#39;</span><span class="p">)</span>

<span class="c"># Import and initialize Processing framework</span>
<span class="kn">from</span> <span class="nn">processing.core.Processing</span> <span class="kn">import</span> <span class="n">Processing</span>
<span class="n">Processing</span><span class="o">.</span><span class="n">initialize</span><span class="p">()</span>
<span class="kn">import</span> <span class="nn">processing</span>

<span class="c"># Download and unzip the latest shapefile</span>
<span class="n">temp_dir</span> <span class="o">=</span> <span class="n">tempfile</span><span class="o">.</span><span class="n">mkdtemp</span><span class="p">()</span>
<span class="n">download_url</span> <span class="o">=</span> <span class="s">&#39;http://download.geofabrik.de/australia-oceania/fiji-latest.shp.zip&#39;</span>
<span class="k">print</span> <span class="s">&#39;Downloading file&#39;</span>
<span class="nb">zip</span><span class="p">,</span> <span class="n">headers</span> <span class="o">=</span> <span class="n">urllib</span><span class="o">.</span><span class="n">urlretrieve</span><span class="p">(</span><span class="n">download_url</span><span class="p">)</span>
<span class="k">with</span> <span class="n">zipfile</span><span class="o">.</span><span class="n">ZipFile</span><span class="p">(</span><span class="nb">zip</span><span class="p">)</span> <span class="k">as</span> <span class="n">zf</span><span class="p">:</span>
    <span class="n">files</span> <span class="o">=</span> <span class="n">zf</span><span class="o">.</span><span class="n">namelist</span><span class="p">()</span>
    <span class="k">for</span> <span class="n">filename</span> <span class="ow">in</span> <span class="n">files</span><span class="p">:</span>
        <span class="k">if</span> <span class="s">&#39;roads&#39;</span> <span class="ow">in</span> <span class="n">filename</span><span class="p">:</span>
            <span class="n">file_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">temp_dir</span><span class="p">,</span> <span class="n">filename</span><span class="p">)</span>
            <span class="n">f</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">file_path</span><span class="p">,</span> <span class="s">&#39;wb&#39;</span><span class="p">)</span>
            <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">zf</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="n">filename</span><span class="p">))</span>
            <span class="n">f</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
            <span class="k">if</span> <span class="n">filename</span> <span class="o">==</span> <span class="s">&#39;roads.shp&#39;</span><span class="p">:</span>
                <span class="n">roads_shp_path</span> <span class="o">=</span> <span class="n">file_path</span>

<span class="k">print</span> <span class="s">&#39;Downloaded file to </span><span class="si">%s</span><span class="s">&#39;</span> <span class="o">%</span> <span class="n">roads_shp_path</span>

<span class="c"># Reproject the Roads layer</span>
<span class="k">print</span> <span class="s">&#39;Reprojecting the roads layer&#39;</span>

<span class="n">ret</span> <span class="o">=</span> <span class="n">processing</span><span class="o">.</span><span class="n">runalg</span><span class="p">(</span><span class="s">&#39;qgis:reprojectlayer&#39;</span><span class="p">,</span> <span class="n">roads_shp_path</span><span class="p">,</span> <span class="s">&#39;EPSG:3460&#39;</span><span class="p">,</span> <span class="bp">None</span><span class="p">)</span>
<span class="n">output</span> <span class="o">=</span> <span class="n">ret</span><span class="p">[</span><span class="s">&#39;OUTPUT&#39;</span><span class="p">]</span>

<span class="c"># Clean the Roads layer</span>
<span class="k">print</span> <span class="s">&#39;Cleaning the roads layer&#39;</span>

<span class="n">processing</span><span class="o">.</span><span class="n">runalg</span><span class="p">(</span><span class="s">&quot;grass:v.clean&quot;</span><span class="p">,</span>
                  <span class="n">output</span><span class="p">,</span>
                  <span class="mi">1</span><span class="p">,</span>
                  <span class="mi">1</span><span class="p">,</span>
                  <span class="bp">None</span><span class="p">,</span>
                  <span class="o">-</span><span class="mi">1</span><span class="p">,</span>
                  <span class="mf">0.0001</span><span class="p">,</span>
                  <span class="s">&#39;C:</span><span class="se">\\</span><span class="s">Users</span><span class="se">\\</span><span class="s">Ujaval</span><span class="se">\\</span><span class="s">Desktop</span><span class="se">\\</span><span class="s">clean.shp&#39;</span><span class="p">,</span>
                  <span class="s">&#39;C:\Users</span><span class="se">\\</span><span class="s">Ujaval</span><span class="se">\\</span><span class="s">Desktop</span><span class="se">\\</span><span class="s">errors.shp&#39;</span><span class="p">)</span>
<span class="k">print</span> <span class="s">&#39;Success&#39;</span>
</pre></div>
</div>
</div>
</div>





  <div id="disqus_thread"></div>
  <noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
  <a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>


    </div>
      
  </div>
</div>

<footer class="footer">
  <div class="container">
    <p class="pull-right">
      <a href="#">Back to top</a>
      
    </p>
    <p>
        &copy; Copyright 2016, Ujaval Gandhi.<br/>
      Laatste aanpassing op Feb 21, 2017.<br/>
      Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 1.3.6.<br/>
    </p>
  </div>
</footer>
<div class="container">
  <p>This work is licensed under a <a href="http://creativecommons.org/licenses/by/4.0/deed.en_US">Creative Commons Attribution 4.0 International License</a></p>
</div>
<!-- Twitter Button -->
<script>!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0],p=/^http:/.test(d.location)?'http':'https';if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src=p+'://platform.twitter.com/widgets.js';fjs.parentNode.insertBefore(js,fjs);}}(document, 'script', 'twitter-wjs');</script>

<!-- Disqus comments widget -->
<script type="text/javascript">
  /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
  var disqus_shortname = 'qgistutorials'; // required: replace example with your forum shortname
  /* * * DON'T EDIT BELOW THIS LINE * * */
  (function () {
    var s = document.createElement('script'); s.async = true;
    s.type = 'text/javascript';
    s.src = '//' + disqus_shortname + '.disqus.com/count.js';
    (document.getElementsByTagName('HEAD')[0] || document.getElementsByTagName('BODY')[0]).appendChild(s);
  }());
</script>

<script type="text/javascript">
  /* * * DON'T EDIT BELOW THIS LINE * * */
  (function() {
    var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
    dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
    (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
  })();
</script>

<!-- Go to www.addthis.com/dashboard to customize your tools -->
<script type="text/javascript" src="//s7.addthis.com/js/300/addthis_widget.js#pubid=spatialthoughts" async="async"></script>

<!-- Script fpr language switching. Largely adapted from https://github.com/pcav/faunalia-website -->
<script>
    var currentPage = 'docs/running_qgis_jobs.html'; // coming from sphinx, always without starting '/'
    var currentLang = 'en';
    $(document).ready(function(){

        var search = new RegExp('\/[a-zA-Z_]{2,8}\/'+ currentPage, 'gi');
        var langPlusPage = window.location.href.match(search);
        // it's possible this is a index.html page called without 'index.html', try without the currentPage
        if (langPlusPage==undefined){
            search = new RegExp('\/[a-zA-Z_]{2,8}\/$', 'gi');
            langPlusPage = window.location.href.match(search);
        }

        // it's possible this is an index.html page called without 'index.html', try removing index.html
        if (langPlusPage==undefined){
            currentPage = currentPage.replace('index.html','')
            search = new RegExp('\/[a-zA-Z_]{2,8}\/'+ currentPage, 'gi');
            langPlusPage = window.location.href.match(search);
        }
        // still no langPlugPage: stop, because the language swicher will misbehave 

        if (langPlusPage == undefined || langPlusPage.length != 1){
            alert('You hit an error, please report back to us.');
            return;
        }
        langPlusPage = langPlusPage[0];
        currentLang = langPlusPage.replace(currentPage, '');

        $("#languages").val(currentLang.replace(/\//g,'')); // currentLang is something like '/nl/'

        $("#languages").change(function() {
            gotoLang($(this).val());
        });

    });

    // load current page in a different language
    function gotoLang(lang){
        var currentUrl = window.location.href;
        var newUrl = currentUrl.replace(currentLang, '/'+lang+'/');
        window.location.href = newUrl;
    }
</script>

  </body>
</html>