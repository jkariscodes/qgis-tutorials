<!DOCTYPE html>


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Performing Spatial Queries (QGIS3) &mdash; QGIS Tutorials and Tips</title>
    
    <link rel="stylesheet" href="../../_static/basic.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/bootswatch-3.2.0/united/bootstrap.min.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/bootstrap-sphinx.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../../',
        VERSION:     '1',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../_static/doctools.js"></script>
    <script type="text/javascript" src="../../_static/js/jquery-1.11.0.min.js"></script>
    <script type="text/javascript" src="../../_static/js/jquery-fix.js"></script>
    <script type="text/javascript" src="../../_static/bootstrap-3.2.0/js/bootstrap.min.js"></script>
    <script type="text/javascript" src="../../_static/bootstrap-sphinx.js"></script>
    <link rel="top" title="QGIS Tutorials and Tips" href="../../index.html" />
    <link rel="next" title="Nearest Neighbor Analysis (QGIS3)" href="nearest_neighbor_analysis.html" />
    <link rel="prev" title="Creating Heatmaps (QGIS3)" href="creating_heatmaps.html" />

<meta charset='utf-8'>
<meta http-equiv='X-UA-Compatible' content='IE=edge,chrome=1'>
<meta name='viewport' content='width=device-width, initial-scale=1.0, maximum-scale=1'>
<meta name="apple-mobile-web-app-capable" content="yes">

<!-- Google Analytics -->
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-690672-13', 'qgistutorials.com');
  ga('require', 'displayfeatures');
  ga('send', 'pageview');
</script>


  </head>
  <body role="document">

  <div id="navbar" class="navbar navbar-default navbar-fixed-top">
    <div class="container">
      <div class="navbar-header">
        <!-- .btn-navbar is used as the toggle for collapsed navbar content -->
        <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".nav-collapse">
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>
        <a class="navbar-brand" href="../../index.html"><img src="../../_static/logo.png">
          QGIS Tutorials and Tips</a>
        <span class="navbar-text navbar-version pull-left"><b>v1.0</b></span>
      </div>

        <div class="collapse navbar-collapse nav-collapse">
          <ul class="nav navbar-nav">
            
            
              <li class="dropdown globaltoc-container">
  <a role="button"
     id="dLabelGlobalToc"
     data-toggle="dropdown"
     data-target="#"
     href="../../index.html">Tutorials List <b class="caret"></b></a>
  <ul class="dropdown-menu globaltoc"
      role="menu"
      aria-labelledby="dLabelGlobalToc"><ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../introduction.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="making_a_map.html">Making a Map (QGIS3)</a></li>
<li class="toctree-l1"><a class="reference internal" href="working_with_attributes.html">Working with Attributes (QGIS3)</a></li>
<li class="toctree-l1"><a class="reference internal" href="importing_spreadsheets_csv.html">Importing Spreadsheets or CSV files (QGIS3)</a></li>
<li class="toctree-l1"><a class="reference internal" href="basic_vector_styling.html">Basic Vector Styling (QGIS3)</a></li>
<li class="toctree-l1"><a class="reference internal" href="calculating_line_lengths.html">Calculating Line Lengths and Statistics (QGIS3)</a></li>
<li class="toctree-l1"><a class="reference internal" href="raster_styling_and_analysis.html">Basic Raster Styling and Analysis (QGIS3)</a></li>
<li class="toctree-l1"><a class="reference internal" href="raster_mosaicing_and_clipping.html">Raster Mosaicing and Clipping (QGIS3)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../working_with_terrain.html">Working with Terrain Data</a></li>
<li class="toctree-l1"><a class="reference internal" href="../working_with_wms.html">Working with WMS Data</a></li>
<li class="toctree-l1"><a class="reference internal" href="../working_with_projections.html">Working with Projections</a></li>
<li class="toctree-l1"><a class="reference internal" href="georeferencing_basics.html">Georeferencing Topo Sheets and Scanned Maps (QGIS3)</a></li>
<li class="toctree-l1"><a class="reference internal" href="advanced_georeferencing.html">Georeferencing Aerial Imagery (QGIS3)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../digitizing_basics.html">Digitizing Map Data</a></li>
<li class="toctree-l1"><a class="reference internal" href="performing_table_joins.html">Performing Table Joins (QGIS3)</a></li>
<li class="toctree-l1"><a class="reference internal" href="performing_spatial_joins.html">Performing Spatial Joins (QGIS3)</a></li>
<li class="toctree-l1"><a class="reference internal" href="creating_heatmaps.html">Creating Heatmaps (QGIS3)</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="">Performing Spatial Queries (QGIS3)</a></li>
<li class="toctree-l1"><a class="reference internal" href="nearest_neighbor_analysis.html">Nearest Neighbor Analysis (QGIS3)</a></li>
<li class="toctree-l1"><a class="reference internal" href="sampling_raster_data.html">Sampling Raster Data using Points or Polygons (QGIS3)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../interpolating_point_data.html">Interpolating Point Data</a></li>
<li class="toctree-l1"><a class="reference internal" href="batch_processing.html">Batch Processing using Processing Framework (QGIS3)</a></li>
<li class="toctree-l1"><a class="reference internal" href="processing_graphical_modeler.html">Automating Complex Workflows using Processing Modeler (QGIS3)</a></li>
<li class="toctree-l1"><a class="reference internal" href="automating_map_creation.html">Automating Map Creation with Print Layout Atlas (QGIS3)</a></li>
<li class="toctree-l1"><a class="reference internal" href="basic_network_analysis.html">Basic Network Visualization and Routing (QGIS3)</a></li>
<li class="toctree-l1"><a class="reference internal" href="origin_destination_matrix.html">Locating Nearest Facility with Origin-Destination Matrix (QGIS3)</a></li>
<li class="toctree-l1"><a class="reference internal" href="service_area_analysis.html">Service Area Analysis using Openrouteservice (QGIS3)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../using_qgis_browser.html">Using the QGIS Browser</a></li>
<li class="toctree-l1"><a class="reference internal" href="../open_bil_bip_bsq_files.html">Open BIL, BIP or BSQ files in QGIS</a></li>
<li class="toctree-l1"><a class="reference internal" href="getting_started_with_pyqgis.html">Getting Started With Python Programming (QGIS3)</a></li>
<li class="toctree-l1"><a class="reference internal" href="processing_algorithms_pyqgis.html">Running Processing Algorithms via Python (QGIS3)</a></li>
<li class="toctree-l1"><a class="reference internal" href="building_a_python_plugin.html">Building a Python Plugin (QGIS3)</a></li>
<li class="toctree-l1"><a class="reference internal" href="processing_python_plugin.html">Building a Processing Plugin (QGIS3)</a></li>
<li class="toctree-l1"><a class="reference internal" href="custom_python_functions.html">Using Custom Python Expression Functions (QGIS3)</a></li>
<li class="toctree-l1"><a class="reference internal" href="processing_python_scripts.html">Writing Python Scripts for Processing Framework (QGIS3)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../running_qgis_jobs.html">Running and Scheduling QGIS Processing Jobs</a></li>
<li class="toctree-l1"><a class="reference internal" href="../performing_table_joins_pyqgis.html">Performing Table Joins (PyQGIS)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../web_mapping_with_qgis2web.html">Web Mapping with QGIS2Web</a></li>
<li class="toctree-l1"><a class="reference internal" href="../creating_basemaps_with_qtiles.html">Creating Basemaps with QTiles</a></li>
<li class="toctree-l1"><a class="reference internal" href="../using_plugins.html">Using Plugins</a></li>
<li class="toctree-l1"><a class="reference internal" href="../downloading_osm_data.html">Searching and Downloading OpenStreetMap Data</a></li>
<li class="toctree-l1"><a class="reference internal" href="../learning_resources.html">QGIS Learning Resources</a></li>
<li class="toctree-l1"><a class="reference internal" href="../credits.html">Data Credits</a></li>
<li class="toctree-l1"><a class="reference internal" href="../batch_processing.html">Batch Processing using Processing Framework (QGIS2)</a></li>
</ul>
</ul>
</li>
              
            
            
              
                
  <li>
    <a href="creating_heatmaps.html" title="Previous Chapter: Creating Heatmaps (QGIS3)"><span class="glyphicon glyphicon-chevron-left visible-sm"></span><span class="hidden-sm hidden-tablet">&laquo; Creating Heat...</span>
    </a>
  </li>
  <li>
    <a href="nearest_neighbor_analysis.html" title="Next Chapter: Nearest Neighbor Analysis (QGIS3)"><span class="glyphicon glyphicon-chevron-right visible-sm"></span><span class="hidden-sm hidden-tablet">Nearest Neigh... &raquo;</span>
    </a>
  </li>
              
            
            

            

            
              <li class="hidden-sm"></li>
            
          </ul>

          
            
<form class="navbar-form navbar-right" action="../../search.html" method="get">
 <div class="form-group">
  <input type="text" name="q" class="form-control" placeholder="Search" />
 </div>
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
          
        </div>
    </div>
  </div>

<div class="container">
  <div class="row">
      <div class="col-md-3">
        <div id="sidebar" class="bs-sidenav" role="complementary"><h4>Author</h4>
<p>Ujaval Gandhi</p>
<a href="https://twitter.com/intent/follow?screen_name=spatialthoughts" class="twitter-follow-button" data-show-count="false">Follow @spatialthoughts</a>

<!-- Begin Mailchimp Signup Form -->
<link href="//cdn-images.mailchimp.com/embedcode/slim-10_7.css" rel="stylesheet" type="text/css">
<style type="text/css">
	#mc_embed_signup{background:#fff; clear:left; font:14px Helvetica,Arial,sans-serif; }
	/* Add your own Mailchimp form style overrides in your site stylesheet or in this style block.
	   We recommend moving this block and the preceding CSS link to the HEAD of your HTML file. */
</style>
<div id="mc_embed_signup">
<h4>Subscribe to my mailing list</h4>
<p>Get occasional emails when I post new material or announce training events.</p>
<form action="https://spatialthoughts.us20.list-manage.com/subscribe/post?u=59d493847a7c7c2dbf12b21e6&amp;id=8fb09ab55c" method="post" id="mc-embedded-subscribe-form" name="mc-embedded-subscribe-form" class="validate" target="_blank" novalidate>
    <div id="mc_embed_signup_scroll">
	<input type="email" value="" name="EMAIL" class="email" id="mce-EMAIL" placeholder="email address" required>
    <!-- real people should not fill this in and expect good things - do not remove this or risk form bot signups-->
    <div style="position: absolute; left: -5000px;" aria-hidden="true"><input type="text" name="b_59d493847a7c7c2dbf12b21e6_8fb09ab55c" tabindex="-1" value=""></div>
    <div class="clear"><input type="submit" value="Subscribe" name="subscribe" id="mc-embedded-subscribe" class="button"></div>
    </div>
</form>
</div>

<!--End mc_embed_signup-->

<h4>Change Language</h4>
<form role="form" class="sidebar-form sidebar-left">
<select id="languages" class="form-control select-mini">
  <option value="en">English</option>
  <option value="zh_TW">Chinese (Taiwan)</option>
  <option value="nl">Dutch</option>
  <option value="fi_FI">Finnish</option>
  <option value="fr">French</option>
  <option value="de">German</option>
  <option value="el">Greek</option>
  <option value="id">Indonesian</option>
  <option value="it">Italian</option>
  <option value="ko">Korean</option>
  <option value="pt_BR">Portuguese</option>
  <option value="ro">Romanian</option>
  <option value="ru">Russian</option>
  <option value="sl">Slovenian</option>
  <option value="es">Spanish</option>
  <option value="th">Thai</option>
  <option value="tr">Turkish</option>
  <option value="uk">Ukrainian</option>
  <option value="vi">Vietnamese</option>
</select>
</form>
        </div>
      </div>
    <div class="col-md-9">
      

  <div class="section" id="performing-spatial-queries-qgis3">
<h1>Performing Spatial Queries (QGIS3)<a class="headerlink" href="#performing-spatial-queries-qgis3" title="Permalink to this headline">¶</a></h1>
<p>Spatial queries are core to many types of GIS analysis. Spatial queries allows you to select features in a layer by their spatial relationships (intersect, contain, touch etc.) with features from another layer. In QGIS, this functionality is available via the <strong>Select by Location</strong> and <strong>Extract by Location</strong> Processing tools.</p>
<div class="section" id="overview-of-the-task">
<h2>Overview of the task<a class="headerlink" href="#overview-of-the-task" title="Permalink to this headline">¶</a></h2>
<p>We will be working with 2 data layers for the city of Melbourne, Australia. Given the data layers for the pubs and bars in the city and locations of all metro stations, we want to find out all bars and pubs within 500 meters of a metro station.</p>
<div class="section" id="other-skills-you-will-learn">
<h3>Other skills you will learn<a class="headerlink" href="#other-skills-you-will-learn" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li>Choosing an appropriate projection and re-projecting vector data.</li>
<li>Creating buffers.</li>
<li>Working with the geopackage (.gpkg) data format.</li>
</ul>
</div>
</div>
<div class="section" id="get-the-data">
<h2>Get the data<a class="headerlink" href="#get-the-data" title="Permalink to this headline">¶</a></h2>
<p>City of Melbourne&#8217;s <a class="reference external" href="https://data.melbourne.vic.gov.au/">Open Data Platform</a> provides many GIS-ready datasets for the city.</p>
<p>Download the <a class="reference external" href="https://data.melbourne.vic.gov.au/Transport-Movement/Metro-Train-Stations-with-Accessibility-Informatio/mgkp-67ad">Metro Train Stations with Accessibility Information</a> dataset by Metro Trains Melbourne. Export the data in the <em>Original</em> format.</p>
<img alt="../../_images/data12.png" class="align-center" src="../../_images/data12.png" />
<p>Download the <a class="reference external" href="https://data.melbourne.vic.gov.au/Economy/Bars-and-pubs-with-patron-capacity/mffi-m9yn">Bars and pubs, with patron capacity</a> dataset by City of Melbourne&#8217;s Census of Land Use and Employment (CLUE). Export the data as a <em>CSV</em>.</p>
<img alt="../../_images/data21.png" class="align-center" src="../../_images/data21.png" />
<p>For convenience, you may directly download a copy of datasets from the link below:</p>
<p><a class="reference external" href="http://www.qgistutorials.com/downloads/metro_stations_accessbility.zip">metro_stations_accessbility.zip</a></p>
<p><a class="reference external" href="http://www.qgistutorials.com/downloads/Bars_and_pubs__with_patron_capacity.csv">Bars_and_pubs__with_patron_capacity</a></p>
<p>Data Source: <a class="reference internal" href="../credits.html#cityofmelbourne" id="id2">[CITYOFMELBOURNE]</a></p>
</div>
<div class="section" id="procedure">
<h2>Procedure<a class="headerlink" href="#procedure" title="Permalink to this headline">¶</a></h2>
<ol class="arabic simple">
<li>Locate the <code class="docutils literal"><span class="pre">metro_stations_accessbility.zip</span></code> file in the QGIS Browser and expand it. Select the <code class="docutils literal"><span class="pre">metro_stations_accessbility.shp</span></code> file and drag it to the canvas. A new layer <code class="docutils literal"><span class="pre">metro_stations_accessbility</span></code> will be loaded in the <span class="guilabel">Layers</span> panel.</li>
</ol>
<blockquote>
<div><img alt="../../_images/190.png" class="align-center" src="../../_images/190.png" />
</div></blockquote>
<ol class="arabic simple" start="2">
<li>The data layer for bars and pubs is in the CSV format. To load it in QGIS, go to <span class="menuselection">Layer ‣ Add Layer ‣ Add Delimited Text Layer...</span>. ( See <a class="reference internal" href="importing_spreadsheets_csv.html"><em>Importing Spreadsheets or CSV files (QGIS3)</em></a> for more details on importing CSV files)</li>
</ol>
<blockquote>
<div><img alt="../../_images/240.png" class="align-center" src="../../_images/240.png" />
</div></blockquote>
<ol class="arabic simple" start="3">
<li>In the <span class="guilabel">Data Source Manager | Delimited Text</span> dialog, browse and select the downloaded <code class="docutils literal"><span class="pre">Bars_and_pubs__with_patron_capacity.csv</span></code> file as <span class="guilabel">File name</span>. The <span class="guilabel">X field</span> and <span class="guilabel">Y field</span> columns should be auto selected to <code class="docutils literal"><span class="pre">x</span> <span class="pre">coordinate</span></code> and <code class="docutils literal"><span class="pre">y</span> <span class="pre">coordinate</span></code> respectively. Click <span class="guilabel">Add</span>.</li>
</ol>
<blockquote>
<div><img alt="../../_images/330.png" class="align-center" src="../../_images/330.png" />
</div></blockquote>
<ol class="arabic simple" start="4">
<li>You will see a new <code class="docutils literal"><span class="pre">Bars_and_pubs__with_patron_capacity</span></code> layer added to the <span class="guilabel">Layers</span> panel. Both of the input layers are in the Geograhpic Coordinate Reference System (CRS) <code class="docutils literal"><span class="pre">EPSG:436</span> <span class="pre">WGS84</span></code>. For performing spatial analysis, it is recommended to use a Projected Coordinate Reference System (CRS). So we will now re-project both the layers to an appropriate regional CRS that minimizes distortions and allows us to work in units of distance such as meters instead of degrees. Go to <span class="menuselection">Processing ‣ Toolbox</span>.</li>
</ol>
<blockquote>
<div><img alt="../../_images/416.png" class="align-center" src="../../_images/416.png" />
</div></blockquote>
<ol class="arabic simple" start="5">
<li>Search and locate the <span class="menuselection">Vector general ‣ Reproject layer</span> tool. Double-click to launch it.</li>
</ol>
<blockquote>
<div><img alt="../../_images/516.png" class="align-center" src="../../_images/516.png" />
</div></blockquote>
<ol class="arabic simple" start="6">
<li>Select <code class="docutils literal"><span class="pre">Bars_and_pubs__with_patron_capacity</span></code> as the <span class="guilabel">Input layer</span>. Click the <span class="guilabel">Select CRS</span> button next to <span class="guilabel">Target CRS</span>.</li>
</ol>
<blockquote>
<div><img alt="../../_images/616.png" class="align-center" src="../../_images/616.png" />
</div></blockquote>
<ol class="arabic simple" start="7">
<li>When selecting a projected coordinate system for your analysis, the first place to look is for a regional CRS for the area of interest. For Australia, the <a class="reference external" href="https://www.ga.gov.au/scientific-topics/positioning-navigation/geodesy/datums-projections/grid2020">Map Grid of Australia (MGA) 2020</a> is a UTM-based grid system that is used for local and regional mapping. Melbourne falls in the UTM Zone 55, so we can select the <cite>GDA 2020 / MGA zone 55 EPSG:7855`</cite> CRS.</li>
</ol>
<blockquote>
<div><img alt="../../_images/715.png" class="align-center" src="../../_images/715.png" />
</div></blockquote>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">If you are not sure of the a local CRS for the region that you are working in, selecting a CRS for the UTM zone based on the WGS84 datum is a safe choice. You can find out the UTM zone number of your region using <a class="reference external" href="http://www.dmap.co.uk/utmworld.htm">UTM Grid Zones of the World</a>.</p>
</div>
<ol class="arabic simple" start="8">
<li>Next, click the <span class="guilabel">...</span> button next to <span class="guilabel">Reprojected</span> and select <code class="docutils literal"><span class="pre">Save</span> <span class="pre">to</span> <span class="pre">GeoPackage</span></code>. <a class="reference external" href="https://www.geopackage.org/">Geopackage</a> is the recommended open data format spatial data and is the default data exchange format for QGIS3. A single GeoPackage <code class="docutils literal"><span class="pre">.gpkg</span></code> file can contain multiple vector and raster layers.</li>
</ol>
<blockquote>
<div><img alt="../../_images/815.png" class="align-center" src="../../_images/815.png" />
</div></blockquote>
<ol class="arabic simple" start="9">
<li>Name the geopackage as <code class="docutils literal"><span class="pre">spatialquery</span></code> and click <span class="guilabel">Save</span>.</li>
</ol>
<blockquote>
<div><img alt="../../_images/915.png" class="align-center" src="../../_images/915.png" />
</div></blockquote>
<ol class="arabic simple" start="10">
<li>When prompted for a layer name, enter <code class="docutils literal"><span class="pre">bars_and_pubs</span></code> and click <span class="guilabel">OK</span>. Click <span class="guilabel">Run</span> to reproject the layer.</li>
</ol>
<blockquote>
<div><img alt="../../_images/1015.png" class="align-center" src="../../_images/1015.png" />
</div></blockquote>
<ol class="arabic simple" start="11">
<li>The window will switch to the <span class="guilabel">Log</span> tab and you will see the algorithm run and create the new output layer <code class="docutils literal"><span class="pre">bars_and_pubs</span></code>.</li>
</ol>
<blockquote>
<div><img alt="../../_images/1119.png" class="align-center" src="../../_images/1119.png" />
</div></blockquote>
<ol class="arabic simple" start="12">
<li>Now we will reproject the <code class="docutils literal"><span class="pre">metro_stations_accessbility</span></code> layer. Switch back to the <span class="guilabel">Paramters</span> tab in the <span class="guilabel">Reproject layer</span> window. Select <code class="docutils literal"><span class="pre">metro_stations_accessbility</span></code> as the <span class="guilabel">Input layer</span>. Keep the same <span class="guilabel">Target CRS</span>.  Next, click the <span class="guilabel">...</span> button next to <span class="guilabel">Reprojected</span> and select <code class="docutils literal"><span class="pre">Save</span> <span class="pre">to</span> <span class="pre">GeoPackage</span></code>. Select the same output file <code class="docutils literal"><span class="pre">spatialquery</span></code> (Remember that a single geopackage file can contain multiple layers, so we will save the new layer to the same geopackage file). Enter <code class="docutils literal"><span class="pre">metro_stations</span></code> as the <span class="guilabel">Layer name</span>. Click <span class="guilabel">Run</span>.</li>
</ol>
<blockquote>
<div><img alt="../../_images/1216.png" class="align-center" src="../../_images/1216.png" />
</div></blockquote>
<ol class="arabic simple" start="13">
<li>Back in the main QGIS window, you will see 2 new layers loaded in the <span class="guilabel">Layers</span> panel: <code class="docutils literal"><span class="pre">bars_and_pubs</span></code> and <code class="docutils literal"><span class="pre">metro_stations</span></code>. You may turn off the visibility for original layers. Now, we are ready to do the spatial query. As we are interested in selecting bars and pubs within 500m of the metro stations, the first step is to create a buffer around the metro stations that represents our search area. Search and locate the <span class="menuselection">Vector geometry ‣ Buffer</span> tool in the <span class="guilabel">Processing Toolbox</span> and double-click to launch it.</li>
</ol>
<blockquote>
<div><img alt="../../_images/1316.png" class="align-center" src="../../_images/1316.png" />
</div></blockquote>
<ol class="arabic simple" start="14">
<li>In the <span class="guilabel">Buufer</span> dialog, select <code class="docutils literal"><span class="pre">metro_stations</span></code> as the <span class="guilabel">Input layer</span>. Set <code class="docutils literal"><span class="pre">500</span></code> meters as the <span class="guilabel">Distance</span>. Save the output to the same <code class="docutils literal"><span class="pre">spatialquery</span></code> geopackage and enter <code class="docutils literal"><span class="pre">metro_stations_buffers</span></code> as the <span class="guilabel">Layer name</span>. Click <span class="guilabel">Run</span>.</li>
</ol>
<blockquote>
<div><img alt="../../_images/1414.png" class="align-center" src="../../_images/1414.png" />
</div></blockquote>
<ol class="arabic simple" start="15">
<li>You will see a new <code class="docutils literal"><span class="pre">metro_stations_buffers</span></code> layers loaded in the <span class="guilabel">Layers</span> panel. Now we can find out which points from the <code class="docutils literal"><span class="pre">bars_and_pubs</span></code> layer falls within the polygons from the <code class="docutils literal"><span class="pre">metro_stations_buffers</span></code> layer. Locate the <span class="menuselection">Vector selection ‣ Extract by Location</span> tool from the <span class="guilabel">Processing Toolbox</span> and double-click to launch it.</li>
</ol>
<blockquote>
<div><img alt="../../_images/1514.png" class="align-center" src="../../_images/1514.png" />
</div></blockquote>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last"><em>Extract by location</em> will create a new layer with the matching features from the spatial query. If you just want to select features, use the <em>Select by location</em> tool.</p>
</div>
<ol class="arabic simple" start="16">
<li>In the <span class="guilabel">Extract by location</span> dialog, select <code class="docutils literal"><span class="pre">bars_and_pubs</span></code> as the <span class="guilabel">Extract features from</span>. Check <code class="docutils literal"><span class="pre">Intersect</span></code> as the <span class="guilabel">geometry predicate</span>. Set <code class="docutils literal"><span class="pre">metro_stations_buffers</span></code> as <span class="guilabel">By comparing to the features from</span>. Save the output to the <code class="docutils literal"><span class="pre">spatialquery</span></code> geopackage as the layer <code class="docutils literal"><span class="pre">selected</span></code>. Click <span class="guilabel">Run</span>.</li>
</ol>
<blockquote>
<div><img alt="../../_images/1612.png" class="align-center" src="../../_images/1612.png" />
</div></blockquote>
<ol class="arabic simple" start="17">
<li>Once the processing finishes, you will see the <code class="docutils literal"><span class="pre">selected</span></code> layers added to the <span class="guilabel">Layers</span> panel. Note that this layer only contains points from the <code class="docutils literal"><span class="pre">bars_and_pubs</span></code> that fall within the buffer polygons.</li>
</ol>
<blockquote>
<div><img alt="../../_images/1713.png" class="align-center" src="../../_images/1713.png" />
</div></blockquote>
<ol class="arabic simple" start="18">
<li>Our analysis is complete. You may notice that the buffer polygons look oval-shaped. This is because our Project CRS is still set to <strong>EPSG:4326 WGS84</strong>. To better visualize the results, you can go to <span class="menuselection">Project ‣ Properties ‣ CRS</span> and select <code class="docutils literal"><span class="pre">GDA</span> <span class="pre">2020</span> <span class="pre">/</span> <span class="pre">MGA</span> <span class="pre">zone</span> <span class="pre">55</span> <span class="pre">EPSG:7855</span></code> which we used for the analysis. Once set to this CRS, the buffer will appear in the correct shape.</li>
</ol>
<blockquote>
<div><img alt="../../_images/1812.png" class="align-center" src="../../_images/1812.png" />
</div></blockquote>
</div>
</div>





  <div id="disqus_thread"></div>
  <noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
  <a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>


    </div>
      
  </div>
</div>

<footer class="footer">
  <div class="container">
    <p class="pull-right">
      <a href="#">Back to top</a>
      
    </p>
    <p>
        &copy; Copyright 2019, Ujaval Gandhi.<br/>
      Last updated on Oct 22, 2019.<br/>
      Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 1.3.6.<br/>
    </p>
  </div>
</footer>
<div class="container">
  <p>This work is licensed under a <a href="http://creativecommons.org/licenses/by/4.0/deed.en_US">Creative Commons Attribution 4.0 International License</a></p>
</div>
<!-- Twitter Button -->
<script>!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0],p=/^http:/.test(d.location)?'http':'https';if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src=p+'://platform.twitter.com/widgets.js';fjs.parentNode.insertBefore(js,fjs);}}(document, 'script', 'twitter-wjs');</script>

<!-- Disqus comments widget -->
<script type="text/javascript">
  /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
  var disqus_shortname = 'qgistutorials'; // required: replace example with your forum shortname
  /* * * DON'T EDIT BELOW THIS LINE * * */
  (function () {
    var s = document.createElement('script'); s.async = true;
    s.type = 'text/javascript';
    s.src = '//' + disqus_shortname + '.disqus.com/count.js';
    (document.getElementsByTagName('HEAD')[0] || document.getElementsByTagName('BODY')[0]).appendChild(s);
  }());
</script>

<script type="text/javascript">
  /* * * DON'T EDIT BELOW THIS LINE * * */
  (function() {
    var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
    dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
    (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
  })();
</script>

<!-- Script fpr language switching. Largely adapted from https://github.com/pcav/faunalia-website -->
<script>
    var currentPage = 'docs/3/performing_spatial_queries.html'; // coming from sphinx, always without starting '/'
    var currentLang = 'en';
    $(document).ready(function(){

        var search = new RegExp('\/[a-zA-Z_]{2,8}\/'+ currentPage, 'gi');
        var langPlusPage = window.location.href.match(search);
        // it's possible this is a index.html page called without 'index.html', try without the currentPage
        if (langPlusPage==undefined){
            search = new RegExp('\/[a-zA-Z_]{2,8}\/$', 'gi');
            langPlusPage = window.location.href.match(search);
        }

        // it's possible this is an index.html page called without 'index.html', try removing index.html
        if (langPlusPage==undefined){
            currentPage = currentPage.replace('index.html','')
            search = new RegExp('\/[a-zA-Z_]{2,8}\/'+ currentPage, 'gi');
            langPlusPage = window.location.href.match(search);
        }
        // still no langPlugPage: stop, because the language swicher will misbehave 

        if (langPlusPage == undefined || langPlusPage.length != 1){
            alert('You hit an error, please report back to us.');
            return;
        }
        langPlusPage = langPlusPage[0];
        currentLang = langPlusPage.replace(currentPage, '');

        $("#languages").val(currentLang.replace(/\//g,'')); // currentLang is something like '/nl/'

        $("#languages").change(function() {
            gotoLang($(this).val());
        });

    });

    // load current page in a different language
    function gotoLang(lang){
        var currentUrl = window.location.href;
        var newUrl = currentUrl.replace(currentLang, '/'+lang+'/');
        window.location.href = newUrl;
    }
</script>

  </body>
</html>